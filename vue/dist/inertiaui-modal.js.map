{"version":3,"file":"inertiaui-modal.js","sources":["../src/config.ts","../src/helpers.ts","../src/ModalRenderer.vue","../src/ModalRoot.vue","../src/modalStack.ts","../src/useModal.ts","../src/Deferred.vue","../src/HeadlessModal.vue","../src/CloseButton.vue","../src/constants.ts","../src/ModalContent.vue","../src/SlideoverContent.vue","../src/Modal.vue","../src/ModalLink.vue","../src/WhenVisible.vue","../src/inertiauiModal.ts"],"sourcesContent":["export interface ModalTypeConfig {\n    closeButton: boolean\n    closeExplicitly: boolean\n    closeOnClickOutside: boolean\n    maxWidth: string\n    paddingClasses: string\n    panelClasses: string\n    position: string\n}\n\nexport interface ModalConfig {\n    type: 'modal' | 'slideover'\n    navigate: boolean\n    useNativeDialog: boolean\n    appElement: string | null\n    modal: ModalTypeConfig\n    slideover: ModalTypeConfig\n}\n\nconst defaultConfig: ModalConfig = {\n    type: 'modal',\n    navigate: false,\n    useNativeDialog: true,\n    appElement: '#app',\n    modal: {\n        closeButton: true,\n        closeExplicitly: false,\n        closeOnClickOutside: true,\n        maxWidth: '2xl',\n        paddingClasses: 'p-4 sm:p-6',\n        panelClasses: 'bg-white rounded',\n        position: 'center',\n    },\n    slideover: {\n        closeButton: true,\n        closeExplicitly: false,\n        closeOnClickOutside: true,\n        maxWidth: 'md',\n        paddingClasses: 'p-4 sm:p-6',\n        panelClasses: 'bg-white min-h-screen',\n        position: 'right',\n    },\n}\n\nclass Config {\n    private config: ModalConfig\n\n    constructor() {\n        this.config = {} as ModalConfig\n        this.reset()\n    }\n\n    reset(): void {\n        this.config = JSON.parse(JSON.stringify(defaultConfig))\n    }\n\n    put(key: string | Partial<ModalConfig>, value?: unknown): void {\n        if (typeof key === 'object') {\n            this.config = {\n                type: key.type ?? defaultConfig.type,\n                navigate: key.navigate ?? defaultConfig.navigate,\n                useNativeDialog: key.useNativeDialog ?? defaultConfig.useNativeDialog,\n                appElement: key.appElement !== undefined ? key.appElement : defaultConfig.appElement,\n                modal: { ...defaultConfig.modal, ...(key.modal ?? {}) },\n                slideover: { ...defaultConfig.slideover, ...(key.slideover ?? {}) },\n            }\n            return\n        }\n        const keys = key.split('.')\n        let current: Record<string, unknown> = this.config as unknown as Record<string, unknown>\n        for (let i = 0; i < keys.length - 1; i++) {\n            current = (current[keys[i]] = current[keys[i]] || {}) as Record<string, unknown>\n        }\n        current[keys[keys.length - 1]] = value\n    }\n\n    get(key?: string): unknown {\n        if (typeof key === 'undefined') {\n            return this.config\n        }\n        const keys = key.split('.')\n        let current: unknown = this.config\n        for (const k of keys) {\n            if (current === null || current === undefined || typeof current !== 'object') {\n                return null\n            }\n            current = (current as Record<string, unknown>)[k]\n        }\n        return current === undefined ? null : current\n    }\n}\n\nconst configInstance = new Config()\n\nexport const resetConfig = (): void => configInstance.reset()\nexport const putConfig = (key: string | Partial<ModalConfig>, value?: unknown): void => configInstance.put(key, value)\nexport const getConfig = (key?: string): unknown => configInstance.get(key)\nexport const getConfigByType = (isSlideover: boolean, key: string): unknown =>\n    configInstance.get(isSlideover ? `slideover.${key}` : `modal.${key}`)\n","// Re-export from vanilla package\nimport { generateId as vanillaGenerateId } from '@inertiaui/vanilla'\nexport { except, only, rejectNullValues, kebabCase, isStandardDomEvent, sameUrlPath } from '@inertiaui/vanilla'\n\n// Modal-specific helpers\n\nlet generateIdUsingCallback: (() => string) | null = null\n\nfunction generateIdUsing(callback: () => string): void {\n    generateIdUsingCallback = callback\n}\n\nfunction generateId(prefix: string = 'inertiaui_modal_'): string {\n    if (generateIdUsingCallback) {\n        return generateIdUsingCallback()\n    }\n    return vanillaGenerateId(prefix)\n}\n\nexport { generateIdUsing, generateId }\n","<script setup>\nimport { only } from './helpers'\nimport { useModalStack } from './modalStack'\nimport { computed, provide } from 'vue'\n\nconst props = defineProps({\n    index: {\n        type: Number,\n        required: true,\n    },\n})\n\nconst modalStack = useModalStack()\n\nconst modalContext = computed(() => {\n    return modalStack.stack.value[props.index]\n})\n\nprovide('modalContext', modalContext)\n</script>\n\n<template>\n    <modalContext.component\n        v-if=\"modalContext?.component\"\n        v-bind=\"only(modalContext.props ?? {}, modalContext.getComponentPropKeys(), true)\"\n        @modal-event=\"(event, ...args) => modalContext.emit(event, ...args)\"\n    />\n</template>\n","<script setup>\nimport { onMounted, onUnmounted, watch } from 'vue'\nimport { router, usePage } from '@inertiajs/vue3'\nimport { useModalStack } from './modalStack'\nimport ModalRenderer from './ModalRenderer.vue'\nimport { default as Axios } from 'axios'\nimport { sameUrlPath } from './helpers'\n\nconst modalStack = useModalStack()\nconst $page = usePage()\n\nlet isNavigating = false\nlet initialModalStillOpened = false\nconst pendingModalKeys = new Set()\n\n// Generate a unique key for deduplication (handles case when modal has no id)\nconst getModalKey = (modalData) => modalData.id || `${modalData.component}:${modalData.url}`\n\nonUnmounted(router.on('start', () => (isNavigating = true)))\nonUnmounted(router.on('finish', () => (isNavigating = false)))\nonUnmounted(\n    router.on('navigate', ($event) => {\n        const modalOnBase = $event.detail.page.props._inertiaui_modal\n        const pageUrl = $event.detail.page.url\n\n        // If we're closing to this specific URL, don't re-open the modal\n        // This handles the race condition where router.push in afterLeave\n        // fires a navigate event before the props callback clears _inertiaui_modal\n        // Only suppresses when navigating to our closing target URL (not browser back to modal)\n        if (modalStack.isClosingToBaseUrl(pageUrl)) {\n            modalStack.clearClosingToBaseUrl()\n            modalStack.closeAll(true)\n            modalStack.setBaseUrl(null)\n            initialModalStillOpened = false\n            return\n        }\n\n        if (!modalOnBase) {\n            // No modal data - close any open modals (force close without transition)\n            modalStack.closeAll(true)\n            modalStack.setBaseUrl(null)\n            initialModalStillOpened = false\n            return\n        }\n\n        // If the page URL doesn't match the modal URL, close all modals\n        // (handles browser back to non-modal URL when history state still has modal data)\n        if (!sameUrlPath(pageUrl, modalOnBase.url)) {\n            modalStack.closeAll(true)\n            modalStack.setBaseUrl(null)\n            initialModalStillOpened = false\n            return\n        }\n\n        // Skip if this modal is already being pushed (handles duplicate navigate events)\n        const modalKey = getModalKey(modalOnBase)\n        if (pendingModalKeys.has(modalKey)) {\n            return\n        }\n\n        // Also skip if a modal with this id is already in the stack\n        if (modalOnBase.id && modalStack.stack.value.some((m) => m.id === modalOnBase.id)) {\n            return\n        }\n\n        // Skip if a modal with the same component and URL is already open\n        // (handles \"Edit again!\" case where same modal is revisited with new props)\n        if (modalStack.stack.value.some((m) => m.response?.component === modalOnBase.component && sameUrlPath(m.response?.url, modalOnBase.url))) {\n            return\n        }\n\n        // Only set baseUrl when we're actually opening a new modal\n        // (after deduplication checks pass)\n        modalStack.setBaseUrl(modalOnBase.baseUrl)\n        pendingModalKeys.add(modalKey)\n\n        modalStack\n            .pushFromResponseData(modalOnBase, {}, () => {\n                if (!modalOnBase.baseUrl) {\n                    console.error('No base url in modal response data so cannot navigate back')\n                    return\n                }\n\n                if (!isNavigating && typeof window !== 'undefined' && window.location.href !== modalOnBase.baseUrl) {\n                    router.visit(modalOnBase.baseUrl, {\n                        preserveScroll: true,\n                        preserveState: true,\n                    })\n                }\n            })\n            .finally(() => {\n                pendingModalKeys.delete(modalKey)\n            })\n    }),\n)\n\nconst axiosRequestInterceptor = (config) => {\n    // A Modal is opened on top of a base route, so we need to pass this base route\n    // so it can redirect back with the back() helper method...\n    // Only send the header when we have an actual base URL value\n    // Check modalStack first, then fall back to page props if a modal is still open from initial load\n    const baseUrlValue = modalStack.getBaseUrl() ?? $page.props?._inertiaui_modal?.baseUrl ?? null\n    if (baseUrlValue) {\n        config.headers['X-InertiaUI-Modal-Base-Url'] = baseUrlValue\n    }\n\n    return config\n}\n\nlet axiosInterceptorId = null\nonMounted(() => (axiosInterceptorId = Axios.interceptors.request.use(axiosRequestInterceptor)))\nonUnmounted(() => axiosInterceptorId !== null && Axios.interceptors.request.eject(axiosInterceptorId))\n\nwatch(\n    () => $page.props?._inertiaui_modal,\n    (newModal, previousModal) => {\n        if (!newModal) {\n            return\n        }\n\n        // If there's a previous modal with same component/URL, update its props\n        if (previousModal && newModal.component === previousModal.component && sameUrlPath(newModal.url, previousModal.url)) {\n            modalStack.stack.value[0]?.updateProps(newModal.props ?? {})\n            return\n        }\n\n        // If there's no previous modal but we have modals in the stack (opened via XHR),\n        // check if the new modal matches any open modal and update its props\n        if (!previousModal && modalStack.stack.value.length > 0) {\n            const existingModal = modalStack.stack.value.find(\n                (m) => m.response?.component === newModal.component && sameUrlPath(m.response?.url, newModal.url),\n            )\n            if (existingModal) {\n                existingModal.updateProps(newModal.props ?? {})\n            }\n        }\n    },\n)\n</script>\n\n<template>\n    <slot />\n\n    <ModalRenderer\n        v-if=\"modalStack.stack.value.length\"\n        :index=\"0\"\n    />\n</template>\n","import { computed, readonly, ref, markRaw, h, nextTick, type Component, type Ref, type ComputedRef } from 'vue'\nimport { generateId, except, kebabCase } from './helpers'\nimport { router, usePage, progress } from '@inertiajs/vue3'\nimport { mergeDataIntoQueryString, type RequestPayload } from '@inertiajs/core'\nimport { default as Axios, type AxiosResponse } from 'axios'\nimport ModalRoot from './ModalRoot.vue'\n\n// Type definitions\nexport interface ModalResponseData {\n    id?: string\n    component: string\n    props: Record<string, unknown>\n    url?: string\n    version?: string\n    meta?: {\n        deferredProps?: Record<string, string[]>\n    }\n    baseUrl?: string\n}\n\nexport interface ModalConfig {\n    [key: string]: unknown\n}\n\nexport interface ReloadOptions {\n    only?: string[]\n    except?: string[]\n    method?: string\n    data?: Record<string, unknown>\n    headers?: Record<string, string>\n    onStart?: () => void\n    onSuccess?: (response: AxiosResponse) => void\n    onError?: (error: unknown) => void\n    onFinish?: () => void\n}\n\nexport interface VisitOptions {\n    method?: string\n    data?: RequestPayload\n    headers?: Record<string, string>\n    config?: ModalConfig\n    onClose?: () => void\n    onAfterLeave?: () => void\n    queryStringArrayFormat?: 'brackets' | 'indices'\n    navigate?: boolean\n    onStart?: () => void\n    onSuccess?: (response?: AxiosResponse) => void\n    onError?: (...args: unknown[]) => void\n    listeners?: Record<string, (...args: unknown[]) => void>\n    // Props to pass to local modals (#152)\n    props?: Record<string, unknown>\n}\n\n// Prefetch types (#146)\nexport type PrefetchOption = boolean | 'hover' | 'click' | 'mount' | Array<'hover' | 'click' | 'mount'>\n\nexport interface PrefetchOptions {\n    method?: string\n    data?: RequestPayload\n    headers?: Record<string, string>\n    queryStringArrayFormat?: 'brackets' | 'indices'\n    cacheFor?: number\n    onPrefetching?: () => void\n    onPrefetched?: () => void\n}\n\ntype EventCallback = (...args: unknown[]) => void\ntype ComponentResolver = (name: string) => Promise<Component>\n\nlet resolveComponent: ComponentResolver | null = null\n\nconst baseUrl = ref<string | null>(null)\nconst stack = ref<Modal[]>([])\nconst localModals = ref<Record<string, { name: string; callback: (modal: Modal) => void }>>({})\n\n// Track the URL we're closing to (prevents navigate handler from re-setting baseUrl)\n// Only suppresses if navigate event URL matches this URL\nlet closingToBaseUrlTarget: string | null = null\n\n// Prefetch cache (#146)\ninterface PrefetchCacheEntry {\n    response: AxiosResponse\n    timestamp: number\n    expiresAt: number\n}\n\nconst prefetchCache = new Map<string, PrefetchCacheEntry>()\nconst prefetchInFlight = new Map<string, Promise<AxiosResponse>>()\n\nfunction getPrefetchCacheKey(url: string, method: string, data: RequestPayload): string {\n    return `${method}:${url}:${JSON.stringify(data)}`\n}\n\nfunction getCachedResponse(url: string, method: string, data: RequestPayload): AxiosResponse | null {\n    const key = getPrefetchCacheKey(url, method, data)\n    const cached = prefetchCache.get(key)\n\n    if (!cached) {\n        return null\n    }\n\n    if (Date.now() > cached.expiresAt) {\n        prefetchCache.delete(key)\n        return null\n    }\n\n    return cached.response\n}\n\nfunction setCachedResponse(url: string, method: string, data: RequestPayload, response: AxiosResponse, cacheFor: number): void {\n    const key = getPrefetchCacheKey(url, method, data)\n    prefetchCache.set(key, {\n        response,\n        timestamp: Date.now(),\n        expiresAt: Date.now() + cacheFor,\n    })\n}\n\nexport function prefetch(href: string, options: PrefetchOptions = {}): Promise<void> {\n    if (href.startsWith('#')) {\n        return Promise.resolve()\n    }\n\n    const method = (options.method ?? 'get').toLowerCase()\n    const data = options.data ?? ({} as RequestPayload)\n    const headers = options.headers ?? {}\n    const queryStringArrayFormat = options.queryStringArrayFormat ?? 'brackets'\n    const cacheFor = options.cacheFor ?? 30000\n\n    const [url, mergedData] = mergeDataIntoQueryString(method as 'get' | 'post' | 'put' | 'patch' | 'delete', href || '', data, queryStringArrayFormat)\n\n    // Check if already cached\n    const cached = getCachedResponse(url, method, mergedData)\n    if (cached) {\n        return Promise.resolve()\n    }\n\n    // Check if already in flight\n    const cacheKey = getPrefetchCacheKey(url, method, mergedData)\n    const inFlight = prefetchInFlight.get(cacheKey)\n    if (inFlight) {\n        return inFlight.then(() => {})\n    }\n\n    options.onPrefetching?.()\n\n    const requestHeaders: Record<string, string> = {\n        ...headers,\n        Accept: 'text/html, application/xhtml+xml',\n        'X-Requested-With': 'XMLHttpRequest',\n        'X-Inertia': 'true',\n        'X-Inertia-Version': usePage().version ?? '',\n        'X-InertiaUI-Modal': generateId(),\n        'X-InertiaUI-Modal-Base-Url': baseUrl.value ?? '',\n    }\n\n    const request = Axios({ url, method, data: mergedData, headers: requestHeaders })\n        .then((response) => {\n            setCachedResponse(url, method, mergedData, response, cacheFor)\n            options.onPrefetched?.()\n            return response\n        })\n        .finally(() => {\n            prefetchInFlight.delete(cacheKey)\n        })\n\n    prefetchInFlight.set(cacheKey, request)\n\n    return request.then(() => {})\n}\n\nconst setComponentResolver = (resolver: ComponentResolver): void => {\n    resolveComponent = resolver\n}\n\nexport const initFromPageProps = (pageProps: { resolveComponent?: ComponentResolver }): void => {\n    if (pageProps.resolveComponent) {\n        resolveComponent = pageProps.resolveComponent\n    }\n}\n\nexport class Modal {\n    id: string\n    isOpen: boolean\n    shouldRender: boolean\n    listeners: Record<string, EventCallback[]>\n    component: Component | null\n    props: Ref<Record<string, unknown>>\n    response: ModalResponseData\n    config: ModalConfig\n    onCloseCallback: (() => void) | null\n    afterLeaveCallback: (() => void) | null\n    index: ComputedRef<number>\n    onTopOfStack: ComputedRef<boolean>\n    name?: string\n\n    constructor(\n        component: Component | null,\n        response: ModalResponseData,\n        config?: ModalConfig | null,\n        onClose?: (() => void) | null,\n        afterLeave?: (() => void) | null,\n    ) {\n        this.id = response.id ?? generateId()\n        this.isOpen = false\n        this.shouldRender = false\n        this.listeners = {}\n\n        this.component = component\n        this.props = ref(response.props ?? {})\n        this.response = response\n        this.config = config ?? {}\n        this.onCloseCallback = onClose ?? null\n        this.afterLeaveCallback = afterLeave ?? null\n\n        this.index = computed(() => stack.value.findIndex((m) => m.id === this.id))\n        this.onTopOfStack = computed(() => {\n            if (stack.value.length < 2) {\n                return true\n            }\n\n            const modals = stack.value.map((modal) => ({ id: modal.id, shouldRender: modal.shouldRender }))\n\n            return modals.reverse().find((modal) => modal.shouldRender)?.id === this.id\n        })\n    }\n\n    getComponentPropKeys = (): string[] => {\n        if (!this.component) {\n            return []\n        }\n\n        const componentProps = (this.component as Component & { props?: string[] | Record<string, unknown> }).props\n\n        if (Array.isArray(componentProps)) {\n            return componentProps\n        }\n\n        return componentProps ? Object.keys(componentProps) : []\n    }\n\n    getParentModal = (): Modal | null | undefined => {\n        const index = this.index.value\n\n        if (index < 1) {\n            // This is the first modal in the stack\n            return null\n        }\n\n        // Find the first open modal before this one\n        return stack.value\n            .slice(0, index)\n            .reverse()\n            .find((modal) => modal.isOpen) as unknown as Modal | undefined\n    }\n\n    getChildModal = (): Modal | null => {\n        const index = this.index.value\n\n        if (index === stack.value.length - 1) {\n            // This is the last modal in the stack\n            return null\n        }\n\n        // Find the first open modal after this one\n        return (stack.value.slice(index + 1).find((modal) => modal.isOpen) as unknown as Modal | undefined) ?? null\n    }\n\n    show = (): void => {\n        const index = this.index.value\n\n        if (index > -1) {\n            if (stack.value[index].isOpen) {\n                // Only open if the modal is closed\n                return\n            }\n\n            stack.value[index].isOpen = true\n            stack.value[index].shouldRender = true\n        }\n    }\n\n    close = (): void => {\n        const index = this.index.value\n\n        if (index > -1) {\n            if (!stack.value[index].isOpen) {\n                // Only close if the modal is open\n                return\n            }\n\n            Object.keys(this.listeners).forEach((event) => {\n                this.off(event)\n            })\n\n            stack.value[index].isOpen = false\n            this.onCloseCallback?.()\n            this.onCloseCallback = null\n        }\n    }\n\n    setOpen = (open: boolean): void => {\n        if (open) {\n            this.show()\n        } else {\n            this.close()\n        }\n    }\n\n    afterLeave = (): void => {\n        const index = this.index.value\n\n        if (index > -1) {\n            if (stack.value[index].isOpen) {\n                // Only execute the callback if the modal is closed\n                return\n            }\n\n            stack.value[index].shouldRender = false\n            this.afterLeaveCallback?.()\n            this.afterLeaveCallback = null\n        }\n\n        if (index === 0) {\n            stack.value = []\n\n            // Update browser URL back to base when all modals are closed\n            // Clear baseUrl BEFORE router.push to prevent the navigate event\n            // from setting it back (race condition with props callback)\n            const savedBaseUrl = baseUrl.value\n            baseUrl.value = null\n\n            // Set target URL to prevent navigate handler from re-setting baseUrl\n            // Only suppresses navigate events to this specific URL\n            closingToBaseUrlTarget = savedBaseUrl\n\n            if (savedBaseUrl && typeof window !== 'undefined') {\n                router.push({\n                    url: savedBaseUrl,\n                    preserveScroll: true,\n                    preserveState: true,\n                    // Clear _inertiaui_modal prop to prevent modal from reopening\n                    // Must explicitly set to undefined since props are merged\n                    props: (currentProps: Record<string, unknown>) => {\n                        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n                        const { _inertiaui_modal, ...rest } = currentProps\n                        return { ...rest, _inertiaui_modal: undefined }\n                    },\n                })\n            }\n        }\n    }\n\n    on = (event: string, callback: EventCallback): void => {\n        event = kebabCase(event)\n        this.listeners[event] = this.listeners[event] ?? []\n        this.listeners[event].push(callback)\n    }\n\n    off = (event: string, callback?: EventCallback): void => {\n        event = kebabCase(event)\n        if (callback) {\n            this.listeners[event] = this.listeners[event]?.filter((cb) => cb !== callback) ?? []\n        } else {\n            delete this.listeners[event]\n        }\n    }\n\n    emit = (event: string, ...args: unknown[]): void => {\n        this.listeners[kebabCase(event)]?.forEach((callback) => callback(...args))\n    }\n\n    registerEventListenersFromAttrs = ($attrs: Record<string, unknown>): (() => void) => {\n        const unsubscribers: (() => void)[] = []\n\n        Object.keys($attrs)\n            .filter((key) => key.startsWith('on'))\n            .forEach((key) => {\n                const eventName = kebabCase(key).replace(/^on-/, '')\n                const callback = $attrs[key] as EventCallback\n                this.on(eventName, callback)\n                unsubscribers.push(() => this.off(eventName, callback))\n            })\n\n        return () => unsubscribers.forEach((unsub) => unsub())\n    }\n\n    reload = (options: ReloadOptions = {}): void => {\n        let keys = Object.keys(this.response.props)\n\n        if (options.only) {\n            keys = options.only\n        }\n\n        if (options.except) {\n            keys = except(keys, options.except) as string[]\n        }\n\n        if (!this.response?.url) {\n            return\n        }\n\n        const method = (options.method ?? 'get').toLowerCase()\n        const data = options.data ?? {}\n\n        options.onStart?.()\n\n        Axios({\n            url: this.response.url,\n            method,\n            data: method === 'get' ? {} : data,\n            params: method === 'get' ? data : {},\n            headers: {\n                ...(options.headers ?? {}),\n                Accept: 'text/html, application/xhtml+xml',\n                'X-Inertia': 'true',\n                'X-Inertia-Partial-Component': this.response.component,\n                'X-Inertia-Version': this.response.version ?? '',\n                'X-Inertia-Partial-Data': keys.join(','),\n                'X-InertiaUI-Modal': generateId(),\n                'X-InertiaUI-Modal-Base-Url': baseUrl.value ?? '',\n            },\n        })\n            .then((response) => {\n                this.updateProps(response.data.props)\n                options.onSuccess?.(response)\n            })\n            .catch((error) => {\n                options.onError?.(error)\n            })\n            .finally(() => {\n                options.onFinish?.()\n            })\n    }\n\n    updateProps = (props: Record<string, unknown>): void => {\n        Object.assign(this.props.value, props)\n    }\n}\n\nfunction registerLocalModal(name: string, callback: (modal: Modal) => void): void {\n    localModals.value[name] = { name, callback }\n}\n\nfunction pushLocalModal(\n    name: string,\n    config?: ModalConfig | null,\n    onClose?: (() => void) | null,\n    afterLeave?: (() => void) | null,\n    props?: Record<string, unknown> | null,\n): Modal {\n    if (!localModals.value[name]) {\n        throw new Error(`The local modal \"${name}\" has not been registered.`)\n    }\n\n    const responseData = { props: props ?? {} } as ModalResponseData\n    const modal = push(null, responseData, config, onClose, afterLeave)\n    modal.name = name\n    localModals.value[name].callback(modal)\n    return modal\n}\n\nfunction isValidModalResponse(data: unknown): data is ModalResponseData {\n    return (\n        typeof data === 'object' &&\n        data !== null &&\n        'component' in data &&\n        typeof (data as ModalResponseData).component === 'string'\n    )\n}\n\nfunction updateBrowserUrl(url: string | undefined, useBrowserHistory: boolean, modalData?: ModalResponseData): void {\n    if (!url || !useBrowserHistory || typeof window === 'undefined') {\n        return\n    }\n\n    router.push({\n        url,\n        preserveScroll: true,\n        preserveState: true,\n        // Store modal data in page props for history navigation\n        // This allows forward/back to restore the modal\n        props: modalData\n            ? (currentProps: Record<string, unknown>) => ({\n                  ...currentProps,\n                  _inertiaui_modal: {\n                      ...modalData,\n                      baseUrl: baseUrl.value,\n                  },\n              })\n            : undefined,\n    })\n}\n\nfunction pushFromResponseData(\n    responseData: ModalResponseData,\n    config: ModalConfig = {},\n    onClose: (() => void) | null = null,\n    onAfterLeave: (() => void) | null = null,\n): Promise<Modal> {\n    if (!resolveComponent) {\n        return Promise.reject(new Error('Component resolver not set'))\n    }\n\n    if (!isValidModalResponse(responseData)) {\n        return Promise.reject(\n            new Error(\n                'Invalid modal response. This usually happens when the server returns a redirect (e.g., due to session expiration). ' +\n                    'Check if the user is still authenticated.',\n            ),\n        )\n    }\n\n    return resolveComponent(responseData.component).then((component) =>\n        push(markRaw(component), responseData, config, onClose, onAfterLeave),\n    )\n}\n\nfunction visit(\n    href: string,\n    method: string,\n    payload: RequestPayload = {},\n    headers: Record<string, string> = {},\n    config: ModalConfig = {},\n    onClose: (() => void) | null = null,\n    onAfterLeave: (() => void) | null = null,\n    queryStringArrayFormat: 'brackets' | 'indices' = 'brackets',\n    useBrowserHistory: boolean = false,\n    onStart: (() => void) | null = null,\n    onSuccess: ((response?: AxiosResponse) => void) | null = null,\n    onError: ((...args: unknown[]) => void) | null = null,\n    props: Record<string, unknown> | null = null,\n): Promise<Modal> {\n    const modalId = generateId()\n\n    return new Promise((resolve, reject) => {\n        if (href.startsWith('#')) {\n            resolve(pushLocalModal(href.substring(1), config, onClose, onAfterLeave, props))\n            return\n        }\n\n        const [url, data] = mergeDataIntoQueryString(method as 'get' | 'post' | 'put' | 'patch' | 'delete', href || '', payload, queryStringArrayFormat)\n\n        // Check for cached prefetch response (#146)\n        const cachedResponse = getCachedResponse(url, method, data)\n        if (cachedResponse) {\n            onSuccess?.(cachedResponse)\n            pushFromResponseData(cachedResponse.data, config, onClose, onAfterLeave)\n                .then((modal) => {\n                    updateBrowserUrl(cachedResponse.data.url, useBrowserHistory, cachedResponse.data)\n                    resolve(modal)\n                })\n                .catch(reject)\n            return\n        }\n\n        if (stack.value.length === 0) {\n            baseUrl.value = typeof window !== 'undefined' ? window.location.href : ''\n        }\n\n        const requestHeaders: Record<string, string> = {\n            ...headers,\n            Accept: 'text/html, application/xhtml+xml',\n            'X-Requested-With': 'XMLHttpRequest',\n            'X-Inertia': 'true',\n            'X-Inertia-Version': usePage().version ?? '',\n            'X-InertiaUI-Modal': modalId,\n            'X-InertiaUI-Modal-Base-Url': baseUrl.value ?? '',\n        }\n\n        onStart?.()\n\n        progress?.start()\n\n        Axios({ url, method, data, headers: requestHeaders })\n            .then((response) => {\n                onSuccess?.(response)\n                pushFromResponseData(response.data, config, onClose, onAfterLeave)\n                    .then((modal) => {\n                        updateBrowserUrl(response.data.url, useBrowserHistory, response.data)\n                        resolve(modal)\n                    })\n                    .catch(reject)\n            })\n            .catch((...args: unknown[]) => {\n                onError?.(...args)\n                reject(args[0])\n            })\n            .finally(() => {\n                progress?.finish()\n            })\n    })\n}\n\nfunction loadDeferredProps(modal: Modal): void {\n    const deferred = modal.response?.meta?.deferredProps\n\n    if (!deferred) {\n        return\n    }\n\n    Object.keys(deferred).forEach((key) => {\n        modal.reload({ only: deferred[key] })\n    })\n}\n\nfunction push(\n    component: Component | null,\n    response: ModalResponseData,\n    config?: ModalConfig | null,\n    onClose?: (() => void) | null,\n    afterLeave?: (() => void) | null,\n): Modal {\n    const newModal = new Modal(component, response, config, onClose, afterLeave)\n    // @ts-expect-error Vue reactivity transforms the Modal instance\n    stack.value.push(newModal)\n    loadDeferredProps(newModal)\n\n    nextTick(() => newModal.show())\n\n    return newModal\n}\n\nexport const modalPropNames = ['closeButton', 'closeExplicitly', 'closeOnClickOutside', 'maxWidth', 'paddingClasses', 'panelClasses', 'position', 'slideover']\n\nexport const renderApp = (App: Component, props: { resolveComponent?: ComponentResolver }): (() => ReturnType<typeof h>) => {\n    if (props.resolveComponent) {\n        resolveComponent = props.resolveComponent\n    }\n\n    return () => h(ModalRoot, () => h(App, props))\n}\n\nexport interface ModalStack {\n    setComponentResolver: (resolver: ComponentResolver) => void\n    getBaseUrl: () => string | null\n    setBaseUrl: (url: string | null) => void\n    isClosingToBaseUrl: (pageUrl: string) => boolean\n    clearClosingToBaseUrl: () => void\n    stack: Readonly<Ref<readonly Modal[]>>\n    push: typeof push\n    pushFromResponseData: typeof pushFromResponseData\n    closeAll: (force?: boolean) => void\n    reset: () => void\n    visit: typeof visit\n    registerLocalModal: typeof registerLocalModal\n    removeLocalModal: (name: string) => boolean\n}\n\nexport function useModalStack(): ModalStack {\n    return {\n        setComponentResolver,\n        getBaseUrl: () => baseUrl.value,\n        setBaseUrl: (url: string | null) => (baseUrl.value = url),\n        isClosingToBaseUrl: (pageUrl: string) => {\n            if (!closingToBaseUrlTarget) return false\n            // Check if the page URL matches our closing target (ignoring query strings)\n            const targetPath = new URL(closingToBaseUrlTarget, 'http://x').pathname\n            const pagePath = new URL(pageUrl, 'http://x').pathname\n            return targetPath === pagePath\n        },\n        clearClosingToBaseUrl: () => (closingToBaseUrlTarget = null),\n        stack: readonly(stack) as unknown as Readonly<Ref<readonly Modal[]>>,\n        push,\n        pushFromResponseData,\n        closeAll: (force = false) => {\n            if (force) {\n                // Force close: immediately remove all modals without transition\n                stack.value = []\n            } else {\n                // Normal close: trigger leave transition for each modal\n                ;[...stack.value].reverse().forEach((modal) => modal.close())\n            }\n        },\n        reset: () => (stack.value = []),\n        visit,\n        registerLocalModal,\n        removeLocalModal: (name: string) => delete localModals.value[name],\n    }\n}\n","import { inject, toValue } from 'vue'\nimport type { Modal } from './modalStack'\n\nexport default function useModal(): Modal | null {\n    return toValue(inject<Modal | null>('modalContext', null))\n}\n","<script setup>\n// See: https://github.com/inertiajs/inertia/blob/48bcd21fb7daf467d0df1bfde2408f161f94a579/packages/vue3/src/deferred.ts\nimport { computed, inject } from 'vue'\n\nconst props = defineProps({\n    data: {\n        type: [String, Array],\n        required: true,\n    },\n})\n\nconst modalContext = inject('modalContext')\n\nif (!modalContext) {\n    throw new Error('Deferred component must be used inside a Modal component')\n}\n\nconst allKeysAreAvailable = computed(() => {\n    const keys = Array.isArray(props.data) ? props.data : [props.data]\n\n    return keys.every((key) => modalContext.value.props[key] !== undefined)\n})\n</script>\n\n<template>\n    <slot v-if=\"allKeysAreAvailable\" />\n\n    <slot\n        v-else\n        name=\"fallback\"\n    />\n</template>\n","<script setup>\nimport { getConfig, getConfigByType } from './config'\nimport { inject, onBeforeUnmount, ref, computed, useAttrs, onMounted, watch, unref } from 'vue'\nimport { useModalStack } from './modalStack'\nimport ModalRenderer from './ModalRenderer.vue'\n\nconst props = defineProps({\n    name: {\n        type: String,\n        required: false,\n    },\n    // The slideover prop is on top because we need to know if it's a slideover\n    // before we can determine the default value of other props\n    slideover: {\n        type: Boolean,\n        default: null,\n    },\n    closeButton: {\n        type: Boolean,\n        default: null,\n    },\n    closeExplicitly: {\n        type: Boolean,\n        default: null,\n    },\n    closeOnClickOutside: {\n        type: Boolean,\n        default: null,\n    },\n    maxWidth: {\n        type: String,\n        default: null,\n    },\n    paddingClasses: {\n        type: [Boolean, String],\n        default: null,\n    },\n    panelClasses: {\n        type: [Boolean, String],\n        default: null,\n    },\n    position: {\n        type: String,\n        default: null,\n    },\n})\n\nconst modalStack = useModalStack()\nconst modalContext = props.name ? ref({}) : inject('modalContext')\nconst config = computed(() => {\n    const isSlideover = modalContext.value.config?.slideover ?? props.slideover ?? getConfig('type') === 'slideover'\n\n    return {\n        slideover: isSlideover,\n        closeButton: props.closeButton ?? getConfigByType(isSlideover, 'closeButton'),\n        closeExplicitly: props.closeExplicitly ?? getConfigByType(isSlideover, 'closeExplicitly'),\n        closeOnClickOutside: props.closeOnClickOutside ?? getConfigByType(isSlideover, 'closeOnClickOutside'),\n        maxWidth: props.maxWidth ?? getConfigByType(isSlideover, 'maxWidth'),\n        paddingClasses: props.paddingClasses ?? getConfigByType(isSlideover, 'paddingClasses'),\n        panelClasses: props.panelClasses ?? getConfigByType(isSlideover, 'panelClasses'),\n        position: props.position ?? getConfigByType(isSlideover, 'position'),\n        ...modalContext.value.config,\n    }\n})\n\n// Local Modals...\nif (props.name) {\n    modalStack.registerLocalModal(props.name, function (context) {\n        modalContext.value = context\n        registerEventListeners()\n    })\n\n    onBeforeUnmount(() => {\n        modalStack.removeLocalModal(props.name)\n    })\n}\n\nonMounted(() => {\n    if (!props.name) {\n        registerEventListeners()\n    }\n})\n\nconst unsubscribeEventListeners = ref(null)\nonBeforeUnmount(() => unsubscribeEventListeners.value?.())\n\nconst $attrs = useAttrs()\n\nfunction registerEventListeners() {\n    unsubscribeEventListeners.value = modalContext.value.registerEventListenersFromAttrs($attrs)\n}\n\nconst emits = defineEmits(['modal-event', 'focus', 'blur', 'close', 'success'])\n\nfunction emit(event, ...args) {\n    emits('modal-event', event, ...args)\n}\n\ndefineExpose({\n    emit,\n    afterLeave: () => modalContext.value?.afterLeave(),\n    close: () => modalContext.value?.close(),\n    reload: (...args) => modalContext.value?.reload(...args),\n    setOpen: (...args) => modalContext.value?.setOpen(...args),\n    getChildModal: () => modalContext.value?.getChildModal(),\n    getParentModal: () => modalContext.value?.getParentModal(),\n\n    get config() {\n        return modalContext.value?.config\n    },\n    get id() {\n        return modalContext.value?.id\n    },\n    get index() {\n        return modalContext.value?.index\n    },\n    get isOpen() {\n        return modalContext.value?.isOpen\n    },\n    get modalContext() {\n        return modalContext.value?.modalContext\n    },\n    get onTopOfStack() {\n        return modalContext.value?.onTopOfStack\n    },\n    get shouldRender() {\n        return modalContext.value?.shouldRender\n    },\n})\n\nwatch(\n    () => modalContext.value?.onTopOfStack,\n    (onTopOfStack, previousOnTopOfStack) => {\n        if (onTopOfStack && !previousOnTopOfStack) {\n            emits('focus')\n        } else if (!onTopOfStack && previousOnTopOfStack) {\n            emits('blur')\n        }\n    },\n)\n\nwatch(\n    () => modalContext.value?.isOpen,\n    (isOpen, previousIsOpen) => {\n        if (isOpen) {\n            emits('success')\n        } else if (previousIsOpen === true) {\n            // Only emit 'close' when transitioning from open to closed,\n            // not when the component first mounts with isOpen undefined\n            emits('close')\n        }\n    },\n    { immediate: true },\n)\n\nconst nextIndex = computed(() => {\n    return modalStack.stack.value.find((m) => m.shouldRender && m.index > modalContext.value.index)?.index\n})\n\n// Computed to unwrap the modal's props ref for slot binding (#152)\nconst modalProps = computed(() => {\n    const ctx = modalContext.value\n    if (!ctx) return {}\n    // The Modal class stores props as a ref, so we need to unref it\n    return unref(ctx.props) ?? {}\n})\n\ndefineOptions({\n    inheritAttrs: false,\n})\n</script>\n\n<template>\n    <slot\n        v-if=\"modalContext.shouldRender\"\n        v-bind=\"modalProps\"\n        :id=\"modalContext.id\"\n        :after-leave=\"modalContext.afterLeave\"\n        :close=\"modalContext.close\"\n        :config=\"config\"\n        :emit=\"emit\"\n        :get-child-modal=\"modalContext.getChildModal\"\n        :get-parent-modal=\"modalContext.getParentModal\"\n        :index=\"modalContext.index\"\n        :is-open=\"modalContext.isOpen\"\n        :modal-context=\"modalContext\"\n        :on-top-of-stack=\"modalContext.onTopOfStack\"\n        :reload=\"modalContext.reload\"\n        :set-open=\"modalContext.setOpen\"\n        :should-render=\"modalContext.shouldRender\"\n    />\n\n    <!-- The next modal in the stack -->\n    <ModalRenderer\n        v-if=\"nextIndex\"\n        :index=\"nextIndex\"\n    />\n</template>\n","<script setup>\nimport useModal from './useModal'\n\nconst modal = useModal()\n</script>\n\n<template>\n    <button\n        type=\"button\"\n        class=\"im-close-button text-gray-400 hover:text-gray-500\"\n        @click=\"modal.close()\"\n    >\n        <span class=\"sr-only\">Close</span>\n        <svg\n            class=\"size-6\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            fill=\"none\"\n            viewBox=\"0 0 24 24\"\n            stroke-width=\"2\"\n            stroke=\"currentColor\"\n            aria-hidden=\"true\"\n        >\n            <path\n                stroke-linecap=\"round\"\n                stroke-linejoin=\"round\"\n                d=\"M6 18L18 6M6 6l12 12\"\n            ></path>\n        </svg>\n    </button>\n</template>\n","/**\n * Max width classes for modals and slideovers.\n * Uses a map lookup for Tailwind 4 compatibility (scanner picks up full class strings).\n */\nexport const maxWidthClasses: Record<string, string> = {\n    sm: 'sm:max-w-sm',\n    md: 'sm:max-w-md',\n    lg: 'sm:max-w-md md:max-w-lg',\n    xl: 'sm:max-w-md md:max-w-xl',\n    '2xl': 'sm:max-w-md md:max-w-xl lg:max-w-2xl',\n    '3xl': 'sm:max-w-md md:max-w-xl lg:max-w-3xl',\n    '4xl': 'sm:max-w-md md:max-w-xl lg:max-w-3xl xl:max-w-4xl',\n    '5xl': 'sm:max-w-md md:max-w-xl lg:max-w-3xl xl:max-w-5xl',\n    '6xl': 'sm:max-w-md md:max-w-xl lg:max-w-3xl xl:max-w-5xl 2xl:max-w-6xl',\n    '7xl': 'sm:max-w-md md:max-w-xl lg:max-w-3xl xl:max-w-5xl 2xl:max-w-7xl',\n}\n\nexport const defaultMaxWidth = '2xl'\n\nexport function getMaxWidthClass(maxWidth: string): string {\n    return maxWidthClasses[maxWidth] || maxWidthClasses[defaultMaxWidth]\n}\n","<script setup>\nimport { ref, onMounted, onUnmounted, watch, nextTick, computed } from 'vue'\nimport CloseButton from './CloseButton.vue'\nimport { createFocusTrap, onEscapeKey } from './dialog'\nimport { getMaxWidthClass } from './constants'\n\nconst props = defineProps({\n    modalContext: Object,\n    config: Object,\n    useNativeDialog: Boolean,\n    isFirstModal: Boolean,\n})\n\nconst emit = defineEmits(['after-leave'])\n\nconst isRendered = ref(false)\nconst isVisible = ref(false)  // For backdrop sync\nconst entered = ref(false)    // After animation completes\nconst wrapperRef = ref(null)\nconst dialogRef = ref(null)\nconst nativeWrapperRef = ref(null)\n\nlet cleanupFocusTrap = null\nlet cleanupEscapeKey = null\nlet currentAnimation = null\n\nconst maxWidthClass = computed(() => getMaxWidthClass(props.config.maxWidth))\n\n// ============ Animation handlers using Web Animations API ============\n\nasync function animateIn(element) {\n    if (!element) return\n\n    isVisible.value = true  // Trigger backdrop immediately\n\n    const animation = element.animate([\n        { transform: 'translate3d(0, 1rem, 0) scale(0.95)', opacity: 0 },\n        { transform: 'translate3d(0, 0, 0) scale(1)', opacity: 1 }\n    ], {\n        duration: 300,\n        easing: 'cubic-bezier(0.4, 0, 0.2, 1)',  // Tailwind's ease-in-out\n        fill: 'forwards'\n    })\n\n    await animation.finished\n    entered.value = true\n    setupFocusTrap()\n}\n\nasync function animateOut(element) {\n    if (!element) return\n\n    isVisible.value = false  // Trigger backdrop fade out immediately\n\n    currentAnimation = element.animate([\n        { transform: 'translate3d(0, 0, 0) scale(1)', opacity: 1 },\n        { transform: 'translate3d(0, 1rem, 0) scale(0.95)', opacity: 0 }\n    ], {\n        duration: 300,\n        easing: 'cubic-bezier(0.4, 0, 0.2, 1)',  // Tailwind's ease-in-out\n        fill: 'forwards'\n    })\n\n    await currentAnimation.finished\n\n    isRendered.value = false\n    if (props.useNativeDialog && dialogRef.value) {\n        dialogRef.value.close()\n    }\n    emit('after-leave')\n    props.modalContext.afterLeave()\n}\n\nfunction show() {\n    isRendered.value = true\n    nextTick(() => {\n        const wrapper = props.useNativeDialog ? nativeWrapperRef.value : wrapperRef.value\n        animateIn(wrapper)\n    })\n}\n\nfunction hide() {\n    entered.value = false\n    const wrapper = props.useNativeDialog ? nativeWrapperRef.value : wrapperRef.value\n    animateOut(wrapper)\n}\n\n// ============ Non-native dialog handlers ============\n\nfunction setupFocusTrap() {\n    if (props.useNativeDialog) return\n    if (!wrapperRef.value || !props.modalContext.onTopOfStack) return\n    if (cleanupFocusTrap) return\n\n    cleanupFocusTrap = createFocusTrap(wrapperRef.value, {\n        initialFocus: true,\n        returnFocus: false,\n    })\n}\n\nfunction cleanupFocusTrap_() {\n    if (cleanupFocusTrap) {\n        cleanupFocusTrap()\n        cleanupFocusTrap = null\n    }\n}\n\nfunction setupEscapeKey() {\n    if (props.useNativeDialog) return\n    if (cleanupEscapeKey) return\n    if (props.config?.closeExplicitly) return\n\n    cleanupEscapeKey = onEscapeKey(() => {\n        if (props.modalContext.onTopOfStack) {\n            props.modalContext.close()\n        }\n    })\n}\n\nfunction cleanupEscapeKey_() {\n    if (cleanupEscapeKey) {\n        cleanupEscapeKey()\n        cleanupEscapeKey = null\n    }\n}\n\nfunction handleClickOutside(event) {\n    if (props.useNativeDialog) return\n    if (!props.modalContext.onTopOfStack) return\n    if (props.config?.closeExplicitly) return\n    if (props.config?.closeOnClickOutside === false) return\n    if (!wrapperRef.value) return\n\n    if (!wrapperRef.value.contains(event.target)) {\n        props.modalContext.close()\n    }\n}\n\n// ============ Native dialog handlers ============\n\nfunction handleCancel(event) {\n    event.preventDefault()\n    if (props.modalContext.onTopOfStack && !props.config?.closeExplicitly) {\n        props.modalContext.close()\n    }\n}\n\nfunction handleDialogClick(event) {\n    if (event.target === dialogRef.value) {\n        if (props.modalContext.onTopOfStack && !props.config?.closeExplicitly && props.config?.closeOnClickOutside !== false) {\n            props.modalContext.close()\n        }\n    }\n}\n\nfunction openDialog() {\n    if (dialogRef.value && !dialogRef.value.open) {\n        dialogRef.value.showModal()\n        nextTick(() => {\n            animateIn(nativeWrapperRef.value)\n        })\n    }\n}\n\nfunction closeDialog() {\n    if (dialogRef.value && dialogRef.value.open) {\n        entered.value = false\n        animateOut(nativeWrapperRef.value)\n    }\n}\n\n// ============ Lifecycle ============\n\nonMounted(() => {\n    if (props.useNativeDialog) {\n        if (props.modalContext.isOpen) {\n            openDialog()\n        }\n    } else {\n        setupEscapeKey()\n        if (props.modalContext.isOpen) {\n            show()\n        }\n    }\n})\n\nonUnmounted(() => {\n    if (currentAnimation) {\n        currentAnimation.cancel()\n    }\n    if (props.useNativeDialog) {\n        if (dialogRef.value?.open) {\n            dialogRef.value.close()\n        }\n    } else {\n        cleanupFocusTrap_()\n        cleanupEscapeKey_()\n    }\n})\n\nwatch(\n    () => props.modalContext.onTopOfStack,\n    (onTop) => {\n        if (props.useNativeDialog) return\n\n        if (onTop) {\n            setupEscapeKey()\n            if (entered.value) {\n                setupFocusTrap()\n            }\n        } else {\n            cleanupFocusTrap_()\n            cleanupEscapeKey_()\n        }\n    },\n)\n\nwatch(\n    () => props.modalContext.isOpen,\n    (isOpen) => {\n        if (props.useNativeDialog) {\n            if (isOpen) {\n                openDialog()\n            } else {\n                closeDialog()\n            }\n        } else {\n            if (isOpen) {\n                show()\n            } else {\n                hide()\n            }\n        }\n    },\n)\n</script>\n\n<template>\n    <!-- Native dialog mode -->\n    <dialog\n        v-if=\"useNativeDialog\"\n        ref=\"dialogRef\"\n        :class=\"[\n            'im-modal-dialog m-0 overflow-visible bg-transparent p-0',\n            'size-full max-h-none max-w-none',\n            'backdrop:bg-black/75 backdrop:transition-opacity backdrop:duration-300',\n            isVisible ? 'backdrop:opacity-100' : 'backdrop:opacity-0',\n            !isFirstModal && 'backdrop:bg-transparent',\n        ]\"\n        @cancel=\"handleCancel\"\n        @click=\"handleDialogClick\"\n    >\n        <div class=\"im-modal-container fixed inset-0 overflow-y-auto p-4\">\n            <div\n                class=\"im-modal-positioner flex min-h-full justify-center\"\n                :class=\"{\n                    'items-start': config.position === 'top',\n                    'items-center': config.position === 'center',\n                    'items-end': config.position === 'bottom',\n                }\"\n            >\n                <div\n                    ref=\"nativeWrapperRef\"\n                    :class=\"[\n                        'im-modal-wrapper w-full transition-[filter] duration-300',\n                        modalContext.onTopOfStack ? '' : 'blur-xs',\n                        maxWidthClass,\n                    ]\"\n                >\n                    <div\n                        class=\"im-modal-content relative\"\n                        :data-inertiaui-modal-entered=\"entered\"\n                        :class=\"[config.paddingClasses, config.panelClasses]\"\n                    >\n                        <div\n                            v-if=\"config.closeButton\"\n                            class=\"absolute right-0 top-0 pr-3 pt-3\"\n                        >\n                            <CloseButton />\n                        </div>\n\n                        <slot\n                            :modal-context=\"modalContext\"\n                            :config=\"config\"\n                        />\n                    </div>\n                </div>\n            </div>\n        </div>\n    </dialog>\n\n    <!-- Non-native dialog mode -->\n    <div\n        v-else-if=\"isRendered\"\n        class=\"im-modal-container fixed inset-0 z-40 overflow-y-auto p-4\"\n        @mousedown.self=\"handleClickOutside\"\n    >\n        <div\n            class=\"im-modal-positioner flex min-h-full justify-center\"\n            :class=\"{\n                'items-start': config.position === 'top',\n                'items-center': config.position === 'center',\n                'items-end': config.position === 'bottom',\n            }\"\n            @mousedown.self=\"handleClickOutside\"\n        >\n            <div\n                ref=\"wrapperRef\"\n                role=\"dialog\"\n                aria-modal=\"true\"\n                :class=\"[\n                    'im-modal-wrapper w-full transition-[filter] duration-300',\n                    modalContext.onTopOfStack ? '' : 'blur-xs',\n                    maxWidthClass,\n                ]\"\n            >\n                <span class=\"sr-only\">Dialog</span>\n\n                <div\n                    class=\"im-modal-content relative\"\n                    :data-inertiaui-modal-entered=\"entered\"\n                    :class=\"[config.paddingClasses, config.panelClasses]\"\n                >\n                    <div\n                        v-if=\"config.closeButton\"\n                        class=\"absolute right-0 top-0 pr-3 pt-3\"\n                    >\n                        <CloseButton />\n                    </div>\n\n                    <slot\n                        :modal-context=\"modalContext\"\n                        :config=\"config\"\n                    />\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n","<script setup>\nimport { ref, onMounted, onUnmounted, watch, computed, nextTick } from 'vue'\nimport CloseButton from './CloseButton.vue'\nimport { createFocusTrap, onEscapeKey } from './dialog'\nimport { getMaxWidthClass } from './constants'\n\nconst props = defineProps({\n    modalContext: Object,\n    config: Object,\n    useNativeDialog: Boolean,\n    isFirstModal: Boolean,\n})\n\nconst emit = defineEmits(['after-leave'])\n\nconst isRendered = ref(false)\nconst isVisible = ref(false)  // For backdrop sync\nconst entered = ref(false)    // After animation completes\nconst wrapperRef = ref(null)\nconst dialogRef = ref(null)\nconst nativeWrapperRef = ref(null)\n\nlet cleanupFocusTrap = null\nlet cleanupEscapeKey = null\nlet currentAnimation = null\n\nconst maxWidthClass = computed(() => getMaxWidthClass(props.config.maxWidth))\n\n// Get translate value based on position\nconst getTranslateX = () => props.config.position === 'left' ? '-100%' : '100%'\n\n// ============ Animation handlers using Web Animations API ============\n\nasync function animateIn(element) {\n    if (!element) return\n\n    isVisible.value = true  // Trigger backdrop immediately\n    const translateX = getTranslateX()\n\n    currentAnimation = element.animate([\n        { transform: `translate3d(${translateX}, 0, 0)`, opacity: 0 },\n        { transform: 'translate3d(0, 0, 0)', opacity: 1 }\n    ], {\n        duration: 300,\n        easing: 'cubic-bezier(0.4, 0, 0.2, 1)',  // Tailwind's ease-in-out\n        fill: 'forwards'\n    })\n\n    await currentAnimation.finished\n    entered.value = true\n    setupFocusTrap()\n}\n\nasync function animateOut(element) {\n    if (!element) return\n\n    isVisible.value = false  // Trigger backdrop fade out immediately\n    const translateX = getTranslateX()\n\n    currentAnimation = element.animate([\n        { transform: 'translate3d(0, 0, 0)', opacity: 1 },\n        { transform: `translate3d(${translateX}, 0, 0)`, opacity: 0 }\n    ], {\n        duration: 300,\n        easing: 'cubic-bezier(0.4, 0, 0.2, 1)',  // Tailwind's ease-in-out\n        fill: 'forwards'\n    })\n\n    await currentAnimation.finished\n\n    isRendered.value = false\n    if (props.useNativeDialog && dialogRef.value) {\n        dialogRef.value.close()\n    }\n    emit('after-leave')\n    props.modalContext.afterLeave()\n}\n\nfunction show() {\n    isRendered.value = true\n    nextTick(() => {\n        const wrapper = props.useNativeDialog ? nativeWrapperRef.value : wrapperRef.value\n        animateIn(wrapper)\n    })\n}\n\nfunction hide() {\n    entered.value = false\n    const wrapper = props.useNativeDialog ? nativeWrapperRef.value : wrapperRef.value\n    animateOut(wrapper)\n}\n\n// ============ Non-native dialog handlers ============\n\nfunction setupFocusTrap() {\n    if (props.useNativeDialog) return\n    if (!wrapperRef.value || !props.modalContext.onTopOfStack) return\n    if (cleanupFocusTrap) return\n\n    cleanupFocusTrap = createFocusTrap(wrapperRef.value, {\n        initialFocus: true,\n        returnFocus: false,\n    })\n}\n\nfunction cleanupFocusTrap_() {\n    if (cleanupFocusTrap) {\n        cleanupFocusTrap()\n        cleanupFocusTrap = null\n    }\n}\n\nfunction setupEscapeKey() {\n    if (props.useNativeDialog) return\n    if (cleanupEscapeKey) return\n    if (props.config?.closeExplicitly) return\n\n    cleanupEscapeKey = onEscapeKey(() => {\n        if (props.modalContext.onTopOfStack) {\n            props.modalContext.close()\n        }\n    })\n}\n\nfunction cleanupEscapeKey_() {\n    if (cleanupEscapeKey) {\n        cleanupEscapeKey()\n        cleanupEscapeKey = null\n    }\n}\n\nfunction handleClickOutside(event) {\n    if (props.useNativeDialog) return\n    if (!props.modalContext.onTopOfStack) return\n    if (props.config?.closeExplicitly) return\n    if (props.config?.closeOnClickOutside === false) return\n    if (!wrapperRef.value) return\n\n    if (!wrapperRef.value.contains(event.target)) {\n        props.modalContext.close()\n    }\n}\n\n// ============ Native dialog handlers ============\n\nfunction handleCancel(event) {\n    event.preventDefault()\n    if (props.modalContext.onTopOfStack && !props.config?.closeExplicitly) {\n        props.modalContext.close()\n    }\n}\n\nfunction handleDialogClick(event) {\n    if (event.target === dialogRef.value) {\n        if (props.modalContext.onTopOfStack && !props.config?.closeExplicitly && props.config?.closeOnClickOutside !== false) {\n            props.modalContext.close()\n        }\n    }\n}\n\nfunction openDialog() {\n    if (dialogRef.value && !dialogRef.value.open) {\n        dialogRef.value.showModal()\n        nextTick(() => {\n            animateIn(nativeWrapperRef.value)\n        })\n    }\n}\n\nfunction closeDialog() {\n    if (dialogRef.value && dialogRef.value.open) {\n        entered.value = false\n        animateOut(nativeWrapperRef.value)\n    }\n}\n\n// ============ Lifecycle ============\n\nonMounted(() => {\n    if (props.useNativeDialog) {\n        if (props.modalContext.isOpen) {\n            openDialog()\n        }\n    } else {\n        setupEscapeKey()\n        if (props.modalContext.isOpen) {\n            show()\n        }\n    }\n})\n\nonUnmounted(() => {\n    if (currentAnimation) {\n        currentAnimation.cancel()\n    }\n    if (props.useNativeDialog) {\n        if (dialogRef.value?.open) {\n            dialogRef.value.close()\n        }\n    } else {\n        cleanupFocusTrap_()\n        cleanupEscapeKey_()\n    }\n})\n\nwatch(\n    () => props.modalContext.onTopOfStack,\n    (onTop) => {\n        if (props.useNativeDialog) return\n\n        if (onTop) {\n            setupEscapeKey()\n            if (entered.value) {\n                setupFocusTrap()\n            }\n        } else {\n            cleanupFocusTrap_()\n            cleanupEscapeKey_()\n        }\n    },\n)\n\nwatch(\n    () => props.modalContext.isOpen,\n    (isOpen) => {\n        if (props.useNativeDialog) {\n            if (isOpen) {\n                openDialog()\n            } else {\n                closeDialog()\n            }\n        } else {\n            if (isOpen) {\n                show()\n            } else {\n                hide()\n            }\n        }\n    },\n)\n</script>\n\n<template>\n    <!-- Native dialog mode -->\n    <dialog\n        v-if=\"useNativeDialog\"\n        ref=\"dialogRef\"\n        :class=\"[\n            'im-slideover-dialog m-0 overflow-visible bg-transparent p-0',\n            'size-full max-h-none max-w-none',\n            'backdrop:bg-black/75 backdrop:transition-opacity backdrop:duration-300',\n            isVisible ? 'backdrop:opacity-100' : 'backdrop:opacity-0',\n            !isFirstModal && 'backdrop:bg-transparent',\n        ]\"\n        @cancel=\"handleCancel\"\n        @click=\"handleDialogClick\"\n    >\n        <div class=\"im-slideover-container fixed inset-0 overflow-y-auto overflow-x-hidden\">\n            <div\n                class=\"im-slideover-positioner flex min-h-full items-center\"\n                :class=\"{\n                    'justify-start rtl:justify-end': config.position === 'left',\n                    'justify-end rtl:justify-start': config.position === 'right',\n                }\"\n            >\n                <div\n                    ref=\"nativeWrapperRef\"\n                    :class=\"[\n                        'im-slideover-wrapper w-full transition-[filter] duration-300',\n                        modalContext.onTopOfStack ? '' : 'blur-xs',\n                        maxWidthClass,\n                    ]\"\n                >\n                    <div\n                        class=\"im-slideover-content relative\"\n                        :data-inertiaui-modal-entered=\"entered\"\n                        :class=\"[config.paddingClasses, config.panelClasses]\"\n                    >\n                        <div\n                            v-if=\"config.closeButton\"\n                            class=\"absolute right-0 top-0 pr-3 pt-3\"\n                        >\n                            <CloseButton />\n                        </div>\n\n                        <slot\n                            :modal-context=\"modalContext\"\n                            :config=\"config\"\n                        />\n                    </div>\n                </div>\n            </div>\n        </div>\n    </dialog>\n\n    <!-- Non-native dialog mode -->\n    <div\n        v-else-if=\"isRendered\"\n        class=\"im-slideover-container fixed inset-0 z-40 overflow-y-auto overflow-x-hidden\"\n        @mousedown.self=\"handleClickOutside\"\n    >\n        <div\n            class=\"im-slideover-positioner flex min-h-full items-center\"\n            :class=\"{\n                'justify-start rtl:justify-end': config.position === 'left',\n                'justify-end rtl:justify-start': config.position === 'right',\n            }\"\n            @mousedown.self=\"handleClickOutside\"\n        >\n            <div\n                ref=\"wrapperRef\"\n                role=\"dialog\"\n                aria-modal=\"true\"\n                :class=\"[\n                    'im-slideover-wrapper w-full transition-[filter] duration-300',\n                    modalContext.onTopOfStack ? '' : 'blur-xs',\n                    maxWidthClass,\n                ]\"\n            >\n                <span class=\"sr-only\">Dialog</span>\n\n                <div\n                    class=\"im-slideover-content relative\"\n                    :data-inertiaui-modal-entered=\"entered\"\n                    :class=\"[config.paddingClasses, config.panelClasses]\"\n                >\n                    <div\n                        v-if=\"config.closeButton\"\n                        class=\"absolute right-0 top-0 pr-3 pt-3\"\n                    >\n                        <CloseButton />\n                    </div>\n\n                    <slot\n                        :modal-context=\"modalContext\"\n                        :config=\"config\"\n                    />\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n","<script setup>\nimport ModalContent from './ModalContent.vue'\nimport HeadlessModal from './HeadlessModal.vue'\nimport SlideoverContent from './SlideoverContent.vue'\nimport { onMounted, onUnmounted, ref, computed } from 'vue'\nimport { lockScroll, markAriaHidden } from './dialog'\nimport { getConfig } from './config'\n\nconst modal = ref(null)\nconst rendered = ref(false)\n\nconst emits = defineEmits(['after-leave', 'blur', 'close', 'focus', 'success'])\n\ndefineExpose({\n    afterLeave: () => modal.value?.afterLeave(),\n    close: () => modal.value?.close(),\n    emit: (...args) => modal.value?.emit(...args),\n    getChildModal: () => modal.value?.getChildModal(),\n    getParentModal: () => modal.value?.getParentModal(),\n    reload: (...args) => modal.value?.reload(...args),\n    setOpen: (...args) => modal.value?.setOpen(...args),\n\n    get config() {\n        return modal.value?.config\n    },\n    get id() {\n        return modal.value?.id\n    },\n    get index() {\n        return modal.value?.index\n    },\n    get isOpen() {\n        return modal.value?.isOpen\n    },\n    get modalContext() {\n        return modal.value?.modalContext\n    },\n    get onTopOfStack() {\n        return modal.value?.onTopOfStack\n    },\n    get shouldRender() {\n        return modal.value?.shouldRender\n    },\n})\n\n// Cleanup functions for scroll lock and aria-hidden\nlet cleanupScrollLock = null\nlet cleanupAriaHidden = null\n\nonMounted(() => {\n    // Initial setup if modal is already open\n    // Only call lockScroll if not already set (onSuccessEvent may have already called it)\n    if (modal.value?.isOpen && !cleanupScrollLock) {\n        cleanupScrollLock = lockScroll()\n        cleanupAriaHidden = markAriaHidden(getConfig('appElement'))\n    }\n})\n\nonUnmounted(() => {\n    cleanupScrollLock?.()\n    cleanupAriaHidden?.()\n})\n\n// Handle open state changes\nfunction onSuccessEvent() {\n    emits('success')\n    if (!cleanupScrollLock) {\n        cleanupScrollLock = lockScroll()\n        cleanupAriaHidden = markAriaHidden(getConfig('appElement'))\n    }\n}\n\nfunction onCloseEvent() {\n    emits('close')\n    cleanupScrollLock?.()\n    cleanupAriaHidden?.()\n    cleanupScrollLock = null\n    cleanupAriaHidden = null\n}\n\nconst useNativeDialog = computed(() => getConfig('useNativeDialog'))\n</script>\n\n<template>\n    <HeadlessModal\n        ref=\"modal\"\n        v-slot=\"{\n            afterLeave,\n            close,\n            config,\n            emit,\n            getChildModal,\n            getParentModal,\n            id,\n            index,\n            isOpen,\n            modalContext,\n            onTopOfStack,\n            reload,\n            setOpen,\n            shouldRender,\n            ...props\n        }\"\n        @success=\"onSuccessEvent\"\n        @close=\"onCloseEvent\"\n        @focus=\"emits('focus')\"\n        @blur=\"emits('blur')\"\n    >\n        <Teleport to=\"body\">\n            <div\n                :data-inertiaui-modal-id=\"id\"\n                :data-inertiaui-modal-index=\"index\"\n                class=\"im-dialog relative z-20\"\n                :aria-hidden=\"!onTopOfStack\"\n            >\n                <!-- Only render backdrop for the first modal (non-native dialog mode) -->\n                <!-- Native dialog uses ::backdrop pseudo-element instead -->\n                <Transition\n                    v-if=\"index === 0 && !useNativeDialog\"\n                    :appear=\"!rendered\"\n                    enter-active-class=\"transition transform ease-in-out duration-300\"\n                    enter-from-class=\"opacity-0\"\n                    enter-to-class=\"opacity-100\"\n                    leave-active-class=\"transition transform ease-in-out duration-300\"\n                    leave-from-class=\"opacity-100\"\n                    leave-to-class=\"opacity-0\"\n                    @after-appear=\"rendered = true\"\n                >\n                    <div\n                        v-if=\"isOpen\"\n                        class=\"im-backdrop fixed inset-0 z-30 bg-black/75\"\n                    />\n                </Transition>\n\n                <!-- The modal/slideover content itself -->\n                <component\n                    :is=\"config?.slideover ? SlideoverContent : ModalContent\"\n                    :modal-context=\"modalContext\"\n                    :config=\"config\"\n                    :use-native-dialog=\"useNativeDialog\"\n                    :is-first-modal=\"index === 0\"\n                    @after-leave=\"$emit('after-leave')\"\n                >\n                    <slot\n                        v-bind=\"props\"\n                        :id=\"id\"\n                        :after-leave=\"afterLeave\"\n                        :close=\"close\"\n                        :config=\"config\"\n                        :emit=\"emit\"\n                        :get-child-modal=\"getChildModal\"\n                        :get-parent-modal=\"getParentModal\"\n                        :index=\"index\"\n                        :is-open=\"isOpen\"\n                        :modal-context=\"modalContext\"\n                        :on-top-of-stack=\"onTopOfStack\"\n                        :reload=\"reload\"\n                        :set-open=\"setOpen\"\n                        :should-render=\"shouldRender\"\n                    />\n                </component>\n            </div>\n        </Teleport>\n    </HeadlessModal>\n</template>\n","<script setup>\nimport { modalPropNames, useModalStack, prefetch as prefetchModal } from './modalStack'\nimport { ref, provide, computed, watch, useAttrs, onBeforeUnmount, onMounted } from 'vue'\nimport { only, rejectNullValues } from './helpers'\nimport { getConfig } from './config'\n\nconst props = defineProps({\n    href: {\n        type: String,\n        required: true,\n    },\n    method: {\n        type: String,\n        default: 'get',\n    },\n    data: {\n        type: Object,\n        default: () => ({}),\n    },\n    as: {\n        type: [String, Object],\n        default: 'a',\n    },\n    headers: {\n        type: Object,\n        default: () => ({}),\n    },\n    queryStringArrayFormat: {\n        type: String,\n        default: 'brackets',\n    },\n    navigate: {\n        type: Boolean,\n        default: null,\n    },\n    // Prefetch options (#146)\n    prefetch: {\n        type: [Boolean, String, Array],\n        default: false,\n    },\n    cacheFor: {\n        type: Number,\n        default: 30000,\n    },\n    // Passthrough to Modal.vue\n    closeButton: {\n        type: Boolean,\n        required: false,\n        default: null,\n    },\n    closeExplicitly: {\n        type: Boolean,\n        required: false,\n        default: null,\n    },\n    closeOnClickOutside: {\n        type: Boolean,\n        required: false,\n        default: null,\n    },\n    maxWidth: {\n        type: String,\n        required: false,\n        default: null,\n    },\n    paddingClasses: {\n        type: [Boolean, String],\n        required: false,\n        default: null,\n    },\n    panelClasses: {\n        type: [Boolean, String],\n        required: false,\n        default: null,\n    },\n    position: {\n        type: String,\n        required: false,\n        default: null,\n    },\n    slideover: {\n        type: Boolean,\n        required: false,\n        default: null,\n    },\n})\n\nconst loading = ref(false)\nconst modalStack = useModalStack()\nconst modalContext = ref(null)\n\nprovide('modalContext', modalContext)\n\nconst emit = defineEmits(['after-leave', 'blur', 'close', 'error', 'focus', 'start', 'success', 'prefetching', 'prefetched'])\nconst isBlurred = ref(false)\n\nconst shouldNavigate = computed(() => {\n    return props.navigate ?? getConfig('navigate')\n})\n\n// Prefetch logic (#146)\nconst hoverTimeout = ref(null)\n\nconst prefetchModes = computed(() => {\n    if (props.prefetch === true) {\n        return ['hover']\n    }\n    if (props.prefetch === false) {\n        return []\n    }\n    if (Array.isArray(props.prefetch)) {\n        return props.prefetch\n    }\n    return [props.prefetch]\n})\n\nfunction doPrefetch() {\n    prefetchModal(props.href, {\n        method: props.method,\n        data: props.data,\n        headers: props.headers,\n        queryStringArrayFormat: props.queryStringArrayFormat,\n        cacheFor: props.cacheFor,\n        onPrefetching: () => emit('prefetching'),\n        onPrefetched: () => emit('prefetched'),\n    })\n}\n\nfunction onMouseenter() {\n    if (!prefetchModes.value.includes('hover')) return\n\n    hoverTimeout.value = setTimeout(() => {\n        doPrefetch()\n    }, 75) // Small delay to avoid prefetching on accidental hovers\n}\n\nfunction onMouseleave() {\n    if (hoverTimeout.value) {\n        clearTimeout(hoverTimeout.value)\n        hoverTimeout.value = null\n    }\n}\n\nfunction onMousedown(event) {\n    if (!prefetchModes.value.includes('click')) return\n    if (event.button !== 0) return // Only left click\n\n    doPrefetch()\n}\n\nonMounted(() => {\n    if (prefetchModes.value.includes('mount')) {\n        doPrefetch()\n    }\n})\n\nwatch(\n    () => modalContext.value?.onTopOfStack,\n    (onTopOfStack) => {\n        if (modalContext.value) {\n            if (onTopOfStack && isBlurred.value) {\n                emit('focus')\n            } else if (!onTopOfStack) {\n                emit('blur')\n            }\n\n            isBlurred.value = !onTopOfStack\n        }\n    },\n)\n\nconst unsubscribeEventListeners = ref(null)\n\nonBeforeUnmount(() => {\n    unsubscribeEventListeners.value?.()\n    if (hoverTimeout.value) {\n        clearTimeout(hoverTimeout.value)\n    }\n})\n\nconst $attrs = useAttrs()\n\nfunction registerEventListeners() {\n    unsubscribeEventListeners.value = modalContext.value.registerEventListenersFromAttrs($attrs)\n}\n\nwatch(modalContext, (value, oldValue) => {\n    if (value && !oldValue) {\n        registerEventListeners()\n        emit('success')\n    }\n})\n\nfunction onClose() {\n    emit('close')\n}\n\nfunction onAfterLeave() {\n    modalContext.value = null\n    emit('after-leave')\n}\n\nfunction handle() {\n    if (loading.value) {\n        return\n    }\n\n    if (!props.href.startsWith('#')) {\n        loading.value = true\n        emit('start')\n    }\n\n    modalStack\n        .visit(\n            props.href,\n            props.method,\n            props.data,\n            props.headers,\n            rejectNullValues(only(props, modalPropNames)),\n            onClose,\n            onAfterLeave,\n            props.queryStringArrayFormat,\n            shouldNavigate.value,\n        )\n        .then((context) => {\n            modalContext.value = context\n        })\n        .catch((error) => {\n            console.error(error)\n            emit('error', error)\n        })\n        .finally(() => (loading.value = false))\n}\n</script>\n\n<template>\n    <component\n        v-bind=\"$attrs\"\n        :is=\"as\"\n        :href=\"href\"\n        @click.prevent=\"handle\"\n        @mouseenter=\"onMouseenter\"\n        @mouseleave=\"onMouseleave\"\n        @mousedown=\"onMousedown\"\n    >\n        <slot :loading=\"loading\" />\n    </component>\n</template>\n","<script setup>\n// See: https://github.com/inertiajs/inertia/blob/48bcd21fb7daf467d0df1bfde2408f161f94a579/packages/vue3/src/whenVisible.ts\nimport { ref, onMounted, onUnmounted, inject } from 'vue'\n\nconst props = defineProps({\n    data: [String, Array],\n    params: Object,\n    buffer: { type: Number, default: 0 },\n    as: { type: String, default: 'div' },\n    always: { type: Boolean, default: false },\n})\n\nconst modalContext = inject('modalContext')\n\nif (!modalContext) {\n    throw new Error('Deferred component must be used inside a Modal component')\n}\n\nconst loaded = ref(false)\nconst fetching = ref(false)\nconst rootElement = ref(null)\nlet observer = null\n\nconst getReloadParams = () => {\n    if (props.data) {\n        return { only: Array.isArray(props.data) ? props.data : [props.data] }\n    }\n\n    if (!props.params) {\n        throw new Error('You must provide either a `data` or `params` prop.')\n    }\n\n    return props.params\n}\n\nconst observeElement = () => {\n    if (!rootElement.value) {\n        return\n    }\n\n    observer = new IntersectionObserver(\n        (entries) => {\n            if (!entries[0].isIntersecting) {\n                return\n            }\n\n            if (!props.always) {\n                observer.disconnect()\n            }\n\n            if (fetching.value) {\n                return\n            }\n\n            fetching.value = true\n            const reloadParams = getReloadParams()\n\n            modalContext.value.reload({\n                ...reloadParams,\n                onStart: () => {\n                    fetching.value = true\n                    reloadParams.onStart?.()\n                },\n                onFinish: () => {\n                    loaded.value = true\n                    fetching.value = false\n                    reloadParams.onFinish?.()\n                },\n            })\n        },\n        { rootMargin: `${props.buffer}px` },\n    )\n\n    observer.observe(rootElement.value)\n}\n\nonMounted(observeElement)\nonUnmounted(() => observer?.disconnect())\n</script>\n\n<template>\n    <component\n        :is=\"props.as\"\n        ref=\"rootElement\"\n    >\n        <slot v-if=\"loaded\"></slot>\n        <slot\n            v-else\n            name=\"fallback\"\n        ></slot>\n    </component>\n</template>\n","import { getConfig, putConfig, resetConfig } from './config'\nimport { useModalStack, initFromPageProps, renderApp, Modal as ModalClass, modalPropNames, prefetch } from './modalStack'\nimport type { ModalStack, ModalResponseData, ModalConfig, ReloadOptions, VisitOptions, PrefetchOption, PrefetchOptions } from './modalStack'\nimport useModal from './useModal'\nimport Deferred from './Deferred.vue'\nimport HeadlessModal from './HeadlessModal.vue'\nimport ModalComponent from './Modal.vue'\nimport ModalLink from './ModalLink.vue'\nimport ModalRoot from './ModalRoot.vue'\nimport WhenVisible from './WhenVisible.vue'\nimport * as dialogUtils from './dialog'\nimport { kebabCase } from './helpers'\n\nfunction visitModal(url: string, options: VisitOptions = {}): Promise<ModalClass> {\n    return useModalStack()\n        .visit(\n            url,\n            options.method ?? 'get',\n            options.data ?? {},\n            options.headers ?? {},\n            options.config ?? {},\n            options.onClose,\n            options.onAfterLeave,\n            options.queryStringArrayFormat ?? 'brackets',\n            options.navigate ?? (getConfig('navigate') as boolean),\n            options.onStart,\n            options.onSuccess,\n            options.onError,\n            options.props ?? null,\n        )\n        .then((modal) => {\n            const listeners = options.listeners ?? {}\n\n            Object.keys(listeners).forEach((event) => {\n                // e.g. refreshKey -> refresh-key\n                const eventName = kebabCase(event)\n                modal.on(eventName, listeners[event])\n            })\n\n            return modal\n        })\n}\n\nexport {\n    // Components\n    Deferred,\n    HeadlessModal,\n    ModalComponent as Modal,\n    ModalLink,\n    ModalRoot,\n    WhenVisible,\n    // Config functions\n    getConfig,\n    putConfig,\n    resetConfig,\n    // Modal stack functions\n    initFromPageProps,\n    renderApp,\n    useModal,\n    useModalStack,\n    visitModal,\n    modalPropNames,\n    // Prefetch function (#146)\n    prefetch,\n    // Modal class (exported as ModalInstance to avoid conflict with Modal component)\n    ModalClass as ModalInstance,\n    // Dialog utilities (framework-agnostic)\n    dialogUtils,\n}\n\n// Export types\nexport type { ModalStack, ModalResponseData, ModalConfig, ReloadOptions, VisitOptions, PrefetchOption, PrefetchOptions }\nexport type { ModalTypeConfig } from './config'\nexport type {\n    CleanupFunction,\n    FocusTrapOptions,\n    ClickOutsideOptions,\n    EscapeKeyOptions,\n    DialogOptions,\n    Dialog,\n} from './dialog'\n"],"names":["vanillaGenerateId","_createBlock","_unref","_mergeProps","_renderSlot","ModalRenderer","response","ModalRoot","_createElementBlock","_createElementVNode","_normalizeClass","_hoisted_1","_openBlock","_hoisted_3","_createVNode","CloseButton","_hoisted_5","HeadlessModal","_Teleport","_Transition","_resolveDynamicComponent","SlideoverContent","ModalContent","$emit","prefetchModal"],"mappings":"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"}