{"version":3,"file":"inertiaui-modal.js","sources":["../src/config.ts","../src/helpers.ts","../src/ModalRenderer.vue","../src/ModalRoot.vue","../src/modalStack.ts","../src/useModal.ts","../src/Deferred.vue","../src/HeadlessModal.vue","../src/CloseButton.vue","../src/constants.ts","../src/ModalContent.vue","../src/SlideoverContent.vue","../src/Modal.vue","../src/ModalLink.vue","../src/WhenVisible.vue","../src/inertiauiModal.ts"],"sourcesContent":["export interface ModalTypeConfig {\n    closeButton: boolean\n    closeExplicitly: boolean\n    closeOnClickOutside: boolean\n    maxWidth: string\n    paddingClasses: string\n    panelClasses: string\n    position: string\n}\n\nexport interface ModalConfig {\n    type: 'modal' | 'slideover'\n    navigate: boolean\n    useNativeDialog: boolean\n    modal: ModalTypeConfig\n    slideover: ModalTypeConfig\n}\n\nconst defaultConfig: ModalConfig = {\n    type: 'modal',\n    navigate: false,\n    useNativeDialog: true,\n    modal: {\n        closeButton: true,\n        closeExplicitly: false,\n        closeOnClickOutside: true,\n        maxWidth: '2xl',\n        paddingClasses: 'p-4 sm:p-6',\n        panelClasses: 'bg-white rounded',\n        position: 'center',\n    },\n    slideover: {\n        closeButton: true,\n        closeExplicitly: false,\n        closeOnClickOutside: true,\n        maxWidth: 'md',\n        paddingClasses: 'p-4 sm:p-6',\n        panelClasses: 'bg-white min-h-screen',\n        position: 'right',\n    },\n}\n\nclass Config {\n    private config: ModalConfig\n\n    constructor() {\n        this.config = {} as ModalConfig\n        this.reset()\n    }\n\n    reset(): void {\n        this.config = JSON.parse(JSON.stringify(defaultConfig))\n    }\n\n    put(key: string | Partial<ModalConfig>, value?: unknown): void {\n        if (typeof key === 'object') {\n            this.config = {\n                type: key.type ?? defaultConfig.type,\n                navigate: key.navigate ?? defaultConfig.navigate,\n                useNativeDialog: key.useNativeDialog ?? defaultConfig.useNativeDialog,\n                modal: { ...defaultConfig.modal, ...(key.modal ?? {}) },\n                slideover: { ...defaultConfig.slideover, ...(key.slideover ?? {}) },\n            }\n            return\n        }\n        const keys = key.split('.')\n        let current: Record<string, unknown> = this.config as unknown as Record<string, unknown>\n        for (let i = 0; i < keys.length - 1; i++) {\n            current = (current[keys[i]] = current[keys[i]] || {}) as Record<string, unknown>\n        }\n        current[keys[keys.length - 1]] = value\n    }\n\n    get(key?: string): unknown {\n        if (typeof key === 'undefined') {\n            return this.config\n        }\n        const keys = key.split('.')\n        let current: unknown = this.config\n        for (const k of keys) {\n            if (current === null || current === undefined || typeof current !== 'object') {\n                return null\n            }\n            current = (current as Record<string, unknown>)[k]\n        }\n        return current === undefined ? null : current\n    }\n}\n\nconst configInstance = new Config()\n\nexport const resetConfig = (): void => configInstance.reset()\nexport const putConfig = (key: string | Partial<ModalConfig>, value?: unknown): void => configInstance.put(key, value)\nexport const getConfig = (key?: string): unknown => configInstance.get(key)\nexport const getConfigByType = (isSlideover: boolean, key: string): unknown =>\n    configInstance.get(isSlideover ? `slideover.${key}` : `modal.${key}`)\n","// Re-export from vanilla package\nimport { generateId as vanillaGenerateId, except, only, rejectNullValues, kebabCase, isStandardDomEvent } from '@inertiaui/vanilla'\nexport { except, only, rejectNullValues, kebabCase, isStandardDomEvent }\n\n// Modal-specific helpers\n\nlet generateIdUsingCallback: (() => string) | null = null\n\nfunction generateIdUsing(callback: () => string): void {\n    generateIdUsingCallback = callback\n}\n\nfunction generateId(prefix: string = 'inertiaui_modal_'): string {\n    if (generateIdUsingCallback) {\n        return generateIdUsingCallback()\n    }\n    return vanillaGenerateId(prefix)\n}\n\nfunction sameUrlPath(url1: string | URL, url2: string | URL): boolean {\n    const origin = typeof window !== 'undefined' ? window.location.origin : 'http://localhost'\n    const parsed1 = typeof url1 === 'string' ? new URL(url1, origin) : url1\n    const parsed2 = typeof url2 === 'string' ? new URL(url2, origin) : url2\n\n    return `${parsed1.origin}${parsed1.pathname}` === `${parsed2.origin}${parsed2.pathname}`\n}\n\nexport { generateIdUsing, generateId, sameUrlPath }\n","<script setup>\nimport { only } from './helpers'\nimport { useModalStack } from './modalStack'\nimport { computed, provide } from 'vue'\n\nconst props = defineProps({\n    index: {\n        type: Number,\n        required: true,\n    },\n})\n\nconst modalStack = useModalStack()\n\nconst modalContext = computed(() => {\n    return modalStack.stack.value[props.index]\n})\n\nprovide('modalContext', modalContext)\n</script>\n\n<template>\n    <modalContext.component\n        v-if=\"modalContext?.component\"\n        v-bind=\"only(modalContext.props ?? {}, modalContext.getComponentPropKeys(), true)\"\n        @modal-event=\"(event, ...args) => modalContext.emit(event, ...args)\"\n    />\n</template>\n","<script setup>\nimport { onBeforeMount, onMounted, onUnmounted, watch } from 'vue'\nimport { router, usePage } from '@inertiajs/vue3'\nimport { useModalStack } from './modalStack'\nimport ModalRenderer from './ModalRenderer.vue'\nimport { default as Axios } from 'axios'\nimport { sameUrlPath } from './helpers'\n\nconst modalStack = useModalStack()\nconst $page = usePage()\n\nlet isNavigating = false\nlet initialModalStillOpened = false\nconst pendingModalKeys = new Set()\n\n// Generate a unique key for deduplication (handles case when modal has no id)\nconst getModalKey = (modalData) => modalData.id || `${modalData.component}:${modalData.url}`\n\nonUnmounted(router.on('start', () => (isNavigating = true)))\nonUnmounted(router.on('finish', () => (isNavigating = false)))\nonUnmounted(\n    router.on('navigate', ($event) => {\n        const modalOnBase = $event.detail.page.props._inertiaui_modal\n        const pageUrl = $event.detail.page.url\n\n        if (!modalOnBase) {\n            // No modal data - close any open modals (force close without transition)\n            modalStack.closeAll(true)\n            modalStack.setBaseUrl(null)\n            initialModalStillOpened = false\n            return\n        }\n\n        // If the page URL doesn't match the modal URL, close all modals\n        // (handles browser back to non-modal URL when history state still has modal data)\n        if (!sameUrlPath(pageUrl, modalOnBase.url)) {\n            modalStack.closeAll(true)\n            modalStack.setBaseUrl(null)\n            initialModalStillOpened = false\n            return\n        }\n\n        modalStack.setBaseUrl(modalOnBase.baseUrl)\n\n        // Skip if this modal is already being pushed (handles duplicate navigate events)\n        const modalKey = getModalKey(modalOnBase)\n        if (pendingModalKeys.has(modalKey)) {\n            return\n        }\n\n        // Also skip if a modal with this id is already in the stack\n        if (modalOnBase.id && modalStack.stack.value.some((m) => m.id === modalOnBase.id)) {\n            return\n        }\n\n        // Skip if a modal with the same component and URL is already open\n        // (handles \"Edit again!\" case where same modal is revisited with new props)\n        if (modalStack.stack.value.some((m) => m.response?.component === modalOnBase.component && sameUrlPath(m.response?.url, modalOnBase.url))) {\n            return\n        }\n\n        pendingModalKeys.add(modalKey)\n\n        modalStack\n            .pushFromResponseData(modalOnBase, {}, () => {\n                if (!modalOnBase.baseUrl) {\n                    console.error('No base url in modal response data so cannot navigate back')\n                    return\n                }\n\n                if (!isNavigating && typeof window !== 'undefined' && window.location.href !== modalOnBase.baseUrl) {\n                    router.visit(modalOnBase.baseUrl, {\n                        preserveScroll: true,\n                        preserveState: true,\n                    })\n                }\n            })\n            .then(() => {\n                pendingModalKeys.delete(modalKey)\n            })\n    }),\n)\n\nconst axiosRequestInterceptor = (config) => {\n    // A Modal is opened on top of a base route, so we need to pass this base route\n    // so it can redirect back with the back() helper method...\n    // Only send the header when we have an actual base URL value\n    const baseUrlValue = modalStack.getBaseUrl() ?? (initialModalStillOpened ? $page.props._inertiaui_modal?.baseUrl : null)\n    if (baseUrlValue) {\n        config.headers['X-InertiaUI-Modal-Base-Url'] = baseUrlValue\n    }\n\n    return config\n}\n\nonBeforeMount(() => Axios.interceptors.request.use(axiosRequestInterceptor))\nonMounted(() => (initialModalStillOpened = !!$page.props._inertiaui_modal))\nonUnmounted(() => Axios.interceptors.request.eject(axiosRequestInterceptor))\n\nwatch(\n    () => $page.props?._inertiaui_modal,\n    (newModal, previousModal) => {\n        if (!newModal) {\n            return\n        }\n\n        // If there's a previous modal with same component/URL, update its props\n        if (previousModal && newModal.component === previousModal.component && sameUrlPath(newModal.url, previousModal.url)) {\n            modalStack.stack.value[0]?.updateProps(newModal.props ?? {})\n            return\n        }\n\n        // If there's no previous modal but we have modals in the stack (opened via XHR),\n        // check if the new modal matches any open modal and update its props\n        if (!previousModal && modalStack.stack.value.length > 0) {\n            const existingModal = modalStack.stack.value.find(\n                (m) => m.response?.component === newModal.component && sameUrlPath(m.response?.url, newModal.url),\n            )\n            if (existingModal) {\n                existingModal.updateProps(newModal.props ?? {})\n            }\n        }\n    },\n)\n</script>\n\n<template>\n    <slot />\n\n    <ModalRenderer\n        v-if=\"modalStack.stack.value.length\"\n        :index=\"0\"\n    />\n</template>\n","import { computed, readonly, ref, markRaw, h, nextTick, type Component, type Ref, type ComputedRef } from 'vue'\nimport { generateId, except, kebabCase } from './helpers'\nimport { router, usePage, progress } from '@inertiajs/vue3'\nimport { mergeDataIntoQueryString, type RequestPayload } from '@inertiajs/core'\nimport { default as Axios, type AxiosResponse } from 'axios'\nimport ModalRoot from './ModalRoot.vue'\n\n// Type definitions\nexport interface ModalResponseData {\n    id?: string\n    component: string\n    props: Record<string, unknown>\n    url?: string\n    version?: string\n    meta?: {\n        deferredProps?: Record<string, string[]>\n    }\n    baseUrl?: string\n}\n\nexport interface ModalConfig {\n    [key: string]: unknown\n}\n\nexport interface ReloadOptions {\n    only?: string[]\n    except?: string[]\n    method?: string\n    data?: Record<string, unknown>\n    headers?: Record<string, string>\n    onStart?: () => void\n    onSuccess?: (response: AxiosResponse) => void\n    onError?: (error: unknown) => void\n    onFinish?: () => void\n}\n\nexport interface VisitOptions {\n    method?: string\n    data?: RequestPayload\n    headers?: Record<string, string>\n    config?: ModalConfig\n    onClose?: () => void\n    onAfterLeave?: () => void\n    queryStringArrayFormat?: 'brackets' | 'indices'\n    navigate?: boolean\n    onStart?: () => void\n    onSuccess?: (response?: AxiosResponse) => void\n    onError?: (...args: unknown[]) => void\n    listeners?: Record<string, (...args: unknown[]) => void>\n    // Props to pass to local modals (#152)\n    props?: Record<string, unknown>\n}\n\n// Prefetch types (#146)\nexport type PrefetchOption = boolean | 'hover' | 'click' | 'mount' | Array<'hover' | 'click' | 'mount'>\n\nexport interface PrefetchOptions {\n    method?: string\n    data?: RequestPayload\n    headers?: Record<string, string>\n    queryStringArrayFormat?: 'brackets' | 'indices'\n    cacheFor?: number\n    onPrefetching?: () => void\n    onPrefetched?: () => void\n}\n\ntype EventCallback = (...args: unknown[]) => void\ntype ComponentResolver = (name: string) => Promise<Component>\n\nlet resolveComponent: ComponentResolver | null = null\n\nconst baseUrl = ref<string | null>(null)\nconst stack = ref<Modal[]>([])\nconst localModals = ref<Record<string, { name: string; callback: (modal: Modal) => void }>>({})\n\n// Prefetch cache (#146)\ninterface PrefetchCacheEntry {\n    response: AxiosResponse\n    timestamp: number\n    expiresAt: number\n}\n\nconst prefetchCache = new Map<string, PrefetchCacheEntry>()\nconst prefetchInFlight = new Map<string, Promise<AxiosResponse>>()\n\nfunction getPrefetchCacheKey(url: string, method: string, data: RequestPayload): string {\n    return `${method}:${url}:${JSON.stringify(data)}`\n}\n\nfunction getCachedResponse(url: string, method: string, data: RequestPayload): AxiosResponse | null {\n    const key = getPrefetchCacheKey(url, method, data)\n    const cached = prefetchCache.get(key)\n\n    if (!cached) {\n        return null\n    }\n\n    if (Date.now() > cached.expiresAt) {\n        prefetchCache.delete(key)\n        return null\n    }\n\n    return cached.response\n}\n\nfunction setCachedResponse(url: string, method: string, data: RequestPayload, response: AxiosResponse, cacheFor: number): void {\n    const key = getPrefetchCacheKey(url, method, data)\n    prefetchCache.set(key, {\n        response,\n        timestamp: Date.now(),\n        expiresAt: Date.now() + cacheFor,\n    })\n}\n\nexport function prefetch(href: string, options: PrefetchOptions = {}): Promise<void> {\n    if (href.startsWith('#')) {\n        return Promise.resolve()\n    }\n\n    const method = (options.method ?? 'get').toLowerCase()\n    const data = options.data ?? ({} as RequestPayload)\n    const headers = options.headers ?? {}\n    const queryStringArrayFormat = options.queryStringArrayFormat ?? 'brackets'\n    const cacheFor = options.cacheFor ?? 30000\n\n    const [url, mergedData] = mergeDataIntoQueryString(method as 'get' | 'post' | 'put' | 'patch' | 'delete', href || '', data, queryStringArrayFormat)\n\n    // Check if already cached\n    const cached = getCachedResponse(url, method, mergedData)\n    if (cached) {\n        return Promise.resolve()\n    }\n\n    // Check if already in flight\n    const cacheKey = getPrefetchCacheKey(url, method, mergedData)\n    const inFlight = prefetchInFlight.get(cacheKey)\n    if (inFlight) {\n        return inFlight.then(() => {})\n    }\n\n    options.onPrefetching?.()\n\n    const requestHeaders: Record<string, string | number | boolean | null> = {\n        ...headers,\n        Accept: 'text/html, application/xhtml+xml',\n        'X-Requested-With': 'XMLHttpRequest',\n        'X-Inertia': true,\n        'X-Inertia-Version': usePage().version ?? '',\n        'X-InertiaUI-Modal': generateId(),\n                'X-InertiaUI-Modal-Base-Url': baseUrl.value,\n    }\n\n    const request = Axios({ url, method, data: mergedData, headers: requestHeaders })\n        .then((response) => {\n            setCachedResponse(url, method, mergedData, response, cacheFor)\n            options.onPrefetched?.()\n            return response\n        })\n        .finally(() => {\n            prefetchInFlight.delete(cacheKey)\n        })\n\n    prefetchInFlight.set(cacheKey, request)\n\n    return request.then(() => {})\n}\n\nconst setComponentResolver = (resolver: ComponentResolver): void => {\n    resolveComponent = resolver\n}\n\nexport const initFromPageProps = (pageProps: { resolveComponent?: ComponentResolver }): void => {\n    if (pageProps.resolveComponent) {\n        resolveComponent = pageProps.resolveComponent\n    }\n}\n\nexport class Modal {\n    id: string\n    isOpen: boolean\n    shouldRender: boolean\n    listeners: Record<string, EventCallback[]>\n    component: Component | null\n    props: Ref<Record<string, unknown>>\n    response: ModalResponseData\n    config: ModalConfig\n    onCloseCallback: (() => void) | null\n    afterLeaveCallback: (() => void) | null\n    index: ComputedRef<number>\n    onTopOfStack: ComputedRef<boolean>\n    name?: string\n\n    constructor(\n        component: Component | null,\n        response: ModalResponseData,\n        config?: ModalConfig | null,\n        onClose?: (() => void) | null,\n        afterLeave?: (() => void) | null,\n    ) {\n        this.id = response.id ?? generateId()\n        this.isOpen = false\n        this.shouldRender = false\n        this.listeners = {}\n\n        this.component = component\n        this.props = ref(response.props ?? {})\n        this.response = response\n        this.config = config ?? {}\n        this.onCloseCallback = onClose ?? null\n        this.afterLeaveCallback = afterLeave ?? null\n\n        this.index = computed(() => stack.value.findIndex((m) => m.id === this.id))\n        this.onTopOfStack = computed(() => {\n            if (stack.value.length < 2) {\n                return true\n            }\n\n            const modals = stack.value.map((modal) => ({ id: modal.id, shouldRender: modal.shouldRender }))\n\n            return modals.reverse().find((modal) => modal.shouldRender)?.id === this.id\n        })\n    }\n\n    getComponentPropKeys = (): string[] => {\n        if (!this.component) {\n            return []\n        }\n\n        const componentProps = (this.component as Component & { props?: string[] | Record<string, unknown> }).props\n\n        if (Array.isArray(componentProps)) {\n            return componentProps\n        }\n\n        return componentProps ? Object.keys(componentProps) : []\n    }\n\n    getParentModal = (): Modal | null | undefined => {\n        const index = this.index.value\n\n        if (index < 1) {\n            // This is the first modal in the stack\n            return null\n        }\n\n        // Find the first open modal before this one\n        return stack.value\n            .slice(0, index)\n            .reverse()\n            .find((modal) => modal.isOpen) as unknown as Modal | undefined\n    }\n\n    getChildModal = (): Modal | null => {\n        const index = this.index.value\n\n        if (index === stack.value.length - 1) {\n            // This is the last modal in the stack\n            return null\n        }\n\n        // Find the first open modal after this one\n        return (stack.value.slice(index + 1).find((modal) => modal.isOpen) as unknown as Modal | undefined) ?? null\n    }\n\n    show = (): void => {\n        const index = this.index.value\n\n        if (index > -1) {\n            if (stack.value[index].isOpen) {\n                // Only open if the modal is closed\n                return\n            }\n\n            stack.value[index].isOpen = true\n            stack.value[index].shouldRender = true\n        }\n    }\n\n    close = (): void => {\n        const index = this.index.value\n\n        if (index > -1) {\n            if (!stack.value[index].isOpen) {\n                // Only close if the modal is open\n                return\n            }\n\n            Object.keys(this.listeners).forEach((event) => {\n                this.off(event)\n            })\n\n            stack.value[index].isOpen = false\n            this.onCloseCallback?.()\n            this.onCloseCallback = null\n        }\n    }\n\n    setOpen = (open: boolean): void => {\n        if (open) {\n            this.show()\n        } else {\n            this.close()\n        }\n    }\n\n    afterLeave = (): void => {\n        const index = this.index.value\n\n        if (index > -1) {\n            if (stack.value[index].isOpen) {\n                // Only execute the callback if the modal is closed\n                return\n            }\n\n            stack.value[index].shouldRender = false\n            this.afterLeaveCallback?.()\n            this.afterLeaveCallback = null\n        }\n\n        if (index === 0) {\n            stack.value = []\n\n            // Update browser URL back to base when all modals are closed\n            if (baseUrl.value && typeof window !== 'undefined') {\n                router.push({\n                    url: baseUrl.value,\n                    preserveScroll: true,\n                    preserveState: true,\n                    // Clear _inertiaui_modal prop to prevent modal from reopening\n                    // Must explicitly set to undefined since props are merged\n                    props: (currentProps: Record<string, unknown>) => {\n                        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n                        const { _inertiaui_modal, ...rest } = currentProps\n                        return { ...rest, _inertiaui_modal: undefined }\n                    },\n                })\n            }\n\n            baseUrl.value = null\n        }\n    }\n\n    on = (event: string, callback: EventCallback): void => {\n        event = kebabCase(event)\n        this.listeners[event] = this.listeners[event] ?? []\n        this.listeners[event].push(callback)\n    }\n\n    off = (event: string, callback?: EventCallback): void => {\n        event = kebabCase(event)\n        if (callback) {\n            this.listeners[event] = this.listeners[event]?.filter((cb) => cb !== callback) ?? []\n        } else {\n            delete this.listeners[event]\n        }\n    }\n\n    emit = (event: string, ...args: unknown[]): void => {\n        this.listeners[kebabCase(event)]?.forEach((callback) => callback(...args))\n    }\n\n    registerEventListenersFromAttrs = ($attrs: Record<string, unknown>): (() => void) => {\n        const unsubscribers: (() => void)[] = []\n\n        Object.keys($attrs)\n            .filter((key) => key.startsWith('on'))\n            .forEach((key) => {\n                const eventName = kebabCase(key).replace(/^on-/, '')\n                const callback = $attrs[key] as EventCallback\n                this.on(eventName, callback)\n                unsubscribers.push(() => this.off(eventName, callback))\n            })\n\n        return () => unsubscribers.forEach((unsub) => unsub())\n    }\n\n    reload = (options: ReloadOptions = {}): void => {\n        let keys = Object.keys(this.response.props)\n\n        if (options.only) {\n            keys = options.only\n        }\n\n        if (options.except) {\n            keys = except(keys, options.except) as string[]\n        }\n\n        if (!this.response?.url) {\n            return\n        }\n\n        const method = (options.method ?? 'get').toLowerCase()\n        const data = options.data ?? {}\n\n        options.onStart?.()\n\n        Axios({\n            url: this.response.url,\n            method,\n            data: method === 'get' ? {} : data,\n            params: method === 'get' ? data : {},\n            headers: {\n                ...(options.headers ?? {}),\n                Accept: 'text/html, application/xhtml+xml',\n                'X-Inertia': true,\n                'X-Inertia-Partial-Component': this.response.component,\n                'X-Inertia-Version': this.response.version ?? '',\n                'X-Inertia-Partial-Data': keys.join(','),\n                'X-InertiaUI-Modal': generateId(),\n                                'X-InertiaUI-Modal-Base-Url': baseUrl.value,\n            },\n        })\n            .then((response) => {\n                this.updateProps(response.data.props)\n                options.onSuccess?.(response)\n            })\n            .catch((error) => {\n                options.onError?.(error)\n            })\n            .finally(() => {\n                options.onFinish?.()\n            })\n    }\n\n    updateProps = (props: Record<string, unknown>): void => {\n        Object.assign(this.props.value, props)\n    }\n}\n\nfunction registerLocalModal(name: string, callback: (modal: Modal) => void): void {\n    localModals.value[name] = { name, callback }\n}\n\nfunction pushLocalModal(\n    name: string,\n    config?: ModalConfig | null,\n    onClose?: (() => void) | null,\n    afterLeave?: (() => void) | null,\n    props?: Record<string, unknown> | null,\n): Modal {\n    if (!localModals.value[name]) {\n        throw new Error(`The local modal \"${name}\" has not been registered.`)\n    }\n\n    const responseData = { props: props ?? {} } as ModalResponseData\n    const modal = push(null, responseData, config, onClose, afterLeave)\n    modal.name = name\n    localModals.value[name].callback(modal)\n    return modal\n}\n\nfunction isValidModalResponse(data: unknown): data is ModalResponseData {\n    return (\n        typeof data === 'object' &&\n        data !== null &&\n        'component' in data &&\n        typeof (data as ModalResponseData).component === 'string'\n    )\n}\n\nfunction updateBrowserUrl(url: string | undefined, useBrowserHistory: boolean, modalData?: ModalResponseData): void {\n    if (!url || !useBrowserHistory || typeof window === 'undefined') {\n        return\n    }\n\n    router.push({\n        url,\n        preserveScroll: true,\n        preserveState: true,\n        // Store modal data in page props for history navigation\n        // This allows forward/back to restore the modal\n        props: modalData\n            ? (currentProps: Record<string, unknown>) => ({\n                  ...currentProps,\n                  _inertiaui_modal: {\n                      ...modalData,\n                      baseUrl: baseUrl.value,\n                  },\n              })\n            : undefined,\n    })\n}\n\nfunction pushFromResponseData(\n    responseData: ModalResponseData,\n    config: ModalConfig = {},\n    onClose: (() => void) | null = null,\n    onAfterLeave: (() => void) | null = null,\n): Promise<Modal> {\n    if (!resolveComponent) {\n        return Promise.reject(new Error('Component resolver not set'))\n    }\n\n    if (!isValidModalResponse(responseData)) {\n        return Promise.reject(\n            new Error(\n                'Invalid modal response. This usually happens when the server returns a redirect (e.g., due to session expiration). ' +\n                    'Check if the user is still authenticated.',\n            ),\n        )\n    }\n\n    return resolveComponent(responseData.component).then((component) =>\n        push(markRaw(component), responseData, config, onClose, onAfterLeave),\n    )\n}\n\nfunction visit(\n    href: string,\n    method: string,\n    payload: RequestPayload = {},\n    headers: Record<string, string> = {},\n    config: ModalConfig = {},\n    onClose: (() => void) | null = null,\n    onAfterLeave: (() => void) | null = null,\n    queryStringArrayFormat: 'brackets' | 'indices' = 'brackets',\n    useBrowserHistory: boolean = false,\n    onStart: (() => void) | null = null,\n    onSuccess: ((response?: AxiosResponse) => void) | null = null,\n    onError: ((...args: unknown[]) => void) | null = null,\n    props: Record<string, unknown> | null = null,\n): Promise<Modal> {\n    const modalId = generateId()\n\n    return new Promise((resolve, reject) => {\n        if (href.startsWith('#')) {\n            resolve(pushLocalModal(href.substring(1), config, onClose, onAfterLeave, props))\n            return\n        }\n\n        const [url, data] = mergeDataIntoQueryString(method as 'get' | 'post' | 'put' | 'patch' | 'delete', href || '', payload, queryStringArrayFormat)\n\n        // Check for cached prefetch response (#146)\n        const cachedResponse = getCachedResponse(url, method, data)\n        if (cachedResponse) {\n            onSuccess?.(cachedResponse)\n            pushFromResponseData(cachedResponse.data, config, onClose, onAfterLeave)\n                .then((modal) => {\n                    updateBrowserUrl(cachedResponse.data.url, useBrowserHistory, cachedResponse.data)\n                    resolve(modal)\n                })\n                .catch(reject)\n            return\n        }\n\n        if (stack.value.length === 0) {\n            baseUrl.value = typeof window !== 'undefined' ? window.location.href : ''\n        }\n\n        const requestHeaders: Record<string, string | number | boolean | null> = {\n            ...headers,\n            Accept: 'text/html, application/xhtml+xml',\n            'X-Requested-With': 'XMLHttpRequest',\n            'X-Inertia': true,\n            'X-Inertia-Version': usePage().version ?? '',\n            'X-InertiaUI-Modal': modalId,\n                        'X-InertiaUI-Modal-Base-Url': baseUrl.value,\n        }\n\n        onStart?.()\n\n        progress?.start()\n\n        Axios({ url, method, data, headers: requestHeaders })\n            .then((response) => {\n                onSuccess?.(response)\n                pushFromResponseData(response.data, config, onClose, onAfterLeave)\n                    .then((modal) => {\n                        updateBrowserUrl(response.data.url, useBrowserHistory, response.data)\n                        resolve(modal)\n                    })\n                    .catch(reject)\n            })\n            .catch((...args: unknown[]) => {\n                onError?.(...args)\n                reject(args[0])\n            })\n            .finally(() => {\n                progress?.finish()\n            })\n    })\n}\n\nfunction loadDeferredProps(modal: Modal): void {\n    const deferred = modal.response?.meta?.deferredProps\n\n    if (!deferred) {\n        return\n    }\n\n    Object.keys(deferred).forEach((key) => {\n        modal.reload({ only: deferred[key] })\n    })\n}\n\nfunction push(\n    component: Component | null,\n    response: ModalResponseData,\n    config?: ModalConfig | null,\n    onClose?: (() => void) | null,\n    afterLeave?: (() => void) | null,\n): Modal {\n    const newModal = new Modal(component, response, config, onClose, afterLeave)\n    // @ts-expect-error Vue reactivity transforms the Modal instance\n    stack.value.push(newModal)\n    loadDeferredProps(newModal)\n\n    nextTick(() => newModal.show())\n\n    return newModal\n}\n\nexport const modalPropNames = ['closeButton', 'closeExplicitly', 'closeOnClickOutside', 'maxWidth', 'paddingClasses', 'panelClasses', 'position', 'slideover']\n\nexport const renderApp = (App: Component, props: { resolveComponent?: ComponentResolver }): (() => ReturnType<typeof h>) => {\n    if (props.resolveComponent) {\n        resolveComponent = props.resolveComponent\n    }\n\n    return () => h(ModalRoot, () => h(App, props))\n}\n\nexport interface ModalStack {\n    setComponentResolver: (resolver: ComponentResolver) => void\n    getBaseUrl: () => string | null\n    setBaseUrl: (url: string | null) => void\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    stack: any\n    push: typeof push\n    pushFromResponseData: typeof pushFromResponseData\n    closeAll: (force?: boolean) => void\n    reset: () => void\n    visit: typeof visit\n    registerLocalModal: typeof registerLocalModal\n    removeLocalModal: (name: string) => boolean\n}\n\nexport function useModalStack(): ModalStack {\n    return {\n        setComponentResolver,\n        getBaseUrl: () => baseUrl.value,\n        setBaseUrl: (url: string | null) => (baseUrl.value = url),\n        stack: readonly(stack),\n        push,\n        pushFromResponseData,\n        closeAll: (force = false) => {\n            if (force) {\n                // Force close: immediately remove all modals without transition\n                stack.value = []\n            } else {\n                // Normal close: trigger leave transition for each modal\n                ;[...stack.value].reverse().forEach((modal) => modal.close())\n            }\n        },\n        reset: () => (stack.value = []),\n        visit,\n        registerLocalModal,\n        removeLocalModal: (name: string) => delete localModals.value[name],\n    }\n}\n","import { inject, toValue } from 'vue'\nimport type { Modal } from './modalStack'\n\nexport default function useModal(): Modal | null {\n    return toValue(inject<Modal | null>('modalContext', null))\n}\n","<script setup>\n// See: https://github.com/inertiajs/inertia/blob/48bcd21fb7daf467d0df1bfde2408f161f94a579/packages/vue3/src/deferred.ts\nimport { computed, inject } from 'vue'\n\nconst props = defineProps({\n    data: {\n        type: [String, Array],\n        required: true,\n    },\n})\n\nconst modalContext = inject('modalContext')\n\nif (!modalContext) {\n    throw new Error('Deferred component must be used inside a Modal component')\n}\n\nconst allKeysAreAvailable = computed(() => {\n    const keys = Array.isArray(props.data) ? props.data : [props.data]\n\n    return keys.every((key) => modalContext.value.props[key] !== undefined)\n})\n</script>\n\n<template>\n    <slot v-if=\"allKeysAreAvailable\" />\n\n    <slot\n        v-else\n        name=\"fallback\"\n    />\n</template>\n","<script setup>\nimport { getConfig, getConfigByType } from './config'\nimport { inject, onBeforeUnmount, ref, computed, useAttrs, onMounted, watch, unref } from 'vue'\nimport { useModalStack } from './modalStack'\nimport ModalRenderer from './ModalRenderer.vue'\n\nconst props = defineProps({\n    name: {\n        type: String,\n        required: false,\n    },\n    // The slideover prop in on top because we need to know if it's a slideover\n    // before we can determine the defaule value of other props\n    slideover: {\n        type: Boolean,\n        default: null,\n    },\n    closeButton: {\n        type: Boolean,\n        default: null,\n    },\n    closeExplicitly: {\n        type: Boolean,\n        default: null,\n    },\n    closeOnClickOutside: {\n        type: Boolean,\n        default: null,\n    },\n    maxWidth: {\n        type: String,\n        default: null,\n    },\n    paddingClasses: {\n        type: [Boolean, String],\n        default: null,\n    },\n    panelClasses: {\n        type: [Boolean, String],\n        default: null,\n    },\n    position: {\n        type: String,\n        default: null,\n    },\n})\n\nconst modalStack = useModalStack()\nconst modalContext = props.name ? ref({}) : inject('modalContext')\nconst config = computed(() => {\n    const isSlideover = modalContext.value.config?.slideover ?? props.slideover ?? getConfig('type') === 'slideover'\n\n    return {\n        slideover: isSlideover,\n        closeButton: props.closeButton ?? getConfigByType(isSlideover, 'closeButton'),\n        closeExplicitly: props.closeExplicitly ?? getConfigByType(isSlideover, 'closeExplicitly'),\n        closeOnClickOutside: props.closeOnClickOutside ?? getConfigByType(isSlideover, 'closeOnClickOutside'),\n        maxWidth: props.maxWidth ?? getConfigByType(isSlideover, 'maxWidth'),\n        paddingClasses: props.paddingClasses ?? getConfigByType(isSlideover, 'paddingClasses'),\n        panelClasses: props.panelClasses ?? getConfigByType(isSlideover, 'panelClasses'),\n        position: props.position ?? getConfigByType(isSlideover, 'position'),\n        ...modalContext.value.config,\n    }\n})\n\n// Local Modals...\nif (props.name) {\n    modalStack.registerLocalModal(props.name, function (context) {\n        modalContext.value = context\n        registerEventListeners()\n    })\n\n    onBeforeUnmount(() => {\n        modalStack.removeLocalModal(props.name)\n    })\n}\n\nonMounted(() => {\n    if (!props.name) {\n        registerEventListeners()\n    }\n})\n\nconst unsubscribeEventListeners = ref(null)\nonBeforeUnmount(() => unsubscribeEventListeners.value?.())\n\nconst $attrs = useAttrs()\n\nfunction registerEventListeners() {\n    unsubscribeEventListeners.value = modalContext.value.registerEventListenersFromAttrs($attrs)\n}\n\nconst emits = defineEmits(['modal-event', 'focus', 'blur', 'close', 'success'])\n\nfunction emit(event, ...args) {\n    emits('modal-event', event, ...args)\n}\n\ndefineExpose({\n    emit,\n    afterLeave: () => modalContext.value?.afterLeave(),\n    close: () => modalContext.value?.close(),\n    reload: (...args) => modalContext.value?.reload(...args),\n    setOpen: (...args) => modalContext.value?.setOpen(...args),\n    getChildModal: () => modalContext.value?.getChildModal(),\n    getParentModal: () => modalContext.value?.getParentModal(),\n\n    get config() {\n        return modalContext.value?.config\n    },\n    get id() {\n        return modalContext.value?.id\n    },\n    get index() {\n        return modalContext.value?.index\n    },\n    get isOpen() {\n        return modalContext.value?.isOpen\n    },\n    get modalContext() {\n        return modalContext.value?.modalContext\n    },\n    get onTopOfStack() {\n        return modalContext.value?.onTopOfStack\n    },\n    get shouldRender() {\n        return modalContext.value?.shouldRender\n    },\n})\n\nwatch(\n    () => modalContext.value?.onTopOfStack,\n    (onTopOfStack, previousOnTopOfStack) => {\n        if (onTopOfStack && !previousOnTopOfStack) {\n            emits('focus')\n        } else if (!onTopOfStack && previousOnTopOfStack) {\n            emits('blur')\n        }\n    },\n)\n\nwatch(\n    () => modalContext.value?.isOpen,\n    (isOpen, previousIsOpen) => {\n        if (isOpen) {\n            emits('success')\n        } else if (previousIsOpen === true) {\n            // Only emit 'close' when transitioning from open to closed,\n            // not when the component first mounts with isOpen undefined\n            emits('close')\n        }\n    },\n    { immediate: true },\n)\n\nconst nextIndex = computed(() => {\n    return modalStack.stack.value.find((m) => m.shouldRender && m.index > modalContext.value.index)?.index\n})\n\n// Computed to unwrap the modal's props ref for slot binding (#152)\nconst modalProps = computed(() => {\n    const ctx = modalContext.value\n    if (!ctx) return {}\n    // The Modal class stores props as a ref, so we need to unref it\n    return unref(ctx.props) ?? {}\n})\n\ndefineOptions({\n    inheritAttrs: false,\n})\n</script>\n\n<template>\n    <slot\n        v-if=\"modalContext.shouldRender\"\n        v-bind=\"modalProps\"\n        :id=\"modalContext.id\"\n        :after-leave=\"modalContext.afterLeave\"\n        :close=\"modalContext.close\"\n        :config=\"config\"\n        :emit=\"emit\"\n        :get-child-modal=\"modalContext.getChildModal\"\n        :get-parent-modal=\"modalContext.getParentModal\"\n        :index=\"modalContext.index\"\n        :is-open=\"modalContext.isOpen\"\n        :modal-context=\"modalContext\"\n        :on-top-of-stack=\"modalContext.onTopOfStack\"\n        :reload=\"modalContext.reload\"\n        :set-open=\"modalContext.setOpen\"\n        :should-render=\"modalContext.shouldRender\"\n    />\n\n    <!-- The next modal in the stack -->\n    <ModalRenderer\n        v-if=\"nextIndex\"\n        :index=\"nextIndex\"\n    />\n</template>\n","<script setup>\nimport useModal from './useModal'\n\nconst modal = useModal()\n</script>\n\n<template>\n    <button\n        type=\"button\"\n        class=\"im-close-button text-gray-400 hover:text-gray-500\"\n        @click=\"modal.close()\"\n    >\n        <span class=\"sr-only\">Close</span>\n        <svg\n            class=\"size-6\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            fill=\"none\"\n            viewBox=\"0 0 24 24\"\n            stroke-width=\"2\"\n            stroke=\"currentColor\"\n            aria-hidden=\"true\"\n        >\n            <path\n                stroke-linecap=\"round\"\n                stroke-linejoin=\"round\"\n                d=\"M6 18L18 6M6 6l12 12\"\n            ></path>\n        </svg>\n    </button>\n</template>\n","/**\n * Max width classes for modals and slideovers.\n * Uses a map lookup for Tailwind 4 compatibility (scanner picks up full class strings).\n */\nexport const maxWidthClasses: Record<string, string> = {\n    sm: 'sm:max-w-sm',\n    md: 'sm:max-w-md',\n    lg: 'sm:max-w-md md:max-w-lg',\n    xl: 'sm:max-w-md md:max-w-xl',\n    '2xl': 'sm:max-w-md md:max-w-xl lg:max-w-2xl',\n    '3xl': 'sm:max-w-md md:max-w-xl lg:max-w-3xl',\n    '4xl': 'sm:max-w-md md:max-w-xl lg:max-w-3xl xl:max-w-4xl',\n    '5xl': 'sm:max-w-md md:max-w-xl lg:max-w-3xl xl:max-w-5xl',\n    '6xl': 'sm:max-w-md md:max-w-xl lg:max-w-3xl xl:max-w-5xl 2xl:max-w-6xl',\n    '7xl': 'sm:max-w-md md:max-w-xl lg:max-w-3xl xl:max-w-5xl 2xl:max-w-7xl',\n}\n\nexport const defaultMaxWidth = '2xl'\n\nexport function getMaxWidthClass(maxWidth: string): string {\n    return maxWidthClasses[maxWidth] || maxWidthClasses[defaultMaxWidth]\n}\n","<script setup>\nimport { ref, onMounted, onUnmounted, watch, nextTick, computed } from 'vue'\nimport CloseButton from './CloseButton.vue'\nimport { createFocusTrap, onEscapeKey } from './dialog'\nimport { getMaxWidthClass } from './constants'\n\nconst props = defineProps({\n    modalContext: Object,\n    config: Object,\n    useNativeDialog: Boolean,\n    isFirstModal: Boolean,\n})\n\nconst emit = defineEmits(['after-leave'])\n\nconst entered = ref(false)\nconst isLeaving = ref(false)\nconst wrapperRef = ref(null)\nconst dialogRef = ref(null)\n\nlet cleanupFocusTrap = null\nlet cleanupEscapeKey = null\n\nconst maxWidthClass = computed(() => getMaxWidthClass(props.config.maxWidth))\n\n// ============ Non-native dialog handlers ============\n\nfunction setupFocusTrap() {\n    if (props.useNativeDialog) return\n    if (!wrapperRef.value || !props.modalContext.onTopOfStack) return\n    if (cleanupFocusTrap) return\n\n    cleanupFocusTrap = createFocusTrap(wrapperRef.value, {\n        initialFocus: true,\n        returnFocus: false,\n    })\n}\n\nfunction cleanupFocusTrap_() {\n    if (cleanupFocusTrap) {\n        cleanupFocusTrap()\n        cleanupFocusTrap = null\n    }\n}\n\nfunction setupEscapeKey() {\n    if (props.useNativeDialog) return\n    if (cleanupEscapeKey) return\n    if (props.config?.closeExplicitly) return\n\n    cleanupEscapeKey = onEscapeKey(() => {\n        if (props.modalContext.onTopOfStack) {\n            props.modalContext.close()\n        }\n    })\n}\n\nfunction cleanupEscapeKey_() {\n    if (cleanupEscapeKey) {\n        cleanupEscapeKey()\n        cleanupEscapeKey = null\n    }\n}\n\nfunction handleClickOutside(event) {\n    if (props.useNativeDialog) return\n    if (!props.modalContext.onTopOfStack) return\n    if (props.config?.closeExplicitly) return\n    if (props.config?.closeOnClickOutside === false) return\n    if (!wrapperRef.value) return\n\n    if (!wrapperRef.value.contains(event.target)) {\n        props.modalContext.close()\n    }\n}\n\nfunction onAfterEnter() {\n    entered.value = true\n    setupFocusTrap()\n}\n\nfunction onAfterLeave() {\n    emit('after-leave')\n    props.modalContext.afterLeave()\n}\n\n// ============ Native dialog handlers ============\n\nfunction handleCancel(event) {\n    event.preventDefault()\n    if (props.modalContext.onTopOfStack && !props.config?.closeExplicitly) {\n        props.modalContext.close()\n    }\n}\n\nfunction handleDialogClick(event) {\n    if (event.target === dialogRef.value) {\n        if (props.modalContext.onTopOfStack && !props.config?.closeExplicitly && props.config?.closeOnClickOutside !== false) {\n            props.modalContext.close()\n        }\n    }\n}\n\nfunction openDialog() {\n    if (dialogRef.value && !dialogRef.value.open) {\n        dialogRef.value.showModal()\n        nextTick(() => {\n            requestAnimationFrame(() => {\n                entered.value = true\n            })\n        })\n    }\n}\n\nfunction closeDialog() {\n    if (dialogRef.value && dialogRef.value.open) {\n        isLeaving.value = true\n        entered.value = false\n        setTimeout(() => {\n            if (dialogRef.value) {\n                dialogRef.value.close()\n            }\n            isLeaving.value = false\n            emit('after-leave')\n            props.modalContext.afterLeave()\n        }, 300)\n    }\n}\n\n// ============ Lifecycle ============\n\nonMounted(() => {\n    if (props.useNativeDialog) {\n        if (props.modalContext.isOpen) {\n            openDialog()\n        }\n    } else {\n        setupEscapeKey()\n    }\n})\n\nonUnmounted(() => {\n    if (props.useNativeDialog) {\n        if (dialogRef.value?.open) {\n            dialogRef.value.close()\n        }\n    } else {\n        cleanupFocusTrap_()\n        cleanupEscapeKey_()\n    }\n})\n\nwatch(\n    () => props.modalContext.onTopOfStack,\n    (onTop) => {\n        if (props.useNativeDialog) return\n\n        if (onTop) {\n            setupEscapeKey()\n            if (entered.value) {\n                setupFocusTrap()\n            }\n        } else {\n            cleanupFocusTrap_()\n            cleanupEscapeKey_()\n        }\n    },\n)\n\nwatch(\n    () => props.modalContext.isOpen,\n    (isOpen) => {\n        if (!props.useNativeDialog) return\n\n        if (isOpen) {\n            openDialog()\n        } else if (!isLeaving.value) {\n            closeDialog()\n        }\n    },\n)\n</script>\n\n<template>\n    <!-- Native dialog mode -->\n    <dialog\n        v-if=\"useNativeDialog\"\n        ref=\"dialogRef\"\n        :class=\"[\n            'im-modal-dialog m-0 overflow-visible bg-transparent p-0',\n            'size-full max-h-none max-w-none',\n            'backdrop:bg-black/75 backdrop:transition-opacity backdrop:duration-300',\n            entered ? 'backdrop:opacity-100' : 'backdrop:opacity-0',\n            !isFirstModal && 'backdrop:bg-transparent',\n        ]\"\n        @cancel=\"handleCancel\"\n        @click=\"handleDialogClick\"\n    >\n        <div class=\"im-modal-container fixed inset-0 overflow-y-auto p-4\">\n            <div\n                class=\"im-modal-positioner flex min-h-full justify-center\"\n                :class=\"{\n                    'items-start': config.position === 'top',\n                    'items-center': config.position === 'center',\n                    'items-end': config.position === 'bottom',\n                }\"\n            >\n                <div\n                    :class=\"[\n                        'im-modal-wrapper w-full transition duration-300 ease-in-out',\n                        modalContext.onTopOfStack ? '' : 'blur-xs',\n                        entered && !isLeaving ? 'translate-y-0 opacity-100 sm:scale-100' : 'translate-y-4 opacity-0 sm:translate-y-0 sm:scale-95',\n                        maxWidthClass,\n                    ]\"\n                >\n                    <div\n                        class=\"im-modal-content relative\"\n                        :data-inertiaui-modal-entered=\"entered\"\n                        :class=\"[config.paddingClasses, config.panelClasses]\"\n                    >\n                        <div\n                            v-if=\"config.closeButton\"\n                            class=\"absolute right-0 top-0 pr-3 pt-3\"\n                        >\n                            <CloseButton />\n                        </div>\n\n                        <slot\n                            :modal-context=\"modalContext\"\n                            :config=\"config\"\n                        />\n                    </div>\n                </div>\n            </div>\n        </div>\n    </dialog>\n\n    <!-- Non-native dialog mode -->\n    <div\n        v-else\n        class=\"im-modal-container fixed inset-0 z-40 overflow-y-auto p-4\"\n        @mousedown.self=\"handleClickOutside\"\n    >\n        <div\n            class=\"im-modal-positioner flex min-h-full justify-center\"\n            :class=\"{\n                'items-start': config.position === 'top',\n                'items-center': config.position === 'center',\n                'items-end': config.position === 'bottom',\n            }\"\n            @mousedown.self=\"handleClickOutside\"\n        >\n            <Transition\n                appear\n                enter-active-class=\"transition duration-300 ease-in-out\"\n                enter-from-class=\"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95\"\n                enter-to-class=\"opacity-100 translate-y-0 sm:scale-100\"\n                leave-active-class=\"transition duration-300 ease-in-out\"\n                leave-from-class=\"opacity-100 translate-y-0 sm:scale-100\"\n                leave-to-class=\"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95\"\n                @after-enter=\"onAfterEnter\"\n                @after-leave=\"onAfterLeave\"\n            >\n                <div\n                    v-if=\"modalContext.isOpen\"\n                    ref=\"wrapperRef\"\n                    role=\"dialog\"\n                    aria-modal=\"true\"\n                    :class=\"['im-modal-wrapper w-full', modalContext.onTopOfStack ? '' : 'blur-xs', maxWidthClass]\"\n                >\n                    <span class=\"sr-only\">Dialog</span>\n\n                    <div\n                        class=\"im-modal-content relative\"\n                        :data-inertiaui-modal-entered=\"entered\"\n                        :class=\"[config.paddingClasses, config.panelClasses]\"\n                    >\n                        <div\n                            v-if=\"config.closeButton\"\n                            class=\"absolute right-0 top-0 pr-3 pt-3\"\n                        >\n                            <CloseButton />\n                        </div>\n\n                        <slot\n                            :modal-context=\"modalContext\"\n                            :config=\"config\"\n                        />\n                    </div>\n                </div>\n            </Transition>\n        </div>\n    </div>\n</template>\n","<script setup>\nimport { ref, onMounted, onUnmounted, watch, nextTick, computed } from 'vue'\nimport CloseButton from './CloseButton.vue'\nimport { createFocusTrap, onEscapeKey } from './dialog'\nimport { getMaxWidthClass } from './constants'\n\nconst props = defineProps({\n    modalContext: Object,\n    config: Object,\n    useNativeDialog: Boolean,\n    isFirstModal: Boolean,\n})\n\nconst emit = defineEmits(['after-leave'])\n\nconst entered = ref(false)\nconst isLeaving = ref(false)\nconst wrapperRef = ref(null)\nconst dialogRef = ref(null)\n\nlet cleanupFocusTrap = null\nlet cleanupEscapeKey = null\n\nconst maxWidthClass = computed(() => getMaxWidthClass(props.config.maxWidth))\n\n// Transform classes for slideover animation\nconst transformEnterFrom = computed(() => (props.config.position === 'left' ? '-translate-x-full' : 'translate-x-full'))\n\n// ============ Non-native dialog handlers ============\n\nfunction setupFocusTrap() {\n    if (props.useNativeDialog) return\n    if (!wrapperRef.value || !props.modalContext.onTopOfStack) return\n    if (cleanupFocusTrap) return\n\n    cleanupFocusTrap = createFocusTrap(wrapperRef.value, {\n        initialFocus: true,\n        returnFocus: false,\n    })\n}\n\nfunction cleanupFocusTrap_() {\n    if (cleanupFocusTrap) {\n        cleanupFocusTrap()\n        cleanupFocusTrap = null\n    }\n}\n\nfunction setupEscapeKey() {\n    if (props.useNativeDialog) return\n    if (cleanupEscapeKey) return\n    if (props.config?.closeExplicitly) return\n\n    cleanupEscapeKey = onEscapeKey(() => {\n        if (props.modalContext.onTopOfStack) {\n            props.modalContext.close()\n        }\n    })\n}\n\nfunction cleanupEscapeKey_() {\n    if (cleanupEscapeKey) {\n        cleanupEscapeKey()\n        cleanupEscapeKey = null\n    }\n}\n\nfunction handleClickOutside(event) {\n    if (props.useNativeDialog) return\n    if (!props.modalContext.onTopOfStack) return\n    if (props.config?.closeExplicitly) return\n    if (props.config?.closeOnClickOutside === false) return\n    if (!wrapperRef.value) return\n\n    if (!wrapperRef.value.contains(event.target)) {\n        props.modalContext.close()\n    }\n}\n\nfunction onAfterEnter() {\n    entered.value = true\n    setupFocusTrap()\n}\n\nfunction onAfterLeave() {\n    emit('after-leave')\n    props.modalContext.afterLeave()\n}\n\n// ============ Native dialog handlers ============\n\nfunction handleCancel(event) {\n    event.preventDefault()\n    if (props.modalContext.onTopOfStack && !props.config?.closeExplicitly) {\n        props.modalContext.close()\n    }\n}\n\nfunction handleDialogClick(event) {\n    if (event.target === dialogRef.value) {\n        if (props.modalContext.onTopOfStack && !props.config?.closeExplicitly && props.config?.closeOnClickOutside !== false) {\n            props.modalContext.close()\n        }\n    }\n}\n\nfunction openDialog() {\n    if (dialogRef.value && !dialogRef.value.open) {\n        dialogRef.value.showModal()\n        nextTick(() => {\n            requestAnimationFrame(() => {\n                entered.value = true\n            })\n        })\n    }\n}\n\nfunction closeDialog() {\n    if (dialogRef.value && dialogRef.value.open) {\n        isLeaving.value = true\n        entered.value = false\n        setTimeout(() => {\n            if (dialogRef.value) {\n                dialogRef.value.close()\n            }\n            isLeaving.value = false\n            emit('after-leave')\n            props.modalContext.afterLeave()\n        }, 300)\n    }\n}\n\n// ============ Lifecycle ============\n\nonMounted(() => {\n    if (props.useNativeDialog) {\n        if (props.modalContext.isOpen) {\n            openDialog()\n        }\n    } else {\n        setupEscapeKey()\n    }\n})\n\nonUnmounted(() => {\n    if (props.useNativeDialog) {\n        if (dialogRef.value?.open) {\n            dialogRef.value.close()\n        }\n    } else {\n        cleanupFocusTrap_()\n        cleanupEscapeKey_()\n    }\n})\n\nwatch(\n    () => props.modalContext.onTopOfStack,\n    (onTop) => {\n        if (props.useNativeDialog) return\n\n        if (onTop) {\n            setupEscapeKey()\n            if (entered.value) {\n                setupFocusTrap()\n            }\n        } else {\n            cleanupFocusTrap_()\n            cleanupEscapeKey_()\n        }\n    },\n)\n\nwatch(\n    () => props.modalContext.isOpen,\n    (isOpen) => {\n        if (!props.useNativeDialog) return\n\n        if (isOpen) {\n            openDialog()\n        } else if (!isLeaving.value) {\n            closeDialog()\n        }\n    },\n)\n</script>\n\n<template>\n    <!-- Native dialog mode -->\n    <dialog\n        v-if=\"useNativeDialog\"\n        ref=\"dialogRef\"\n        :class=\"[\n            'im-slideover-dialog m-0 overflow-visible bg-transparent p-0',\n            'size-full max-h-none max-w-none',\n            'backdrop:bg-black/75 backdrop:transition-opacity backdrop:duration-300',\n            entered ? 'backdrop:opacity-100' : 'backdrop:opacity-0',\n            !isFirstModal && 'backdrop:bg-transparent',\n        ]\"\n        @cancel=\"handleCancel\"\n        @click=\"handleDialogClick\"\n    >\n        <div class=\"im-slideover-container fixed inset-0 overflow-y-auto overflow-x-hidden\">\n            <div\n                class=\"im-slideover-positioner flex min-h-full items-center\"\n                :class=\"{\n                    'justify-start rtl:justify-end': config.position === 'left',\n                    'justify-end rtl:justify-start': config.position === 'right',\n                }\"\n            >\n                <div\n                    :class=\"[\n                        'im-slideover-wrapper w-full transition duration-300 ease-in-out',\n                        modalContext.onTopOfStack ? '' : 'blur-xs',\n                        entered && !isLeaving\n                            ? 'translate-x-0 opacity-100'\n                            : config.position === 'left'\n                              ? '-translate-x-full opacity-0'\n                              : 'translate-x-full opacity-0',\n                        maxWidthClass,\n                    ]\"\n                >\n                    <div\n                        class=\"im-slideover-content relative\"\n                        :data-inertiaui-modal-entered=\"entered\"\n                        :class=\"[config.paddingClasses, config.panelClasses]\"\n                    >\n                        <div\n                            v-if=\"config.closeButton\"\n                            class=\"absolute right-0 top-0 pr-3 pt-3\"\n                        >\n                            <CloseButton />\n                        </div>\n\n                        <slot\n                            :modal-context=\"modalContext\"\n                            :config=\"config\"\n                        />\n                    </div>\n                </div>\n            </div>\n        </div>\n    </dialog>\n\n    <!-- Non-native dialog mode -->\n    <div\n        v-else\n        class=\"im-slideover-container fixed inset-0 z-40 overflow-y-auto overflow-x-hidden\"\n        @mousedown.self=\"handleClickOutside\"\n    >\n        <div\n            class=\"im-slideover-positioner flex min-h-full items-center\"\n            :class=\"{\n                'justify-start rtl:justify-end': config.position === 'left',\n                'justify-end rtl:justify-start': config.position === 'right',\n            }\"\n            @mousedown.self=\"handleClickOutside\"\n        >\n            <Transition\n                appear\n                enter-active-class=\"transition duration-300 ease-in-out\"\n                :enter-from-class=\"'opacity-0 ' + transformEnterFrom\"\n                enter-to-class=\"opacity-100 translate-x-0\"\n                leave-active-class=\"transition duration-300 ease-in-out\"\n                leave-from-class=\"opacity-100 translate-x-0\"\n                :leave-to-class=\"'opacity-0 ' + transformEnterFrom\"\n                @after-enter=\"onAfterEnter\"\n                @after-leave=\"onAfterLeave\"\n            >\n                <div\n                    v-if=\"modalContext.isOpen\"\n                    ref=\"wrapperRef\"\n                    role=\"dialog\"\n                    aria-modal=\"true\"\n                    :class=\"['im-slideover-wrapper w-full', modalContext.onTopOfStack ? '' : 'blur-xs', maxWidthClass]\"\n                >\n                    <span class=\"sr-only\">Dialog</span>\n\n                    <div\n                        class=\"im-slideover-content relative\"\n                        :data-inertiaui-modal-entered=\"entered\"\n                        :class=\"[config.paddingClasses, config.panelClasses]\"\n                    >\n                        <div\n                            v-if=\"config.closeButton\"\n                            class=\"absolute right-0 top-0 pr-3 pt-3\"\n                        >\n                            <CloseButton />\n                        </div>\n\n                        <slot\n                            :modal-context=\"modalContext\"\n                            :config=\"config\"\n                        />\n                    </div>\n                </div>\n            </Transition>\n        </div>\n    </div>\n</template>\n","<script setup>\nimport ModalContent from './ModalContent.vue'\nimport HeadlessModal from './HeadlessModal.vue'\nimport SlideoverContent from './SlideoverContent.vue'\nimport { onMounted, onUnmounted, ref, computed } from 'vue'\nimport { lockScroll, markAriaHidden } from './dialog'\nimport { getConfig } from './config'\n\nconst modal = ref(null)\nconst rendered = ref(false)\n\nconst emits = defineEmits(['after-leave', 'blur', 'close', 'focus', 'success'])\n\ndefineExpose({\n    afterLeave: () => modal.value?.afterLeave(),\n    close: () => modal.value?.close(),\n    emit: (...args) => modal.value?.emit(...args),\n    getChildModal: () => modal.value?.getChildModal(),\n    getParentModal: () => modal.value?.getParentModal(),\n    reload: (...args) => modal.value?.reload(...args),\n    setOpen: (...args) => modal.value?.setOpen(...args),\n\n    get config() {\n        return modal.value?.config\n    },\n    get id() {\n        return modal.value?.id\n    },\n    get index() {\n        return modal.value?.index\n    },\n    get isOpen() {\n        return modal.value?.isOpen\n    },\n    get modalContext() {\n        return modal.value?.modalContext\n    },\n    get onTopOfStack() {\n        return modal.value?.onTopOfStack\n    },\n    get shouldRender() {\n        return modal.value?.shouldRender\n    },\n})\n\n// Cleanup functions for scroll lock and aria-hidden\nlet cleanupScrollLock = null\nlet cleanupAriaHidden = null\n\nonMounted(() => {\n    // Initial setup if modal is already open\n    // Only call lockScroll if not already set (onSuccessEvent may have already called it)\n    if (modal.value?.isOpen && !cleanupScrollLock) {\n        cleanupScrollLock = lockScroll()\n        cleanupAriaHidden = markAriaHidden('#app')\n    }\n})\n\nonUnmounted(() => {\n    cleanupScrollLock?.()\n    cleanupAriaHidden?.()\n})\n\n// Handle open state changes\nfunction onSuccessEvent() {\n    emits('success')\n    if (!cleanupScrollLock) {\n        cleanupScrollLock = lockScroll()\n        cleanupAriaHidden = markAriaHidden('#app')\n    }\n}\n\nfunction onCloseEvent() {\n    emits('close')\n    cleanupScrollLock?.()\n    cleanupAriaHidden?.()\n    cleanupScrollLock = null\n    cleanupAriaHidden = null\n}\n\nconst useNativeDialog = computed(() => getConfig('useNativeDialog'))\n</script>\n\n<template>\n    <HeadlessModal\n        ref=\"modal\"\n        v-slot=\"{\n            afterLeave,\n            close,\n            config,\n            emit,\n            getChildModal,\n            getParentModal,\n            id,\n            index,\n            isOpen,\n            modalContext,\n            onTopOfStack,\n            reload,\n            setOpen,\n            shouldRender,\n            ...props\n        }\"\n        @success=\"onSuccessEvent\"\n        @close=\"onCloseEvent\"\n        @focus=\"emits('focus')\"\n        @blur=\"emits('blur')\"\n    >\n        <Teleport to=\"body\">\n            <div\n                :data-inertiaui-modal-id=\"id\"\n                :data-inertiaui-modal-index=\"index\"\n                class=\"im-dialog relative z-20\"\n                :aria-hidden=\"!onTopOfStack\"\n            >\n                <!-- Only render backdrop for the first modal (non-native dialog mode) -->\n                <!-- Native dialog uses ::backdrop pseudo-element instead -->\n                <Transition\n                    v-if=\"index === 0 && !useNativeDialog\"\n                    :appear=\"!rendered\"\n                    enter-active-class=\"transition transform ease-in-out duration-300\"\n                    enter-from-class=\"opacity-0\"\n                    enter-to-class=\"opacity-100\"\n                    leave-active-class=\"transition transform ease-in-out duration-300\"\n                    leave-from-class=\"opacity-100\"\n                    leave-to-class=\"opacity-0\"\n                    @after-appear=\"rendered = true\"\n                >\n                    <div\n                        v-if=\"isOpen\"\n                        class=\"im-backdrop fixed inset-0 z-30 bg-black/75\"\n                    />\n                </Transition>\n\n                <!-- The modal/slideover content itself -->\n                <component\n                    :is=\"config?.slideover ? SlideoverContent : ModalContent\"\n                    :modal-context=\"modalContext\"\n                    :config=\"config\"\n                    :use-native-dialog=\"useNativeDialog\"\n                    :is-first-modal=\"index === 0\"\n                    @after-leave=\"$emit('after-leave')\"\n                >\n                    <slot\n                        v-bind=\"props\"\n                        :id=\"id\"\n                        :after-leave=\"afterLeave\"\n                        :close=\"close\"\n                        :config=\"config\"\n                        :emit=\"emit\"\n                        :get-child-modal=\"getChildModal\"\n                        :get-parent-modal=\"getParentModal\"\n                        :index=\"index\"\n                        :is-open=\"isOpen\"\n                        :modal-context=\"modalContext\"\n                        :on-top-of-stack=\"onTopOfStack\"\n                        :reload=\"reload\"\n                        :set-open=\"setOpen\"\n                        :should-render=\"shouldRender\"\n                    />\n                </component>\n            </div>\n        </Teleport>\n    </HeadlessModal>\n</template>\n","<script setup>\nimport { modalPropNames, useModalStack, prefetch as prefetchModal } from './modalStack'\nimport { ref, provide, computed, watch, useAttrs, onBeforeUnmount, onMounted } from 'vue'\nimport { only, rejectNullValues } from './helpers'\nimport { getConfig } from './config'\n\nconst props = defineProps({\n    href: {\n        type: String,\n        required: true,\n    },\n    method: {\n        type: String,\n        default: 'get',\n    },\n    data: {\n        type: Object,\n        default: () => ({}),\n    },\n    as: {\n        type: [String, Object],\n        default: 'a',\n    },\n    headers: {\n        type: Object,\n        default: () => ({}),\n    },\n    queryStringArrayFormat: {\n        type: String,\n        default: 'brackets',\n    },\n    navigate: {\n        type: Boolean,\n        default: null,\n    },\n    // Prefetch options (#146)\n    prefetch: {\n        type: [Boolean, String, Array],\n        default: false,\n    },\n    cacheFor: {\n        type: Number,\n        default: 30000,\n    },\n    // Passthrough to Modal.vue\n    closeButton: {\n        type: Boolean,\n        required: false,\n        default: null,\n    },\n    closeExplicitly: {\n        type: Boolean,\n        required: false,\n        default: null,\n    },\n    closeOnClickOutside: {\n        type: Boolean,\n        required: false,\n        default: null,\n    },\n    maxWidth: {\n        type: String,\n        required: false,\n        default: null,\n    },\n    paddingClasses: {\n        type: [Boolean, String],\n        required: false,\n        default: null,\n    },\n    panelClasses: {\n        type: [Boolean, String],\n        required: false,\n        default: null,\n    },\n    position: {\n        type: String,\n        required: false,\n        default: null,\n    },\n    slideover: {\n        type: Boolean,\n        required: false,\n        default: null,\n    },\n})\n\nconst loading = ref(false)\nconst modalStack = useModalStack()\nconst modalContext = ref(null)\n\nprovide('modalContext', modalContext)\n\nconst emit = defineEmits(['after-leave', 'blur', 'close', 'error', 'focus', 'start', 'success', 'prefetching', 'prefetched'])\nconst isBlurred = ref(false)\n\nconst shouldNavigate = computed(() => {\n    return props.navigate ?? getConfig('navigate')\n})\n\n// Prefetch logic (#146)\nconst hoverTimeout = ref(null)\n\nconst prefetchModes = computed(() => {\n    if (props.prefetch === true) {\n        return ['hover']\n    }\n    if (props.prefetch === false) {\n        return []\n    }\n    if (Array.isArray(props.prefetch)) {\n        return props.prefetch\n    }\n    return [props.prefetch]\n})\n\nfunction doPrefetch() {\n    prefetchModal(props.href, {\n        method: props.method,\n        data: props.data,\n        headers: props.headers,\n        queryStringArrayFormat: props.queryStringArrayFormat,\n        cacheFor: props.cacheFor,\n        onPrefetching: () => emit('prefetching'),\n        onPrefetched: () => emit('prefetched'),\n    })\n}\n\nfunction onMouseenter() {\n    if (!prefetchModes.value.includes('hover')) return\n\n    hoverTimeout.value = setTimeout(() => {\n        doPrefetch()\n    }, 75) // Small delay to avoid prefetching on accidental hovers\n}\n\nfunction onMouseleave() {\n    if (hoverTimeout.value) {\n        clearTimeout(hoverTimeout.value)\n        hoverTimeout.value = null\n    }\n}\n\nfunction onMousedown(event) {\n    if (!prefetchModes.value.includes('click')) return\n    if (event.button !== 0) return // Only left click\n\n    doPrefetch()\n}\n\nonMounted(() => {\n    if (prefetchModes.value.includes('mount')) {\n        doPrefetch()\n    }\n})\n\nwatch(\n    () => modalContext.value?.onTopOfStack,\n    (onTopOfStack) => {\n        if (modalContext.value) {\n            if (onTopOfStack && isBlurred.value) {\n                emit('focus')\n            } else if (!onTopOfStack) {\n                emit('blur')\n            }\n\n            isBlurred.value = !onTopOfStack\n        }\n    },\n)\n\nconst unsubscribeEventListeners = ref(null)\n\nonBeforeUnmount(() => {\n    unsubscribeEventListeners.value?.()\n    if (hoverTimeout.value) {\n        clearTimeout(hoverTimeout.value)\n    }\n})\n\nconst $attrs = useAttrs()\n\nfunction registerEventListeners() {\n    unsubscribeEventListeners.value = modalContext.value.registerEventListenersFromAttrs($attrs)\n}\n\nwatch(modalContext, (value, oldValue) => {\n    if (value && !oldValue) {\n        registerEventListeners()\n        emit('success')\n    }\n})\n\nfunction onClose() {\n    emit('close')\n}\n\nfunction onAfterLeave() {\n    modalContext.value = null\n    emit('after-leave')\n}\n\nfunction handle() {\n    if (loading.value) {\n        return\n    }\n\n    if (!props.href.startsWith('#')) {\n        loading.value = true\n        emit('start')\n    }\n\n    modalStack\n        .visit(\n            props.href,\n            props.method,\n            props.data,\n            props.headers,\n            rejectNullValues(only(props, modalPropNames)),\n            onClose,\n            onAfterLeave,\n            props.queryStringArrayFormat,\n            shouldNavigate.value,\n        )\n        .then((context) => {\n            modalContext.value = context\n        })\n        .catch((error) => emit('error', error))\n        .finally(() => (loading.value = false))\n}\n</script>\n\n<template>\n    <component\n        v-bind=\"$attrs\"\n        :is=\"as\"\n        :href=\"href\"\n        @click.prevent=\"handle\"\n        @mouseenter=\"onMouseenter\"\n        @mouseleave=\"onMouseleave\"\n        @mousedown=\"onMousedown\"\n    >\n        <slot :loading=\"loading\" />\n    </component>\n</template>\n","<script setup>\n// See: https://github.com/inertiajs/inertia/blob/48bcd21fb7daf467d0df1bfde2408f161f94a579/packages/vue3/src/whenVisible.ts\nimport { ref, onMounted, onUnmounted, inject } from 'vue'\n\nconst props = defineProps({\n    data: [String, Array],\n    params: Object,\n    buffer: { type: Number, default: 0 },\n    as: { type: String, default: 'div' },\n    always: { type: Boolean, default: false },\n})\n\nconst modalContext = inject('modalContext')\n\nif (!modalContext) {\n    throw new Error('Deferred component must be used inside a Modal component')\n}\n\nconst loaded = ref(false)\nconst fetching = ref(false)\nconst rootElement = ref(null)\nlet observer = null\n\nconst getReloadParams = () => {\n    if (props.data) {\n        return { only: Array.isArray(props.data) ? props.data : [props.data] }\n    }\n\n    if (!props.params) {\n        throw new Error('You must provide either a `data` or `params` prop.')\n    }\n\n    return props.params\n}\n\nconst observeElement = () => {\n    if (!rootElement.value) {\n        return\n    }\n\n    observer = new IntersectionObserver(\n        (entries) => {\n            if (!entries[0].isIntersecting) {\n                return\n            }\n\n            if (!props.always) {\n                observer.disconnect()\n            }\n\n            if (fetching.value) {\n                return\n            }\n\n            fetching.value = true\n            const reloadParams = getReloadParams()\n\n            modalContext.value.reload({\n                ...reloadParams,\n                onStart: () => {\n                    fetching.value = true\n                    reloadParams.onStart?.()\n                },\n                onFinish: () => {\n                    loaded.value = true\n                    fetching.value = false\n                    reloadParams.onFinish?.()\n                },\n            })\n        },\n        { rootMargin: `${props.buffer}px` },\n    )\n\n    observer.observe(rootElement.value)\n}\n\nonMounted(observeElement)\nonUnmounted(() => observer?.disconnect())\n</script>\n\n<template>\n    <component\n        :is=\"props.as\"\n        ref=\"rootElement\"\n    >\n        <slot v-if=\"loaded\"></slot>\n        <slot\n            v-else\n            name=\"fallback\"\n        ></slot>\n    </component>\n</template>\n","import { getConfig, putConfig, resetConfig } from './config'\nimport { useModalStack, initFromPageProps, renderApp, Modal as ModalClass, modalPropNames, prefetch } from './modalStack'\nimport type { ModalStack, ModalResponseData, ModalConfig, ReloadOptions, VisitOptions, PrefetchOption, PrefetchOptions } from './modalStack'\nimport useModal from './useModal'\nimport Deferred from './Deferred.vue'\nimport HeadlessModal from './HeadlessModal.vue'\nimport ModalComponent from './Modal.vue'\nimport ModalLink from './ModalLink.vue'\nimport ModalRoot from './ModalRoot.vue'\nimport WhenVisible from './WhenVisible.vue'\nimport * as dialogUtils from './dialog'\nimport { kebabCase } from './helpers'\n\nfunction visitModal(url: string, options: VisitOptions = {}): Promise<ModalClass> {\n    return useModalStack()\n        .visit(\n            url,\n            options.method ?? 'get',\n            options.data ?? {},\n            options.headers ?? {},\n            options.config ?? {},\n            options.onClose,\n            options.onAfterLeave,\n            options.queryStringArrayFormat ?? 'brackets',\n            options.navigate ?? (getConfig('navigate') as boolean),\n            options.onStart,\n            options.onSuccess,\n            options.onError,\n            options.props ?? null,\n        )\n        .then((modal) => {\n            const listeners = options.listeners ?? {}\n\n            Object.keys(listeners).forEach((event) => {\n                // e.g. refreshKey -> refresh-key\n                const eventName = kebabCase(event)\n                modal.on(eventName, listeners[event])\n            })\n\n            return modal\n        })\n}\n\nexport {\n    // Components\n    Deferred,\n    HeadlessModal,\n    ModalComponent as Modal,\n    ModalLink,\n    ModalRoot,\n    WhenVisible,\n    // Config functions\n    getConfig,\n    putConfig,\n    resetConfig,\n    // Modal stack functions\n    initFromPageProps,\n    renderApp,\n    useModal,\n    useModalStack,\n    visitModal,\n    modalPropNames,\n    // Prefetch function (#146)\n    prefetch,\n    // Modal class (exported as ModalInstance to avoid conflict with Modal component)\n    ModalClass as ModalInstance,\n    // Dialog utilities (framework-agnostic)\n    dialogUtils,\n}\n\n// Export types\nexport type { ModalStack, ModalResponseData, ModalConfig, ReloadOptions, VisitOptions, PrefetchOption, PrefetchOptions }\nexport type { ModalTypeConfig } from './config'\nexport type {\n    CleanupFunction,\n    FocusTrapOptions,\n    ClickOutsideOptions,\n    EscapeKeyOptions,\n    DialogOptions,\n    Dialog,\n} from './dialog'\n"],"names":["defaultConfig","Config","key","value","keys","current","i","k","configInstance","resetConfig","putConfig","getConfig","getConfigByType","isSlideover","generateId","prefix","vanillaGenerateId","sameUrlPath","url1","url2","origin","parsed1","parsed2","props","__props","modalStack","useModalStack","modalContext","computed","provide","_a","_createBlock","_unref","_mergeProps","only","_cache","event","args","$page","usePage","isNavigating","initialModalStillOpened","pendingModalKeys","getModalKey","modalData","onUnmounted","router","$event","modalOnBase","pageUrl","modalKey","_b","axiosRequestInterceptor","config","baseUrlValue","onBeforeMount","Axios","onMounted","watch","newModal","previousModal","existingModal","_renderSlot","_ctx","ModalRenderer","resolveComponent","baseUrl","ref","stack","localModals","prefetchCache","prefetchInFlight","getPrefetchCacheKey","url","method","data","getCachedResponse","cached","setCachedResponse","response","cacheFor","prefetch","href","options","headers","queryStringArrayFormat","mergedData","mergeDataIntoQueryString","cacheKey","inFlight","requestHeaders","request","setComponentResolver","resolver","initFromPageProps","pageProps","Modal","component","onClose","afterLeave","componentProps","index","modal","open","currentProps","_inertiaui_modal","rest","callback","kebabCase","cb","$attrs","unsubscribers","eventName","unsub","except","error","m","registerLocalModal","name","pushLocalModal","push","isValidModalResponse","updateBrowserUrl","useBrowserHistory","pushFromResponseData","responseData","onAfterLeave","markRaw","visit","payload","onStart","onSuccess","onError","modalId","resolve","reject","cachedResponse","progress","loadDeferredProps","deferred","nextTick","modalPropNames","renderApp","App","h","ModalRoot","readonly","force","useModal","toValue","inject","allKeysAreAvailable","context","registerEventListeners","onBeforeUnmount","unsubscribeEventListeners","useAttrs","emits","__emit","emit","__expose","onTopOfStack","previousOnTopOfStack","isOpen","previousIsOpen","nextIndex","modalProps","ctx","unref","_createElementBlock","_createElementVNode","maxWidthClasses","defaultMaxWidth","getMaxWidthClass","maxWidth","entered","isLeaving","wrapperRef","dialogRef","cleanupFocusTrap","cleanupEscapeKey","maxWidthClass","setupFocusTrap","createFocusTrap","cleanupFocusTrap_","setupEscapeKey","onEscapeKey","cleanupEscapeKey_","handleClickOutside","onAfterEnter","handleCancel","handleDialogClick","openDialog","closeDialog","onTop","_normalizeClass","_hoisted_1","_openBlock","_hoisted_3","_createVNode","CloseButton","_Transition","_hoisted_5","transformEnterFrom","rendered","cleanupScrollLock","cleanupAriaHidden","lockScroll","markAriaHidden","onSuccessEvent","onCloseEvent","useNativeDialog","HeadlessModal","close","getChildModal","getParentModal","id","reload","setOpen","shouldRender","_Teleport","_hoisted_2","_resolveDynamicComponent","SlideoverContent","ModalContent","$emit","loading","isBlurred","shouldNavigate","hoverTimeout","prefetchModes","doPrefetch","prefetchModal","onMouseenter","onMouseleave","onMousedown","oldValue","handle","rejectNullValues","loaded","fetching","rootElement","observer","getReloadParams","entries","reloadParams","visitModal","listeners"],"mappings":";;;;;AAkBA,MAAMA,IAA6B;AAAA,EAC/B,MAAM;AAAA,EACN,UAAU;AAAA,EACV,iBAAiB;AAAA,EACjB,OAAO;AAAA,IACH,aAAa;AAAA,IACb,iBAAiB;AAAA,IACjB,qBAAqB;AAAA,IACrB,UAAU;AAAA,IACV,gBAAgB;AAAA,IAChB,cAAc;AAAA,IACd,UAAU;AAAA,EAAA;AAAA,EAEd,WAAW;AAAA,IACP,aAAa;AAAA,IACb,iBAAiB;AAAA,IACjB,qBAAqB;AAAA,IACrB,UAAU;AAAA,IACV,gBAAgB;AAAA,IAChB,cAAc;AAAA,IACd,UAAU;AAAA,EAAA;AAElB;AAEA,MAAMC,GAAO;AAAA,EAGT,cAAc;AACV,SAAK,SAAS,CAAA,GACd,KAAK,MAAA;AAAA,EACT;AAAA,EAEA,QAAc;AACV,SAAK,SAAS,KAAK,MAAM,KAAK,UAAUD,CAAa,CAAC;AAAA,EAC1D;AAAA,EAEA,IAAIE,GAAoCC,GAAuB;AAC3D,QAAI,OAAOD,KAAQ,UAAU;AACzB,WAAK,SAAS;AAAA,QACV,MAAMA,EAAI,QAAQF,EAAc;AAAA,QAChC,UAAUE,EAAI,YAAYF,EAAc;AAAA,QACxC,iBAAiBE,EAAI,mBAAmBF,EAAc;AAAA,QACtD,OAAO,EAAE,GAAGA,EAAc,OAAO,GAAIE,EAAI,SAAS,GAAC;AAAA,QACnD,WAAW,EAAE,GAAGF,EAAc,WAAW,GAAIE,EAAI,aAAa,CAAA,EAAC;AAAA,MAAG;AAEtE;AAAA,IACJ;AACA,UAAME,IAAOF,EAAI,MAAM,GAAG;AAC1B,QAAIG,IAAmC,KAAK;AAC5C,aAASC,IAAI,GAAGA,IAAIF,EAAK,SAAS,GAAGE;AACjC,MAAAD,IAAWA,EAAQD,EAAKE,CAAC,CAAC,IAAID,EAAQD,EAAKE,CAAC,CAAC,KAAK,CAAA;AAEtD,IAAAD,EAAQD,EAAKA,EAAK,SAAS,CAAC,CAAC,IAAID;AAAA,EACrC;AAAA,EAEA,IAAID,GAAuB;AACvB,QAAI,OAAOA,IAAQ;AACf,aAAO,KAAK;AAEhB,UAAME,IAAOF,EAAI,MAAM,GAAG;AAC1B,QAAIG,IAAmB,KAAK;AAC5B,eAAWE,KAAKH,GAAM;AAClB,UAAIC,KAAY,QAAiC,OAAOA,KAAY;AAChE,eAAO;AAEX,MAAAA,IAAWA,EAAoCE,CAAC;AAAA,IACpD;AACA,WAAOF,MAAY,SAAY,OAAOA;AAAA,EAC1C;AACJ;AAEA,MAAMG,KAAiB,IAAIP,GAAA,GAEdQ,KAAc,MAAYD,GAAe,MAAA,GACzCE,KAAY,CAACR,GAAoCC,MAA0BK,GAAe,IAAIN,GAAKC,CAAK,GACxGQ,KAAY,CAACT,MAA0BM,GAAe,IAAIN,CAAG,GAC7DU,IAAkB,CAACC,GAAsBX,MAClDM,GAAe,IAAIK,IAAc,aAAaX,CAAG,KAAK,SAASA,CAAG,EAAE;ACnFxE,SAASY,EAAWC,IAAiB,oBAA4B;AAI7D,SAAOC,GAAkBD,CAAM;AACnC;AAEA,SAASE,EAAYC,GAAoBC,GAA6B;AAClE,QAAMC,IAAS,OAAO,SAAW,MAAc,OAAO,SAAS,SAAS,oBAClEC,IAAU,OAAOH,KAAS,WAAW,IAAI,IAAIA,GAAME,CAAM,IAAIF,GAC7DI,IAAU,OAAOH,KAAS,WAAW,IAAI,IAAIA,GAAMC,CAAM,IAAID;AAEnE,SAAO,GAAGE,EAAQ,MAAM,GAAGA,EAAQ,QAAQ,MAAO,GAAGC,EAAQ,MAAM,GAAGA,EAAQ,QAAQ;AAC1F;;;;;;;;;;ACpBA,UAAMC,IAAQC,GAORC,IAAaC,EAAa,GAE1BC,IAAeC,EAAS,MACnBH,EAAW,MAAM,MAAMF,EAAM,KAAK,CAC5C;AAED,WAAAM,GAAQ,gBAAgBF,CAAY;;AAKtB,cAAAG,IAAAH,EAAA,UAAA,QAAAG,EAAc,kBADxBC,EAIEC,EAAAL,CAAA,EAAA,WAJFM,GAIE,EAAA,KAAA,KAFUD,EAAAE,EAAA,EAAKP,EAAA,MAAa,SAAK,CAAA,GAAQA,EAAA,MAAa,wBAAoB,EAAA,GAAA;AAAA,QACvE,cAAWQ,EAAA,CAAA,MAAAA,EAAA,CAAA,IAAA,CAAGC,MAAUC,MAASV,EAAA,MAAa,KAAKS,GAAK,GAAKC,CAAI;AAAA;;;;;;ACjB1E,UAAMZ,IAAaC,EAAa,GAC1BY,IAAQC,GAAO;AAErB,QAAIC,IAAe,IACfC,IAA0B;AAC9B,UAAMC,IAAmB,oBAAI,IAAG,GAG1BC,IAAc,CAACC,MAAcA,EAAU,MAAM,GAAGA,EAAU,SAAS,IAAIA,EAAU,GAAG;AAE1F,IAAAC,EAAYC,EAAO,GAAG,SAAS,MAAON,IAAe,EAAK,CAAC,GAC3DK,EAAYC,EAAO,GAAG,UAAU,MAAON,IAAe,EAAM,CAAC,GAC7DK;AAAA,MACIC,EAAO,GAAG,YAAY,CAACC,MAAW;AAC9B,cAAMC,IAAcD,EAAO,OAAO,KAAK,MAAM,kBACvCE,IAAUF,EAAO,OAAO,KAAK;AAEnC,YAAI,CAACC,GAAa;AAEd,UAAAvB,EAAW,SAAS,EAAI,GACxBA,EAAW,WAAW,IAAI,GAC1BgB,IAA0B;AAC1B;AAAA,QACJ;AAIA,YAAI,CAACxB,EAAYgC,GAASD,EAAY,GAAG,GAAG;AACxC,UAAAvB,EAAW,SAAS,EAAI,GACxBA,EAAW,WAAW,IAAI,GAC1BgB,IAA0B;AAC1B;AAAA,QACJ;AAEA,QAAAhB,EAAW,WAAWuB,EAAY,OAAO;AAGzC,cAAME,IAAWP,EAAYK,CAAW;AACxC,QAAIN,EAAiB,IAAIQ,CAAQ,KAK7BF,EAAY,MAAMvB,EAAW,MAAM,MAAM,KAAK,CAAC,MAAM,EAAE,OAAOuB,EAAY,EAAE,KAM5EvB,EAAW,MAAM,MAAM,KAAK,CAAC,MAAC;;AAAK,mBAAAK,IAAA,EAAE,aAAF,gBAAAA,EAAY,eAAckB,EAAY,aAAa/B,GAAYkC,IAAA,EAAE,aAAF,gBAAAA,EAAY,KAAKH,EAAY,GAAG;AAAA,SAAC,MAIvIN,EAAiB,IAAIQ,CAAQ,GAE7BzB,EACK,qBAAqBuB,GAAa,CAAA,GAAI,MAAM;AACzC,cAAI,CAACA,EAAY,SAAS;AACtB,oBAAQ,MAAM,4DAA4D;AAC1E;AAAA,UACJ;AAEA,UAAI,CAACR,KAAgB,OAAO,SAAW,OAAe,OAAO,SAAS,SAASQ,EAAY,WACvFF,EAAO,MAAME,EAAY,SAAS;AAAA,YAC9B,gBAAgB;AAAA,YAChB,eAAe;AAAA,UACvC,CAAqB;AAAA,QAET,CAAC,EACA,KAAK,MAAM;AACR,UAAAN,EAAiB,OAAOQ,CAAQ;AAAA,QACpC,CAAC;AAAA,MACT,CAAC;AAAA,IACL;AAEA,UAAME,IAA0B,CAACC,MAAW;;AAIxC,YAAMC,IAAe7B,EAAW,iBAAiBgB,KAA0BX,IAAAQ,EAAM,MAAM,qBAAZ,gBAAAR,EAA8B,UAAU;AACnH,aAAIwB,MACAD,EAAO,QAAQ,4BAA4B,IAAIC,IAG5CD;AAAA,IACX;AAEA,WAAAE,GAAc,MAAMC,EAAM,aAAa,QAAQ,IAAIJ,CAAuB,CAAC,GAC3EK,EAAU,MAAOhB,IAA0B,CAAC,CAACH,EAAM,MAAM,gBAAiB,GAC1EO,EAAY,MAAMW,EAAM,aAAa,QAAQ,MAAMJ,CAAuB,CAAC,GAE3EM;AAAA,MACI,MAAA;;AAAM,gBAAA5B,IAAAQ,EAAM,UAAN,gBAAAR,EAAa;AAAA;AAAA,MACnB,CAAC6B,GAAUC,MAAkB;;AACzB,YAAKD,GAKL;AAAA,cAAIC,KAAiBD,EAAS,cAAcC,EAAc,aAAa3C,EAAY0C,EAAS,KAAKC,EAAc,GAAG,GAAG;AACjH,aAAA9B,IAAAL,EAAW,MAAM,MAAM,CAAC,MAAxB,QAAAK,EAA2B,YAAY6B,EAAS,SAAS,CAAA;AACzD;AAAA,UACJ;AAIA,cAAI,CAACC,KAAiBnC,EAAW,MAAM,MAAM,SAAS,GAAG;AACrD,kBAAMoC,IAAgBpC,EAAW,MAAM,MAAM;AAAA,cACzC,CAAC,MAAC;;AAAK,yBAAAK,IAAA,EAAE,aAAF,gBAAAA,EAAY,eAAc6B,EAAS,aAAa1C,GAAYkC,IAAA,EAAE,aAAF,gBAAAA,EAAY,KAAKQ,EAAS,GAAG;AAAA;AAAA,YAChH;AACY,YAAIE,KACAA,EAAc,YAAYF,EAAS,SAAS,CAAA,CAAE;AAAA,UAEtD;AAAA;AAAA,MACJ;AAAA,IACJ;MAIIG,EAAQC,EAAA,QAAA,SAAA;AAAA,MAGE/B,EAAAP,CAAA,EAAW,MAAM,MAAM,eADjCM,EAGEiC,IAAA;AAAA;QADG,OAAO;AAAA;;;;AC9DhB,IAAIC,IAA6C;AAEjD,MAAMC,IAAUC,EAAmB,IAAI,GACjCC,IAAQD,EAAa,EAAE,GACvBE,IAAcF,EAAwE,EAAE,GASxFG,yBAAoB,IAAA,GACpBC,yBAAuB,IAAA;AAE7B,SAASC,GAAoBC,GAAaC,GAAgBC,GAA8B;AACpF,SAAO,GAAGD,CAAM,IAAID,CAAG,IAAI,KAAK,UAAUE,CAAI,CAAC;AACnD;AAEA,SAASC,GAAkBH,GAAaC,GAAgBC,GAA4C;AAChG,QAAMzE,IAAMsE,GAAoBC,GAAKC,GAAQC,CAAI,GAC3CE,IAASP,GAAc,IAAIpE,CAAG;AAEpC,SAAK2E,IAID,KAAK,QAAQA,EAAO,aACpBP,GAAc,OAAOpE,CAAG,GACjB,QAGJ2E,EAAO,WARH;AASf;AAEA,SAASC,GAAkBL,GAAaC,GAAgBC,GAAsBI,GAAyBC,GAAwB;AAC3H,QAAM9E,IAAMsE,GAAoBC,GAAKC,GAAQC,CAAI;AACjD,EAAAL,GAAc,IAAIpE,GAAK;AAAA,IACnB,UAAA6E;AAAA,IACA,WAAW,KAAK,IAAA;AAAA,IAChB,WAAW,KAAK,QAAQC;AAAA,EAAA,CAC3B;AACL;AAEO,SAASC,GAASC,GAAcC,IAA2B,IAAmB;;AACjF,MAAID,EAAK,WAAW,GAAG;AACnB,WAAO,QAAQ,QAAA;AAGnB,QAAMR,KAAUS,EAAQ,UAAU,OAAO,YAAA,GACnCR,IAAOQ,EAAQ,QAAS,CAAA,GACxBC,IAAUD,EAAQ,WAAW,CAAA,GAC7BE,IAAyBF,EAAQ,0BAA0B,YAC3DH,IAAWG,EAAQ,YAAY,KAE/B,CAACV,GAAKa,CAAU,IAAIC,GAAyBb,GAAuDQ,KAAQ,IAAIP,GAAMU,CAAsB;AAIlJ,MADeT,GAAkBH,GAAKC,GAAQY,CAAU;AAEpD,WAAO,QAAQ,QAAA;AAInB,QAAME,IAAWhB,GAAoBC,GAAKC,GAAQY,CAAU,GACtDG,IAAWlB,GAAiB,IAAIiB,CAAQ;AAC9C,MAAIC;AACA,WAAOA,EAAS,KAAK,MAAM;AAAA,IAAC,CAAC;AAGjC,GAAA3D,IAAAqD,EAAQ,kBAAR,QAAArD,EAAA,KAAAqD;AAEA,QAAMO,IAAmE;AAAA,IACrE,GAAGN;AAAA,IACH,QAAQ;AAAA,IACR,oBAAoB;AAAA,IACpB,aAAa;AAAA,IACb,qBAAqB7C,KAAU,WAAW;AAAA,IAC1C,qBAAqBzB,EAAA;AAAA,IACb,8BAA8BoD,EAAQ;AAAA,EAAA,GAG5CyB,IAAUnC,EAAM,EAAE,KAAAiB,GAAK,QAAAC,GAAQ,MAAMY,GAAY,SAASI,EAAA,CAAgB,EAC3E,KAAK,CAACX,MAAa;;AAChB,WAAAD,GAAkBL,GAAKC,GAAQY,GAAYP,GAAUC,CAAQ,IAC7DlD,IAAAqD,EAAQ,iBAAR,QAAArD,EAAA,KAAAqD,IACOJ;AAAA,EACX,CAAC,EACA,QAAQ,MAAM;AACX,IAAAR,GAAiB,OAAOiB,CAAQ;AAAA,EACpC,CAAC;AAEL,SAAAjB,GAAiB,IAAIiB,GAAUG,CAAO,GAE/BA,EAAQ,KAAK,MAAM;AAAA,EAAC,CAAC;AAChC;AAEA,MAAMC,KAAuB,CAACC,MAAsC;AAChE,EAAA5B,IAAmB4B;AACvB,GAEaC,KAAoB,CAACC,MAA8D;AAC5F,EAAIA,EAAU,qBACV9B,IAAmB8B,EAAU;AAErC;AAEO,MAAMC,GAAM;AAAA,EAef,YACIC,GACAlB,GACA1B,GACA6C,GACAC,GACF;AAyBF,SAAA,uBAAuB,MAAgB;AACnC,UAAI,CAAC,KAAK;AACN,eAAO,CAAA;AAGX,YAAMC,IAAkB,KAAK,UAAyE;AAEtG,aAAI,MAAM,QAAQA,CAAc,IACrBA,IAGJA,IAAiB,OAAO,KAAKA,CAAc,IAAI,CAAA;AAAA,IAC1D,GAEA,KAAA,iBAAiB,MAAgC;AAC7C,YAAMC,IAAQ,KAAK,MAAM;AAEzB,aAAIA,IAAQ,IAED,OAIJjC,EAAM,MACR,MAAM,GAAGiC,CAAK,EACd,QAAA,EACA,KAAK,CAACC,MAAUA,EAAM,MAAM;AAAA,IACrC,GAEA,KAAA,gBAAgB,MAAoB;AAChC,YAAMD,IAAQ,KAAK,MAAM;AAEzB,aAAIA,MAAUjC,EAAM,MAAM,SAAS,IAExB,OAIHA,EAAM,MAAM,MAAMiC,IAAQ,CAAC,EAAE,KAAK,CAACC,MAAUA,EAAM,MAAM,KAAsC;AAAA,IAC3G,GAEA,KAAA,OAAO,MAAY;AACf,YAAMD,IAAQ,KAAK,MAAM;AAEzB,UAAIA,IAAQ,IAAI;AACZ,YAAIjC,EAAM,MAAMiC,CAAK,EAAE;AAEnB;AAGJ,QAAAjC,EAAM,MAAMiC,CAAK,EAAE,SAAS,IAC5BjC,EAAM,MAAMiC,CAAK,EAAE,eAAe;AAAA,MACtC;AAAA,IACJ,GAEA,KAAA,QAAQ,MAAY;;AAChB,YAAMA,IAAQ,KAAK,MAAM;AAEzB,UAAIA,IAAQ,IAAI;AACZ,YAAI,CAACjC,EAAM,MAAMiC,CAAK,EAAE;AAEpB;AAGJ,eAAO,KAAK,KAAK,SAAS,EAAE,QAAQ,CAACjE,MAAU;AAC3C,eAAK,IAAIA,CAAK;AAAA,QAClB,CAAC,GAEDgC,EAAM,MAAMiC,CAAK,EAAE,SAAS,KAC5BvE,IAAA,KAAK,oBAAL,QAAAA,EAAA,YACA,KAAK,kBAAkB;AAAA,MAC3B;AAAA,IACJ,GAEA,KAAA,UAAU,CAACyE,MAAwB;AAC/B,MAAIA,IACA,KAAK,KAAA,IAEL,KAAK,MAAA;AAAA,IAEb,GAEA,KAAA,aAAa,MAAY;;AACrB,YAAMF,IAAQ,KAAK,MAAM;AAEzB,UAAIA,IAAQ,IAAI;AACZ,YAAIjC,EAAM,MAAMiC,CAAK,EAAE;AAEnB;AAGJ,QAAAjC,EAAM,MAAMiC,CAAK,EAAE,eAAe,KAClCvE,IAAA,KAAK,uBAAL,QAAAA,EAAA,YACA,KAAK,qBAAqB;AAAA,MAC9B;AAEA,MAAIuE,MAAU,MACVjC,EAAM,QAAQ,CAAA,GAGVF,EAAQ,SAAS,OAAO,SAAW,OACnCpB,EAAO,KAAK;AAAA,QACR,KAAKoB,EAAQ;AAAA,QACb,gBAAgB;AAAA,QAChB,eAAe;AAAA;AAAA;AAAA,QAGf,OAAO,CAACsC,MAA0C;AAE9C,gBAAM,EAAE,kBAAAC,GAAkB,GAAGC,EAAA,IAASF;AACtC,iBAAO,EAAE,GAAGE,GAAM,kBAAkB,OAAA;AAAA,QACxC;AAAA,MAAA,CACH,GAGLxC,EAAQ,QAAQ;AAAA,IAExB,GAEA,KAAA,KAAK,CAAC9B,GAAeuE,MAAkC;AACnD,MAAAvE,IAAQwE,EAAUxE,CAAK,GACvB,KAAK,UAAUA,CAAK,IAAI,KAAK,UAAUA,CAAK,KAAK,CAAA,GACjD,KAAK,UAAUA,CAAK,EAAE,KAAKuE,CAAQ;AAAA,IACvC,GAEA,KAAA,MAAM,CAACvE,GAAeuE,MAAmC;;AACrD,MAAAvE,IAAQwE,EAAUxE,CAAK,GACnBuE,IACA,KAAK,UAAUvE,CAAK,MAAIN,IAAA,KAAK,UAAUM,CAAK,MAApB,gBAAAN,EAAuB,OAAO,CAAC+E,MAAOA,MAAOF,OAAa,CAAA,IAElF,OAAO,KAAK,UAAUvE,CAAK;AAAA,IAEnC,GAEA,KAAA,OAAO,CAACA,MAAkBC,MAA0B;;AAChD,OAAAP,IAAA,KAAK,UAAU8E,EAAUxE,CAAK,CAAC,MAA/B,QAAAN,EAAkC,QAAQ,CAAC6E,MAAaA,EAAS,GAAGtE,CAAI;AAAA,IAC5E,GAEA,KAAA,kCAAkC,CAACyE,MAAkD;AACjF,YAAMC,IAAgC,CAAA;AAEtC,oBAAO,KAAKD,CAAM,EACb,OAAO,CAAC5G,MAAQA,EAAI,WAAW,IAAI,CAAC,EACpC,QAAQ,CAACA,MAAQ;AACd,cAAM8G,IAAYJ,EAAU1G,CAAG,EAAE,QAAQ,QAAQ,EAAE,GAC7CyG,IAAWG,EAAO5G,CAAG;AAC3B,aAAK,GAAG8G,GAAWL,CAAQ,GAC3BI,EAAc,KAAK,MAAM,KAAK,IAAIC,GAAWL,CAAQ,CAAC;AAAA,MAC1D,CAAC,GAEE,MAAMI,EAAc,QAAQ,CAACE,MAAUA,GAAO;AAAA,IACzD,GAEA,KAAA,SAAS,CAAC9B,IAAyB,OAAa;;AAC5C,UAAI/E,IAAO,OAAO,KAAK,KAAK,SAAS,KAAK;AAU1C,UARI+E,EAAQ,SACR/E,IAAO+E,EAAQ,OAGfA,EAAQ,WACR/E,IAAO8G,GAAO9G,GAAM+E,EAAQ,MAAM,IAGlC,GAACrD,IAAA,KAAK,aAAL,QAAAA,EAAe;AAChB;AAGJ,YAAM4C,KAAUS,EAAQ,UAAU,OAAO,YAAA,GACnCR,IAAOQ,EAAQ,QAAQ,CAAA;AAE7B,OAAAhC,IAAAgC,EAAQ,YAAR,QAAAhC,EAAA,KAAAgC,IAEA3B,EAAM;AAAA,QACF,KAAK,KAAK,SAAS;AAAA,QACnB,QAAAkB;AAAA,QACA,MAAMA,MAAW,QAAQ,CAAA,IAAKC;AAAA,QAC9B,QAAQD,MAAW,QAAQC,IAAO,CAAA;AAAA,QAClC,SAAS;AAAA,UACL,GAAIQ,EAAQ,WAAW,CAAA;AAAA,UACvB,QAAQ;AAAA,UACR,aAAa;AAAA,UACb,+BAA+B,KAAK,SAAS;AAAA,UAC7C,qBAAqB,KAAK,SAAS,WAAW;AAAA,UAC9C,0BAA0B/E,EAAK,KAAK,GAAG;AAAA,UACvC,qBAAqBU,EAAA;AAAA,UACL,8BAA8BoD,EAAQ;AAAA,QAAA;AAAA,MAC1D,CACH,EACI,KAAK,CAACa,MAAa;;AAChB,aAAK,YAAYA,EAAS,KAAK,KAAK,IACpCjD,IAAAqD,EAAQ,cAAR,QAAArD,EAAA,KAAAqD,GAAoBJ;AAAA,MACxB,CAAC,EACA,MAAM,CAACoC,MAAU;;AACd,SAAArF,IAAAqD,EAAQ,YAAR,QAAArD,EAAA,KAAAqD,GAAkBgC;AAAA,MACtB,CAAC,EACA,QAAQ,MAAM;;AACX,SAAArF,IAAAqD,EAAQ,aAAR,QAAArD,EAAA,KAAAqD;AAAA,MACJ,CAAC;AAAA,IACT,GAEA,KAAA,cAAc,CAAC5D,MAAyC;AACpD,aAAO,OAAO,KAAK,MAAM,OAAOA,CAAK;AAAA,IACzC,GAnOI,KAAK,KAAKwD,EAAS,MAAMjE,EAAA,GACzB,KAAK,SAAS,IACd,KAAK,eAAe,IACpB,KAAK,YAAY,CAAA,GAEjB,KAAK,YAAYmF,GACjB,KAAK,QAAQ9B,EAAIY,EAAS,SAAS,CAAA,CAAE,GACrC,KAAK,WAAWA,GAChB,KAAK,SAAS1B,KAAU,CAAA,GACxB,KAAK,kBAAkB6C,KAAW,MAClC,KAAK,qBAAqBC,KAAc,MAExC,KAAK,QAAQvE,EAAS,MAAMwC,EAAM,MAAM,UAAU,CAACgD,MAAMA,EAAE,OAAO,KAAK,EAAE,CAAC,GAC1E,KAAK,eAAexF,EAAS,MAAM;;AAC/B,aAAIwC,EAAM,MAAM,SAAS,IACd,OAKJtC,IAFQsC,EAAM,MAAM,IAAI,CAACkC,OAAW,EAAE,IAAIA,EAAM,IAAI,cAAcA,EAAM,eAAe,EAEhF,UAAU,KAAK,CAACA,MAAUA,EAAM,YAAY,MAAnD,gBAAAxE,EAAsD,QAAO,KAAK;AAAA,IAC7E,CAAC;AAAA,EACL;AA8MJ;AAEA,SAASuF,GAAmBC,GAAcX,GAAwC;AAC9E,EAAAtC,EAAY,MAAMiD,CAAI,IAAI,EAAE,MAAAA,GAAM,UAAAX,EAAA;AACtC;AAEA,SAASY,GACLD,GACAjE,GACA6C,GACAC,GACA5E,GACK;AACL,MAAI,CAAC8C,EAAY,MAAMiD,CAAI;AACvB,UAAM,IAAI,MAAM,oBAAoBA,CAAI,4BAA4B;AAIxE,QAAMhB,IAAQkB,GAAK,MADE,EAAE,OAAOjG,KAAS,CAAA,EAAC,GACD8B,GAAQ6C,GAASC,CAAU;AAClE,SAAAG,EAAM,OAAOgB,GACbjD,EAAY,MAAMiD,CAAI,EAAE,SAAShB,CAAK,GAC/BA;AACX;AAEA,SAASmB,GAAqB9C,GAA0C;AACpE,SACI,OAAOA,KAAS,YAChBA,MAAS,QACT,eAAeA,KACf,OAAQA,EAA2B,aAAc;AAEzD;AAEA,SAAS+C,GAAiBjD,GAAyBkD,GAA4B/E,GAAqC;AAChH,EAAI,CAAC6B,KAAO,CAACkD,KAAqB,OAAO,SAAW,OAIpD7E,EAAO,KAAK;AAAA,IACR,KAAA2B;AAAA,IACA,gBAAgB;AAAA,IAChB,eAAe;AAAA;AAAA;AAAA,IAGf,OAAO7B,IACD,CAAC4D,OAA2C;AAAA,MACxC,GAAGA;AAAA,MACH,kBAAkB;AAAA,QACd,GAAG5D;AAAA,QACH,SAASsB,EAAQ;AAAA,MAAA;AAAA,IACrB,KAEJ;AAAA,EAAA,CACT;AACL;AAEA,SAAS0D,GACLC,GACAxE,IAAsB,CAAA,GACtB6C,IAA+B,MAC/B4B,IAAoC,MACtB;AACd,SAAK7D,IAIAwD,GAAqBI,CAAY,IAS/B5D,EAAiB4D,EAAa,SAAS,EAAE;AAAA,IAAK,CAAC5B,MAClDuB,GAAKO,GAAQ9B,CAAS,GAAG4B,GAAcxE,GAAQ6C,GAAS4B,CAAY;AAAA,EAAA,IAT7D,QAAQ;AAAA,IACX,IAAI;AAAA,MACA;AAAA,IAAA;AAAA,EAEJ,IARG,QAAQ,OAAO,IAAI,MAAM,4BAA4B,CAAC;AAerE;AAEA,SAASE,GACL9C,GACAR,GACAuD,IAA0B,CAAA,GAC1B7C,IAAkC,CAAA,GAClC/B,IAAsB,CAAA,GACtB6C,IAA+B,MAC/B4B,IAAoC,MACpCzC,IAAiD,YACjDsC,IAA6B,IAC7BO,IAA+B,MAC/BC,IAAyD,MACzDC,IAAiD,MACjD7G,IAAwC,MAC1B;AACd,QAAM8G,IAAUvH,EAAA;AAEhB,SAAO,IAAI,QAAQ,CAACwH,GAASC,MAAW;;AACpC,QAAIrD,EAAK,WAAW,GAAG,GAAG;AACtB,MAAAoD,EAAQf,GAAerC,EAAK,UAAU,CAAC,GAAG7B,GAAQ6C,GAAS4B,GAAcvG,CAAK,CAAC;AAC/E;AAAA,IACJ;AAEA,UAAM,CAACkD,GAAKE,CAAI,IAAIY,GAAyBb,GAAuDQ,KAAQ,IAAI+C,GAAS5C,CAAsB,GAGzImD,IAAiB5D,GAAkBH,GAAKC,GAAQC,CAAI;AAC1D,QAAI6D,GAAgB;AAChB,MAAAL,KAAA,QAAAA,EAAYK,IACZZ,GAAqBY,EAAe,MAAMnF,GAAQ6C,GAAS4B,CAAY,EAClE,KAAK,CAACxB,MAAU;AACb,QAAAoB,GAAiBc,EAAe,KAAK,KAAKb,GAAmBa,EAAe,IAAI,GAChFF,EAAQhC,CAAK;AAAA,MACjB,CAAC,EACA,MAAMiC,CAAM;AACjB;AAAA,IACJ;AAEA,IAAInE,EAAM,MAAM,WAAW,MACvBF,EAAQ,QAAQ,OAAO,SAAW,MAAc,OAAO,SAAS,OAAO;AAG3E,UAAMwB,IAAmE;AAAA,MACrE,GAAGN;AAAA,MACH,QAAQ;AAAA,MACR,oBAAoB;AAAA,MACpB,aAAa;AAAA,MACb,qBAAqB7C,KAAU,WAAW;AAAA,MAC1C,qBAAqB8F;AAAA,MACT,8BAA8BnE,EAAQ;AAAA,IAAA;AAGtD,IAAAgE,KAAA,QAAAA,MAEApG,IAAA2G,OAAA,QAAA3G,EAAU,SAEV0B,EAAM,EAAE,KAAAiB,GAAK,QAAAC,GAAQ,MAAAC,GAAM,SAASe,GAAgB,EAC/C,KAAK,CAACX,MAAa;AAChB,MAAAoD,KAAA,QAAAA,EAAYpD,IACZ6C,GAAqB7C,EAAS,MAAM1B,GAAQ6C,GAAS4B,CAAY,EAC5D,KAAK,CAACxB,MAAU;AACb,QAAAoB,GAAiB3C,EAAS,KAAK,KAAK4C,GAAmB5C,EAAS,IAAI,GACpEuD,EAAQhC,CAAK;AAAA,MACjB,CAAC,EACA,MAAMiC,CAAM;AAAA,IACrB,CAAC,EACA,MAAM,IAAIlG,MAAoB;AAC3B,MAAA+F,KAAA,QAAAA,EAAU,GAAG/F,IACbkG,EAAOlG,EAAK,CAAC,CAAC;AAAA,IAClB,CAAC,EACA,QAAQ,MAAM;;AACX,OAAAP,IAAA2G,OAAA,QAAA3G,EAAU;AAAA,IACd,CAAC;AAAA,EACT,CAAC;AACL;AAEA,SAAS4G,GAAkBpC,GAAoB;;AAC3C,QAAMqC,KAAWxF,KAAArB,IAAAwE,EAAM,aAAN,gBAAAxE,EAAgB,SAAhB,gBAAAqB,EAAsB;AAEvC,EAAKwF,KAIL,OAAO,KAAKA,CAAQ,EAAE,QAAQ,CAACzI,MAAQ;AACnC,IAAAoG,EAAM,OAAO,EAAE,MAAMqC,EAASzI,CAAG,GAAG;AAAA,EACxC,CAAC;AACL;AAEA,SAASsH,GACLvB,GACAlB,GACA1B,GACA6C,GACAC,GACK;AACL,QAAMxC,IAAW,IAAIqC,GAAMC,GAAWlB,GAAU1B,GAAQ6C,GAASC,CAAU;AAE3E,SAAA/B,EAAM,MAAM,KAAKT,CAAQ,GACzB+E,GAAkB/E,CAAQ,GAE1BiF,GAAS,MAAMjF,EAAS,MAAM,GAEvBA;AACX;AAEO,MAAMkF,KAAiB,CAAC,eAAe,mBAAmB,uBAAuB,YAAY,kBAAkB,gBAAgB,YAAY,WAAW,GAEhJC,KAAY,CAACC,GAAgBxH,OAClCA,EAAM,qBACN0C,IAAmB1C,EAAM,mBAGtB,MAAMyH,GAAEC,IAAW,MAAMD,GAAED,GAAKxH,CAAK,CAAC;AAkB1C,SAASG,IAA4B;AACxC,SAAO;AAAA,IACH,sBAAAkE;AAAA,IACA,YAAY,MAAM1B,EAAQ;AAAA,IAC1B,YAAY,CAACO,MAAwBP,EAAQ,QAAQO;AAAA,IACrD,OAAOyE,GAAS9E,CAAK;AAAA,IACrB,MAAAoD;AAAA,IACA,sBAAAI;AAAA,IACA,UAAU,CAACuB,IAAQ,OAAU;AACzB,MAAIA,IAEA/E,EAAM,QAAQ,CAAA,IAGb,CAAC,GAAGA,EAAM,KAAK,EAAE,QAAA,EAAU,QAAQ,CAACkC,MAAUA,EAAM,OAAO;AAAA,IAEpE;AAAA,IACA,OAAO,MAAOlC,EAAM,QAAQ,CAAA;AAAA,IAC5B,OAAA4D;AAAA,IACA,oBAAAX;AAAA,IACA,kBAAkB,CAACC,MAAiB,OAAOjD,EAAY,MAAMiD,CAAI;AAAA,EAAA;AAEzE;AChpBA,SAAwB8B,KAAyB;AAC7C,SAAOC,GAAQC,GAAqB,gBAAgB,IAAI,CAAC;AAC7D;;;;;;;;;;ACDA,UAAM/H,IAAQC,GAORG,IAAe2H,GAAO,cAAc;AAE1C,QAAI,CAAC3H;AACD,YAAM,IAAI,MAAM,0DAA0D;AAG9E,UAAM4H,IAAsB3H,EAAS,OACpB,MAAM,QAAQL,EAAM,IAAI,IAAIA,EAAM,OAAO,CAACA,EAAM,IAAI,GAErD,MAAM,CAACrB,MAAQyB,EAAa,MAAM,MAAMzB,CAAG,MAAM,MAAS,CACzE;qBAIeqJ,EAAA,QAAZzF,EAAmCC,EAAA,QAAA,WAAA,EAAA,KAAA,EAAA,CAAA,IAEnCD,EAGEC,EAAA,QAAA,YAAA,EAAA,KAAA,EAAA,CAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACxBN,UAAMxC,IAAQC,GAyCRC,IAAaC,EAAa,GAC1BC,IAAeJ,EAAM,OAAO4C,EAAI,CAAA,CAAE,IAAImF,GAAO,cAAc,GAC3DjG,IAASzB,EAAS,MAAM;;AAC1B,YAAMf,MAAciB,IAAAH,EAAa,MAAM,WAAnB,gBAAAG,EAA2B,cAAaP,EAAM,aAAaZ,GAAU,MAAM,MAAM;AAErG,aAAO;AAAA,QACH,WAAWE;AAAA,QACX,aAAaU,EAAM,eAAeX,EAAgBC,GAAa,aAAa;AAAA,QAC5E,iBAAiBU,EAAM,mBAAmBX,EAAgBC,GAAa,iBAAiB;AAAA,QACxF,qBAAqBU,EAAM,uBAAuBX,EAAgBC,GAAa,qBAAqB;AAAA,QACpG,UAAUU,EAAM,YAAYX,EAAgBC,GAAa,UAAU;AAAA,QACnE,gBAAgBU,EAAM,kBAAkBX,EAAgBC,GAAa,gBAAgB;AAAA,QACrF,cAAcU,EAAM,gBAAgBX,EAAgBC,GAAa,cAAc;AAAA,QAC/E,UAAUU,EAAM,YAAYX,EAAgBC,GAAa,UAAU;AAAA,QACnE,GAAGc,EAAa,MAAM;AAAA,MAC9B;AAAA,IACA,CAAC;AAGD,IAAIJ,EAAM,SACNE,EAAW,mBAAmBF,EAAM,MAAM,SAAUiI,GAAS;AACzD,MAAA7H,EAAa,QAAQ6H,GACrBC,EAAsB;AAAA,IAC1B,CAAC,GAEDC,GAAgB,MAAM;AAClB,MAAAjI,EAAW,iBAAiBF,EAAM,IAAI;AAAA,IAC1C,CAAC,IAGLkC,EAAU,MAAM;AACZ,MAAKlC,EAAM,QACPkI,EAAsB;AAAA,IAE9B,CAAC;AAED,UAAME,IAA4BxF,EAAI,IAAI;AAC1C,IAAAuF,GAAgB,MAAA;;AAAM,cAAA5H,IAAA6H,EAA0B,UAA1B,gBAAA7H,EAAA,KAAA6H;AAAA,KAAmC;AAEzD,UAAM7C,IAAS8C,GAAQ;AAEvB,aAASH,IAAyB;AAC9B,MAAAE,EAA0B,QAAQhI,EAAa,MAAM,gCAAgCmF,CAAM;AAAA,IAC/F;AAEA,UAAM+C,IAAQC;AAEd,aAASC,EAAK3H,MAAUC,GAAM;AAC1B,MAAAwH,EAAM,eAAezH,GAAO,GAAGC,CAAI;AAAA,IACvC;AAEA,IAAA2H,EAAa;AAAA,MACT,MAAAD;AAAA,MACA,YAAY,MAAA;;AAAM,gBAAAjI,IAAAH,EAAa,UAAb,gBAAAG,EAAoB;AAAA;AAAA,MACtC,OAAO,MAAA;;AAAM,gBAAAA,IAAAH,EAAa,UAAb,gBAAAG,EAAoB;AAAA;AAAA,MACjC,QAAQ,IAAIO,MAAI;;AAAK,gBAAAP,IAAAH,EAAa,UAAb,gBAAAG,EAAoB,OAAO,GAAGO;AAAA;AAAA,MACnD,SAAS,IAAIA,MAAI;;AAAK,gBAAAP,IAAAH,EAAa,UAAb,gBAAAG,EAAoB,QAAQ,GAAGO;AAAA;AAAA,MACrD,eAAe,MAAA;;AAAM,gBAAAP,IAAAH,EAAa,UAAb,gBAAAG,EAAoB;AAAA;AAAA,MACzC,gBAAgB,MAAA;;AAAM,gBAAAA,IAAAH,EAAa,UAAb,gBAAAG,EAAoB;AAAA;AAAA,MAE1C,IAAI,SAAS;;AACT,gBAAOA,IAAAH,EAAa,UAAb,gBAAAG,EAAoB;AAAA,MAC/B;AAAA,MACA,IAAI,KAAK;;AACL,gBAAOA,IAAAH,EAAa,UAAb,gBAAAG,EAAoB;AAAA,MAC/B;AAAA,MACA,IAAI,QAAQ;;AACR,gBAAOA,IAAAH,EAAa,UAAb,gBAAAG,EAAoB;AAAA,MAC/B;AAAA,MACA,IAAI,SAAS;;AACT,gBAAOA,IAAAH,EAAa,UAAb,gBAAAG,EAAoB;AAAA,MAC/B;AAAA,MACA,IAAI,eAAe;;AACf,gBAAOA,IAAAH,EAAa,UAAb,gBAAAG,EAAoB;AAAA,MAC/B;AAAA,MACA,IAAI,eAAe;;AACf,gBAAOA,IAAAH,EAAa,UAAb,gBAAAG,EAAoB;AAAA,MAC/B;AAAA,MACA,IAAI,eAAe;;AACf,gBAAOA,IAAAH,EAAa,UAAb,gBAAAG,EAAoB;AAAA,MAC/B;AAAA,IACJ,CAAC,GAED4B;AAAA,MACI,MAAA;;AAAM,gBAAA5B,IAAAH,EAAa,UAAb,gBAAAG,EAAoB;AAAA;AAAA,MAC1B,CAACmI,GAAcC,MAAyB;AACpC,QAAID,KAAgB,CAACC,IACjBL,EAAM,OAAO,IACN,CAACI,KAAgBC,KACxBL,EAAM,MAAM;AAAA,MAEpB;AAAA,IACJ,GAEAnG;AAAA,MACI,MAAA;;AAAM,gBAAA5B,IAAAH,EAAa,UAAb,gBAAAG,EAAoB;AAAA;AAAA,MAC1B,CAACqI,GAAQC,MAAmB;AACxB,QAAID,IACAN,EAAM,SAAS,IACRO,MAAmB,MAG1BP,EAAM,OAAO;AAAA,MAErB;AAAA,MACA,EAAE,WAAW,GAAI;AAAA,IACrB;AAEA,UAAMQ,IAAYzI,EAAS,MAAM;;AAC7B,cAAOE,IAAAL,EAAW,MAAM,MAAM,KAAK,CAAC2F,MAAMA,EAAE,gBAAgBA,EAAE,QAAQzF,EAAa,MAAM,KAAK,MAAvF,gBAAAG,EAA0F;AAAA,IACrG,CAAC,GAGKwI,IAAa1I,EAAS,MAAM;AAC9B,YAAM2I,IAAM5I,EAAa;AACzB,aAAK4I,IAEEC,EAAMD,EAAI,KAAK,KAAK,CAAA,IAFV,CAAA;AAAA,IAGrB,CAAC;;MASavI,EAAAL,CAAA,EAAa,eADvBmC,EAiBEC,EAAA,QAAA,WAjBF9B,GAiBE,EAAA,KAAA,EAAA,GAfUqI,EAAA,OAAU;AAAA,QACjB,IAAItI,EAAAL,CAAA,EAAa;AAAA,QACjB,YAAaK,EAAAL,CAAA,EAAa;AAAA,QAC1B,OAAOK,EAAAL,CAAA,EAAa;AAAA,QACpB,QAAQ0B,EAAA;AAAA,QACR,MAAM0G;AAAA,QACN,eAAiB/H,EAAAL,CAAA,EAAa;AAAA,QAC9B,gBAAkBK,EAAAL,CAAA,EAAa;AAAA,QAC/B,OAAOK,EAAAL,CAAA,EAAa;AAAA,QACpB,QAASK,EAAAL,CAAA,EAAa;AAAA,QACtB,cAAeK,EAAAL,CAAA;AAAA,QACf,cAAiBK,EAAAL,CAAA,EAAa;AAAA,QAC9B,QAAQK,EAAAL,CAAA,EAAa;AAAA,QACrB,SAAUK,EAAAL,CAAA,EAAa;AAAA,QACvB,cAAeK,EAAAL,CAAA,EAAa;AAAA;MAKvB0I,EAAA,cADVtI,EAGEiC,IAAA;AAAA;QADG,OAAOqG,EAAA;AAAA;;;;;;AChMhB,UAAM/D,IAAQ8C,GAAQ;2BAIlBqB,EAqBS,UAAA;AAAA,MApBL,MAAK;AAAA,MACL,OAAM;AAAA,MACL,SAAKtI,EAAA,CAAA,MAAAA,EAAA,CAAA,IAAA,CAAAY,MAAEf,EAAAsE,CAAA,EAAM,MAAK;AAAA;MAEnBoE,EAAkC,QAAA,EAA5B,OAAM,UAAS,GAAC,SAAK,EAAA;AAAA,MAC3BA,EAcM,OAAA;AAAA,QAbF,OAAM;AAAA,QACN,OAAM;AAAA,QACN,MAAK;AAAA,QACL,SAAQ;AAAA,QACR,gBAAa;AAAA,QACb,QAAO;AAAA,QACP,eAAY;AAAA;QAEZA,EAIQ,QAAA;AAAA,UAHJ,kBAAe;AAAA,UACf,mBAAgB;AAAA,UAChB,GAAE;AAAA;;;;;;;;;;;;;;;;;8CCrBLC,KAA0C;AAAA,EACnD,IAAI;AAAA,EACJ,IAAI;AAAA,EACJ,IAAI;AAAA,EACJ,IAAI;AAAA,EACJ,OAAO;AAAA,EACP,OAAO;AAAA,EACP,OAAO;AAAA,EACP,OAAO;AAAA,EACP,OAAO;AAAA,EACP,OAAO;AACX,GAEaC,KAAkB;AAExB,SAASC,GAAiBC,GAA0B;AACvD,SAAOH,GAAgBG,CAAQ,KAAKH,GAAgBC,EAAe;AACvE;;;;;;;;;;;;;;;;;ACfA,UAAMrJ,IAAQC,GAORuI,IAAOD,GAEPiB,IAAU5G,EAAI,EAAK,GACnB6G,IAAY7G,EAAI,EAAK,GACrB8G,IAAa9G,EAAI,IAAI,GACrB+G,IAAY/G,EAAI,IAAI;AAE1B,QAAIgH,IAAmB,MACnBC,IAAmB;AAEvB,UAAMC,IAAgBzJ,EAAS,MAAMiJ,GAAiBtJ,EAAM,OAAO,QAAQ,CAAC;AAI5E,aAAS+J,IAAiB;AACtB,MAAI/J,EAAM,mBACN,CAAC0J,EAAW,SAAS,CAAC1J,EAAM,aAAa,gBACzC4J,MAEJA,IAAmBI,GAAgBN,EAAW,OAAO;AAAA,QACjD,cAAc;AAAA,QACd,aAAa;AAAA,MACrB,CAAK;AAAA,IACL;AAEA,aAASO,IAAoB;AACzB,MAAIL,MACAA,EAAgB,GAChBA,IAAmB;AAAA,IAE3B;AAEA,aAASM,IAAiB;;AACtB,MAAIlK,EAAM,mBACN6J,MACAtJ,IAAAP,EAAM,WAAN,QAAAO,EAAc,oBAElBsJ,IAAmBM,GAAY,MAAM;AACjC,QAAInK,EAAM,aAAa,gBACnBA,EAAM,aAAa,MAAK;AAAA,MAEhC,CAAC;AAAA,IACL;AAEA,aAASoK,IAAoB;AACzB,MAAIP,MACAA,EAAgB,GAChBA,IAAmB;AAAA,IAE3B;AAEA,aAASQ,EAAmBxJ,GAAO;;AAC/B,MAAIb,EAAM,mBACLA,EAAM,aAAa,kBACpBO,IAAAP,EAAM,WAAN,QAAAO,EAAc,qBACdqB,IAAA5B,EAAM,WAAN,gBAAA4B,EAAc,yBAAwB,MACrC8H,EAAW,UAEXA,EAAW,MAAM,SAAS7I,EAAM,MAAM,KACvCb,EAAM,aAAa,MAAK;AAAA,IAEhC;AAEA,aAASsK,IAAe;AACpB,MAAAd,EAAQ,QAAQ,IAChBO,EAAc;AAAA,IAClB;AAEA,aAASxD,IAAe;AACpB,MAAAiC,EAAK,aAAa,GAClBxI,EAAM,aAAa,WAAU;AAAA,IACjC;AAIA,aAASuK,EAAa1J,GAAO;;AACzB,MAAAA,EAAM,eAAc,GAChBb,EAAM,aAAa,gBAAgB,GAACO,IAAAP,EAAM,WAAN,QAAAO,EAAc,oBAClDP,EAAM,aAAa,MAAK;AAAA,IAEhC;AAEA,aAASwK,EAAkB3J,GAAO;;AAC9B,MAAIA,EAAM,WAAW8I,EAAU,SACvB3J,EAAM,aAAa,gBAAgB,GAACO,IAAAP,EAAM,WAAN,QAAAO,EAAc,sBAAmBqB,IAAA5B,EAAM,WAAN,gBAAA4B,EAAc,yBAAwB,MAC3G5B,EAAM,aAAa,MAAK;AAAA,IAGpC;AAEA,aAASyK,IAAa;AAClB,MAAId,EAAU,SAAS,CAACA,EAAU,MAAM,SACpCA,EAAU,MAAM,UAAS,GACzBtC,GAAS,MAAM;AACX,8BAAsB,MAAM;AACxB,UAAAmC,EAAQ,QAAQ;AAAA,QACpB,CAAC;AAAA,MACL,CAAC;AAAA,IAET;AAEA,aAASkB,IAAc;AACnB,MAAIf,EAAU,SAASA,EAAU,MAAM,SACnCF,EAAU,QAAQ,IAClBD,EAAQ,QAAQ,IAChB,WAAW,MAAM;AACb,QAAIG,EAAU,SACVA,EAAU,MAAM,MAAK,GAEzBF,EAAU,QAAQ,IAClBjB,EAAK,aAAa,GAClBxI,EAAM,aAAa,WAAU;AAAA,MACjC,GAAG,GAAG;AAAA,IAEd;AAIA,WAAAkC,EAAU,MAAM;AACZ,MAAIlC,EAAM,kBACFA,EAAM,aAAa,UACnByK,EAAU,IAGdP,EAAc;AAAA,IAEtB,CAAC,GAED5I,EAAY,MAAM;;AACd,MAAItB,EAAM,mBACFO,IAAAoJ,EAAU,UAAV,QAAApJ,EAAiB,QACjBoJ,EAAU,MAAM,MAAK,KAGzBM,EAAiB,GACjBG,EAAiB;AAAA,IAEzB,CAAC,GAEDjI;AAAA,MACI,MAAMnC,EAAM,aAAa;AAAA,MACzB,CAAC2K,MAAU;AACP,QAAI3K,EAAM,oBAEN2K,KACAT,EAAc,GACVV,EAAQ,SACRO,EAAc,MAGlBE,EAAiB,GACjBG,EAAiB;AAAA,MAEzB;AAAA,IACJ,GAEAjI;AAAA,MACI,MAAMnC,EAAM,aAAa;AAAA,MACzB,CAAC4I,MAAW;AACR,QAAK5I,EAAM,oBAEP4I,IACA6B,EAAU,IACFhB,EAAU,SAClBiB,EAAW;AAAA,MAEnB;AAAA,IACJ,aAMczK,EAAA,wBADViJ,EAkDS,UAAA;AAAA;eAhDD;AAAA,MAAJ,KAAIS;AAAA,MACH,OAAKiB,EAAA;AAAA;;;QAA4NpB,EAAA,QAAO,yBAAA;AAAA,SAA+DvJ,EAAA,gBAAY;AAAA;MAOnT,UAAQsK;AAAA,MACR,SAAOC;AAAA;MAERrB,EAoCM,OApCN0B,IAoCM;AAAA,QAnCF1B,EAkCM,OAAA;AAAA,UAjCF,UAAM,sDAAoD;AAAA,YACb,eAAAlJ,EAAA,OAAO,aAAQ;AAAA,YAAgD,gBAAAA,EAAA,OAAO,aAAQ;AAAA,YAAgD,aAAAA,EAAA,OAAO,aAAQ;AAAA;;UAM1LkJ,EAyBM,OAAA;AAAA,YAxBD,OAAKyB,EAAA;AAAA;cAAmH3K,EAAA,aAAa,eAAY,KAAA;AAAA,cAA2CuJ,EAAA,UAAYC,EAAA,QAAS,2CAAA;AAAA,cAA8HK,EAAA;AAAA;;YAOhVX,EAgBM,OAAA;AAAA,cAfF,OAAKyB,EAAA,CAAC,6BAA2B,CAExB3K,EAAA,OAAO,gBAAgBA,EAAA,OAAO,YAAY,CAAA,CAAA;AAAA,cADlD,gCAA8BuJ,EAAA;AAAA;cAIrBvJ,EAAA,OAAO,eADjB6K,KAAA5B,EAKM,OALN6B,IAKM;AAAA,gBADFC,EAAeC,EAAA;AAAA;cAGnB1I,EAGEC,EAAA,QAAA,WAAA;AAAA,gBAFG,cAAevC,EAAA;AAAA,gBACf,QAAQA,EAAA;AAAA;;;;;oBASjCiJ,EAsDM,OAAA;AAAA;MApDF,OAAM;AAAA,MACL,eAAgBmB,GAAkB,CAAA,MAAA,CAAA;AAAA;MAEnClB,EAgDM,OAAA;AAAA,QA/CF,UAAM,sDAAoD;AAAA,UACjB,eAAAlJ,EAAA,OAAO,aAAQ;AAAA,UAA4C,gBAAAA,EAAA,OAAO,aAAQ;AAAA,UAA4C,aAAAA,EAAA,OAAO,aAAQ;AAAA;QAK7K,eAAgBoK,GAAkB,CAAA,MAAA,CAAA;AAAA;QAEnCW,EAsCaE,IAAA;AAAA,UArCT,QAAA;AAAA,UACA,sBAAmB;AAAA,UACnB,oBAAiB;AAAA,UACjB,kBAAe;AAAA,UACf,sBAAmB;AAAA,UACnB,oBAAiB;AAAA,UACjB,kBAAe;AAAA,UACd,cAAaZ;AAAA,UACb,cAAa/D;AAAA;qBAEd,MA0BM;AAAA,YAzBItG,EAAA,aAAa,eADvBiJ,EA0BM,OAAA;AAAA;uBAxBE;AAAA,cAAJ,KAAIQ;AAAA,cACJ,MAAK;AAAA,cACL,cAAW;AAAA,cACV,OAAKkB,EAAA,CAAA,2BAA8B3K,EAAA,aAAa,+BAA+B6J,EAAA,KAAa,CAAA;AAAA;cAE7FlJ,EAAA,CAAA,MAAAA,EAAA,CAAA,IAAAuI,EAAmC,QAAA,EAA7B,OAAM,UAAS,GAAC,UAAM,EAAA;AAAA,cAE5BA,EAgBM,OAAA;AAAA,gBAfF,OAAKyB,EAAA,CAAC,6BAA2B,CAExB3K,EAAA,OAAO,gBAAgBA,EAAA,OAAO,YAAY,CAAA,CAAA;AAAA,gBADlD,gCAA8BuJ,EAAA;AAAA;gBAIrBvJ,EAAA,OAAO,eADjB6K,KAAA5B,EAKM,OALNiC,IAKM;AAAA,kBADFH,EAAeC,EAAA;AAAA;gBAGnB1I,EAGEC,EAAA,QAAA,WAAA;AAAA,kBAFG,cAAevC,EAAA;AAAA,kBACf,QAAQA,EAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;ACxRrC,UAAMD,IAAQC,GAORuI,IAAOD,GAEPiB,IAAU5G,EAAI,EAAK,GACnB6G,IAAY7G,EAAI,EAAK,GACrB8G,IAAa9G,EAAI,IAAI,GACrB+G,IAAY/G,EAAI,IAAI;AAE1B,QAAIgH,IAAmB,MACnBC,IAAmB;AAEvB,UAAMC,IAAgBzJ,EAAS,MAAMiJ,GAAiBtJ,EAAM,OAAO,QAAQ,CAAC,GAGtEoL,IAAqB/K,EAAS,MAAOL,EAAM,OAAO,aAAa,SAAS,sBAAsB,kBAAmB;AAIvH,aAAS+J,IAAiB;AACtB,MAAI/J,EAAM,mBACN,CAAC0J,EAAW,SAAS,CAAC1J,EAAM,aAAa,gBACzC4J,MAEJA,IAAmBI,GAAgBN,EAAW,OAAO;AAAA,QACjD,cAAc;AAAA,QACd,aAAa;AAAA,MACrB,CAAK;AAAA,IACL;AAEA,aAASO,IAAoB;AACzB,MAAIL,MACAA,EAAgB,GAChBA,IAAmB;AAAA,IAE3B;AAEA,aAASM,IAAiB;;AACtB,MAAIlK,EAAM,mBACN6J,MACAtJ,IAAAP,EAAM,WAAN,QAAAO,EAAc,oBAElBsJ,IAAmBM,GAAY,MAAM;AACjC,QAAInK,EAAM,aAAa,gBACnBA,EAAM,aAAa,MAAK;AAAA,MAEhC,CAAC;AAAA,IACL;AAEA,aAASoK,IAAoB;AACzB,MAAIP,MACAA,EAAgB,GAChBA,IAAmB;AAAA,IAE3B;AAEA,aAASQ,EAAmBxJ,GAAO;;AAC/B,MAAIb,EAAM,mBACLA,EAAM,aAAa,kBACpBO,IAAAP,EAAM,WAAN,QAAAO,EAAc,qBACdqB,IAAA5B,EAAM,WAAN,gBAAA4B,EAAc,yBAAwB,MACrC8H,EAAW,UAEXA,EAAW,MAAM,SAAS7I,EAAM,MAAM,KACvCb,EAAM,aAAa,MAAK;AAAA,IAEhC;AAEA,aAASsK,IAAe;AACpB,MAAAd,EAAQ,QAAQ,IAChBO,EAAc;AAAA,IAClB;AAEA,aAASxD,IAAe;AACpB,MAAAiC,EAAK,aAAa,GAClBxI,EAAM,aAAa,WAAU;AAAA,IACjC;AAIA,aAASuK,EAAa1J,GAAO;;AACzB,MAAAA,EAAM,eAAc,GAChBb,EAAM,aAAa,gBAAgB,GAACO,IAAAP,EAAM,WAAN,QAAAO,EAAc,oBAClDP,EAAM,aAAa,MAAK;AAAA,IAEhC;AAEA,aAASwK,EAAkB3J,GAAO;;AAC9B,MAAIA,EAAM,WAAW8I,EAAU,SACvB3J,EAAM,aAAa,gBAAgB,GAACO,IAAAP,EAAM,WAAN,QAAAO,EAAc,sBAAmBqB,IAAA5B,EAAM,WAAN,gBAAA4B,EAAc,yBAAwB,MAC3G5B,EAAM,aAAa,MAAK;AAAA,IAGpC;AAEA,aAASyK,IAAa;AAClB,MAAId,EAAU,SAAS,CAACA,EAAU,MAAM,SACpCA,EAAU,MAAM,UAAS,GACzBtC,GAAS,MAAM;AACX,8BAAsB,MAAM;AACxB,UAAAmC,EAAQ,QAAQ;AAAA,QACpB,CAAC;AAAA,MACL,CAAC;AAAA,IAET;AAEA,aAASkB,IAAc;AACnB,MAAIf,EAAU,SAASA,EAAU,MAAM,SACnCF,EAAU,QAAQ,IAClBD,EAAQ,QAAQ,IAChB,WAAW,MAAM;AACb,QAAIG,EAAU,SACVA,EAAU,MAAM,MAAK,GAEzBF,EAAU,QAAQ,IAClBjB,EAAK,aAAa,GAClBxI,EAAM,aAAa,WAAU;AAAA,MACjC,GAAG,GAAG;AAAA,IAEd;AAIA,WAAAkC,EAAU,MAAM;AACZ,MAAIlC,EAAM,kBACFA,EAAM,aAAa,UACnByK,EAAU,IAGdP,EAAc;AAAA,IAEtB,CAAC,GAED5I,EAAY,MAAM;;AACd,MAAItB,EAAM,mBACFO,IAAAoJ,EAAU,UAAV,QAAApJ,EAAiB,QACjBoJ,EAAU,MAAM,MAAK,KAGzBM,EAAiB,GACjBG,EAAiB;AAAA,IAEzB,CAAC,GAEDjI;AAAA,MACI,MAAMnC,EAAM,aAAa;AAAA,MACzB,CAAC2K,MAAU;AACP,QAAI3K,EAAM,oBAEN2K,KACAT,EAAc,GACVV,EAAQ,SACRO,EAAc,MAGlBE,EAAiB,GACjBG,EAAiB;AAAA,MAEzB;AAAA,IACJ,GAEAjI;AAAA,MACI,MAAMnC,EAAM,aAAa;AAAA,MACzB,CAAC4I,MAAW;AACR,QAAK5I,EAAM,oBAEP4I,IACA6B,EAAU,IACFhB,EAAU,SAClBiB,EAAW;AAAA,MAEnB;AAAA,IACJ,aAMczK,EAAA,wBADViJ,EAqDS,UAAA;AAAA;eAnDD;AAAA,MAAJ,KAAIS;AAAA,MACH,OAAKiB,EAAA;AAAA;;;QAAgOpB,EAAA,QAAO,yBAAA;AAAA,SAA+DvJ,EAAA,gBAAY;AAAA;MAOvT,UAAQsK;AAAA,MACR,SAAOC;AAAA;MAERrB,EAuCM,OAvCN0B,IAuCM;AAAA,QAtCF1B,EAqCM,OAAA;AAAA,UApCF,UAAM,wDAAsD;AAAA,YACG,iCAAAlJ,EAAA,OAAO,aAAQ;AAAA,YAAkE,iCAAAA,EAAA,OAAO,aAAQ;AAAA;;UAK/JkJ,EA6BM,OAAA;AAAA,YA5BD,OAAKyB,EAAA;AAAA;cAAuH3K,EAAA,aAAa,eAAY,KAAA;AAAA,cAA2CuJ,EAAA,UAAYC,EAAA,sCAAkGxJ,EAAA,OAAO,aAAQ;cAAgK6J,EAAA;AAAA;;YAW9dX,EAgBM,OAAA;AAAA,cAfF,OAAKyB,EAAA,CAAC,iCAA+B,CAE5B3K,EAAA,OAAO,gBAAgBA,EAAA,OAAO,YAAY,CAAA,CAAA;AAAA,cADlD,gCAA8BuJ,EAAA;AAAA;cAIrBvJ,EAAA,OAAO,eADjB6K,KAAA5B,EAKM,OALN6B,IAKM;AAAA,gBADFC,EAAeC,EAAA;AAAA;cAGnB1I,EAGEC,EAAA,QAAA,WAAA;AAAA,gBAFG,cAAevC,EAAA;AAAA,gBACf,QAAQA,EAAA;AAAA;;;;;oBASjCiJ,EAqDM,OAAA;AAAA;MAnDF,OAAM;AAAA,MACL,eAAgBmB,GAAkB,CAAA,MAAA,CAAA;AAAA;MAEnClB,EA+CM,OAAA;AAAA,QA9CF,UAAM,wDAAsD;AAAA,UACD,iCAAAlJ,EAAA,OAAO,aAAQ;AAAA,UAA8D,iCAAAA,EAAA,OAAO,aAAQ;AAAA;QAItJ,eAAgBoK,GAAkB,CAAA,MAAA,CAAA;AAAA;QAEnCW,EAsCaE,IAAA;AAAA,UArCT,QAAA;AAAA,UACA,sBAAmB;AAAA,UAClB,mCAAiCE,EAAA;AAAA,UAClC,kBAAe;AAAA,UACf,sBAAmB;AAAA,UACnB,oBAAiB;AAAA,UAChB,iCAA+BA,EAAA;AAAA,UAC/B,cAAad;AAAA,UACb,cAAa/D;AAAA;qBAEd,MA0BM;AAAA,YAzBItG,EAAA,aAAa,eADvBiJ,EA0BM,OAAA;AAAA;uBAxBE;AAAA,cAAJ,KAAIQ;AAAA,cACJ,MAAK;AAAA,cACL,cAAW;AAAA,cACV,OAAKkB,EAAA,CAAA,+BAAkC3K,EAAA,aAAa,+BAA+B6J,EAAA,KAAa,CAAA;AAAA;cAEjGlJ,EAAA,CAAA,MAAAA,EAAA,CAAA,IAAAuI,EAAmC,QAAA,EAA7B,OAAM,UAAS,GAAC,UAAM,EAAA;AAAA,cAE5BA,EAgBM,OAAA;AAAA,gBAfF,OAAKyB,EAAA,CAAC,iCAA+B,CAE5B3K,EAAA,OAAO,gBAAgBA,EAAA,OAAO,YAAY,CAAA,CAAA;AAAA,gBADlD,gCAA8BuJ,EAAA;AAAA;gBAIrBvJ,EAAA,OAAO,eADjB6K,KAAA5B,EAKM,OALNiC,IAKM;AAAA,kBADFH,EAAeC,EAAA;AAAA;gBAGnB1I,EAGEC,EAAA,QAAA,WAAA;AAAA,kBAFG,cAAevC,EAAA;AAAA,kBACf,QAAQA,EAAA;AAAA;;;;;;;;;;;;;;;;AC3RrC,UAAM8E,IAAQnC,EAAI,IAAI,GAChByI,IAAWzI,EAAI,EAAK,GAEpB0F,IAAQC;AAEd,IAAAE,EAAa;AAAA,MACT,YAAY,MAAA;;AAAM,gBAAAlI,IAAAwE,EAAM,UAAN,gBAAAxE,EAAa;AAAA;AAAA,MAC/B,OAAO,MAAA;;AAAM,gBAAAA,IAAAwE,EAAM,UAAN,gBAAAxE,EAAa;AAAA;AAAA,MAC1B,MAAM,IAAIO,MAAI;;AAAK,gBAAAP,IAAAwE,EAAM,UAAN,gBAAAxE,EAAa,KAAK,GAAGO;AAAA;AAAA,MACxC,eAAe,MAAA;;AAAM,gBAAAP,IAAAwE,EAAM,UAAN,gBAAAxE,EAAa;AAAA;AAAA,MAClC,gBAAgB,MAAA;;AAAM,gBAAAA,IAAAwE,EAAM,UAAN,gBAAAxE,EAAa;AAAA;AAAA,MACnC,QAAQ,IAAIO,MAAI;;AAAK,gBAAAP,IAAAwE,EAAM,UAAN,gBAAAxE,EAAa,OAAO,GAAGO;AAAA;AAAA,MAC5C,SAAS,IAAIA,MAAI;;AAAK,gBAAAP,IAAAwE,EAAM,UAAN,gBAAAxE,EAAa,QAAQ,GAAGO;AAAA;AAAA,MAE9C,IAAI,SAAS;;AACT,gBAAOP,IAAAwE,EAAM,UAAN,gBAAAxE,EAAa;AAAA,MACxB;AAAA,MACA,IAAI,KAAK;;AACL,gBAAOA,IAAAwE,EAAM,UAAN,gBAAAxE,EAAa;AAAA,MACxB;AAAA,MACA,IAAI,QAAQ;;AACR,gBAAOA,IAAAwE,EAAM,UAAN,gBAAAxE,EAAa;AAAA,MACxB;AAAA,MACA,IAAI,SAAS;;AACT,gBAAOA,IAAAwE,EAAM,UAAN,gBAAAxE,EAAa;AAAA,MACxB;AAAA,MACA,IAAI,eAAe;;AACf,gBAAOA,IAAAwE,EAAM,UAAN,gBAAAxE,EAAa;AAAA,MACxB;AAAA,MACA,IAAI,eAAe;;AACf,gBAAOA,IAAAwE,EAAM,UAAN,gBAAAxE,EAAa;AAAA,MACxB;AAAA,MACA,IAAI,eAAe;;AACf,gBAAOA,IAAAwE,EAAM,UAAN,gBAAAxE,EAAa;AAAA,MACxB;AAAA,IACJ,CAAC;AAGD,QAAI+K,IAAoB,MACpBC,IAAoB;AAExB,IAAArJ,EAAU,MAAM;;AAGZ,OAAI3B,IAAAwE,EAAM,UAAN,QAAAxE,EAAa,UAAU,CAAC+K,MACxBA,IAAoBE,GAAU,GAC9BD,IAAoBE,GAAe,MAAM;AAAA,IAEjD,CAAC,GAEDnK,EAAY,MAAM;AACd,MAAAgK,KAAA,QAAAA,KACAC,KAAA,QAAAA;AAAA,IACJ,CAAC;AAGD,aAASG,IAAiB;AACtB,MAAApD,EAAM,SAAS,GACVgD,MACDA,IAAoBE,GAAU,GAC9BD,IAAoBE,GAAe,MAAM;AAAA,IAEjD;AAEA,aAASE,IAAe;AACpB,MAAArD,EAAM,OAAO,GACbgD,KAAA,QAAAA,KACAC,KAAA,QAAAA,KACAD,IAAoB,MACpBC,IAAoB;AAAA,IACxB;AAEA,UAAMK,IAAkBvL,EAAS,MAAMjB,GAAU,iBAAiB,CAAC;2BAI/DoB,EA+EgBqL,IAAA;AAAA,eA9ER;AAAA,MAAJ,KAAI9G;AAAA,MAkBH,WAAS2G;AAAA,MACT,SAAOC;AAAA,MACP,gCAAOrD,EAAK,OAAA;AAAA,MACZ,+BAAMA,EAAK,MAAA;AAAA;iBAEZ,CAsDW;AAAA,QA5EW,YAAA1D;AAAA,QAAwB,OAAAkH;AAAA,QAAmB,QAAAhK;AAAA,QAAoB,MAAA0G;AAAA,QAAkB,eAAAuD;AAAA,QAA2B,gBAAAC;AAAA,QAA4B,IAAAC;AAAA,QAAgB,OAAAnH;AAAA,QAAmB,QAAA8D;AAAA,QAAoB,cAAAxI;AAAA,QAA0B,cAAAsI;AAAA,QAA0B,QAAAwD;AAAA,QAAoB,SAAAC;AAAA,QAAqB,cAAAC;AAAA,WAA6BpM;AAAA;cAsB/UQ,EAsDW6L,IAAA,EAtDD,IAAG,OAAM,GAAA;AAAA,UACflD,EAoDM,OAAA;AAAA,YAnDD,2BAAyB8C;AAAA,YACzB,8BAA4BnH;AAAA,YAC7B,OAAM;AAAA,YACL,gBAAc4D;AAAA;YAKL5D,YAAgB8G,EAAA,cAD1BpL,EAea0K,IAAA;AAAA;cAbR,SAASG,EAAA;AAAA,cACV,sBAAmB;AAAA,cACnB,oBAAiB;AAAA,cACjB,kBAAe;AAAA,cACf,sBAAmB;AAAA,cACnB,oBAAiB;AAAA,cACjB,kBAAe;AAAA,cACd,uCAAcA,EAAA,QAAQ;AAAA;yBAEvB,MAGE;AAAA,gBAFQzC,KADVkC,KAAA5B,EAGE,OAHFoD,EAGE;;;;aAINxB,EAAA,GAAAtK,EAyBY+L,GAxBHzK,KAAA,QAAAA,EAAQ,YAAY0K,KAAmBC,EAAY,GAAA;AAAA,cACvD,iBAAerM;AAAA,cACf,QAAQ0B;AAAA,cACR,qBAAmB8J,EAAA;AAAA,cACnB,kBAAgB9G,MAAK;AAAA,cACrB,sCAAa4H,EAAAA,MAAK,aAAA;AAAA;yBAEnB,MAgBE;AAAA,gBAhBFnK,EAgBEC,EAAA,QAAA,WAhBF9B,GAgBEV,IAfe;AAAA,kBACZ,IAAIiM;AAAA,kBACJ,YAAarH;AAAA,kBACb,OAAOkH;AAAA,kBACP,QAAQhK;AAAA,kBACR,MAAM0G;AAAA,kBACN,eAAiBuD;AAAA,kBACjB,gBAAkBC;AAAA,kBAClB,OAAOlH;AAAA,kBACP,QAAS8D;AAAA,kBACT,cAAexI;AAAA,kBACf,cAAiBsI;AAAA,kBACjB,QAAQwD;AAAA,kBACR,SAAUC;AAAA,kBACV,cAAeC;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACxJxC,UAAMpM,IAAQC,GAiFR0M,IAAU/J,EAAI,EAAK,GACnB1C,IAAaC,EAAa,GAC1BC,IAAewC,EAAI,IAAI;AAE7B,IAAAtC,GAAQ,gBAAgBF,CAAY;AAEpC,UAAMoI,IAAOD,GACPqE,IAAYhK,EAAI,EAAK,GAErBiK,IAAiBxM,EAAS,MACrBL,EAAM,YAAYZ,GAAU,UAAU,CAChD,GAGK0N,IAAelK,EAAI,IAAI,GAEvBmK,IAAgB1M,EAAS,MACvBL,EAAM,aAAa,KACZ,CAAC,OAAO,IAEfA,EAAM,aAAa,KACZ,CAAA,IAEP,MAAM,QAAQA,EAAM,QAAQ,IACrBA,EAAM,WAEV,CAACA,EAAM,QAAQ,CACzB;AAED,aAASgN,IAAa;AAClBC,MAAAA,GAAcjN,EAAM,MAAM;AAAA,QACtB,QAAQA,EAAM;AAAA,QACd,MAAMA,EAAM;AAAA,QACZ,SAASA,EAAM;AAAA,QACf,wBAAwBA,EAAM;AAAA,QAC9B,UAAUA,EAAM;AAAA,QAChB,eAAe,MAAMwI,EAAK,aAAa;AAAA,QACvC,cAAc,MAAMA,EAAK,YAAY;AAAA,MAC7C,CAAK;AAAA,IACL;AAEA,aAAS0E,IAAe;AACpB,MAAKH,EAAc,MAAM,SAAS,OAAO,MAEzCD,EAAa,QAAQ,WAAW,MAAM;AAClC,QAAAE,EAAU;AAAA,MACd,GAAG,EAAE;AAAA,IACT;AAEA,aAASG,IAAe;AACpB,MAAIL,EAAa,UACb,aAAaA,EAAa,KAAK,GAC/BA,EAAa,QAAQ;AAAA,IAE7B;AAEA,aAASM,EAAYvM,GAAO;AACxB,MAAKkM,EAAc,MAAM,SAAS,OAAO,KACrClM,EAAM,WAAW,KAErBmM,EAAU;AAAA,IACd;AAEA,IAAA9K,EAAU,MAAM;AACZ,MAAI6K,EAAc,MAAM,SAAS,OAAO,KACpCC,EAAU;AAAA,IAElB,CAAC,GAED7K;AAAA,MACI,MAAA;;AAAM,gBAAA5B,IAAAH,EAAa,UAAb,gBAAAG,EAAoB;AAAA;AAAA,MAC1B,CAACmI,MAAiB;AACd,QAAItI,EAAa,UACTsI,KAAgBkE,EAAU,QAC1BpE,EAAK,OAAO,IACJE,KACRF,EAAK,MAAM,GAGfoE,EAAU,QAAQ,CAAClE;AAAA,MAE3B;AAAA,IACJ;AAEA,UAAMN,IAA4BxF,EAAI,IAAI;AAE1C,IAAAuF,GAAgB,MAAM;;AAClB,OAAA5H,IAAA6H,EAA0B,UAA1B,QAAA7H,EAAA,KAAA6H,IACI0E,EAAa,SACb,aAAaA,EAAa,KAAK;AAAA,IAEvC,CAAC;AAED,UAAMvH,IAAS8C,GAAQ;AAEvB,aAASH,IAAyB;AAC9B,MAAAE,EAA0B,QAAQhI,EAAa,MAAM,gCAAgCmF,CAAM;AAAA,IAC/F;AAEA,IAAApD,EAAM/B,GAAc,CAACxB,GAAOyO,MAAa;AACrC,MAAIzO,KAAS,CAACyO,MACVnF,EAAsB,GACtBM,EAAK,SAAS;AAAA,IAEtB,CAAC;AAED,aAAS7D,IAAU;AACf,MAAA6D,EAAK,OAAO;AAAA,IAChB;AAEA,aAASjC,IAAe;AACpB,MAAAnG,EAAa,QAAQ,MACrBoI,EAAK,aAAa;AAAA,IACtB;AAEA,aAAS8E,IAAS;AACd,MAAIX,EAAQ,UAIP3M,EAAM,KAAK,WAAW,GAAG,MAC1B2M,EAAQ,QAAQ,IAChBnE,EAAK,OAAO,IAGhBtI,EACK;AAAA,QACGF,EAAM;AAAA,QACNA,EAAM;AAAA,QACNA,EAAM;AAAA,QACNA,EAAM;AAAA,QACNuN,GAAiB5M,GAAKX,GAAOsH,EAAc,CAAC;AAAA,QAC5C3C;AAAA,QACA4B;AAAA,QACAvG,EAAM;AAAA,QACN6M,EAAe;AAAA,MAC3B,EACS,KAAK,CAAC5E,MAAY;AACf,QAAA7H,EAAa,QAAQ6H;AAAA,MACzB,CAAC,EACA,MAAM,CAACrC,MAAU4C,EAAK,SAAS5C,CAAK,CAAC,EACrC,QAAQ,MAAO+G,EAAQ,QAAQ,EAAM;AAAA,IAC9C;sBAII7B,EAAA,GAAAtK,EAUY+L,GARHtM,EAAA,EAAE,GAFXS,GACYD,EASA8E,CAAA,GATM;AAAA,MAEb,MAAMtF,EAAA;AAAA,MACN,WAAeqN,GAAM,CAAA,SAAA,CAAA;AAAA,MACrB,cAAYJ;AAAA,MACZ,cAAYC;AAAA,MACZ,aAAWC;AAAA;iBAEZ,MAA2B;AAAA,QAA3B7K,EAA2BC,EAAA,QAAA,WAAA,EAApB,SAASmK,EAAA,MAAO,CAAA;AAAA;;;;;;;;;;;;;;AC9O/B,UAAM3M,IAAQC,GAQRG,IAAe2H,GAAO,cAAc;AAE1C,QAAI,CAAC3H;AACD,YAAM,IAAI,MAAM,0DAA0D;AAG9E,UAAMoN,IAAS5K,EAAI,EAAK,GAClB6K,IAAW7K,EAAI,EAAK,GACpB8K,IAAc9K,EAAI,IAAI;AAC5B,QAAI+K,IAAW;AAEf,UAAMC,IAAkB,MAAM;AAC1B,UAAI5N,EAAM;AACN,eAAO,EAAE,MAAM,MAAM,QAAQA,EAAM,IAAI,IAAIA,EAAM,OAAO,CAACA,EAAM,IAAI,EAAC;AAGxE,UAAI,CAACA,EAAM;AACP,cAAM,IAAI,MAAM,oDAAoD;AAGxE,aAAOA,EAAM;AAAA,IACjB;AA2CA,WAAAkC,EAzCuB,MAAM;AACzB,MAAKwL,EAAY,UAIjBC,IAAW,IAAI;AAAA,QACX,CAACE,MAAY;AAST,cARI,CAACA,EAAQ,CAAC,EAAE,mBAIX7N,EAAM,UACP2N,EAAS,WAAU,GAGnBF,EAAS;AACT;AAGJ,UAAAA,EAAS,QAAQ;AACjB,gBAAMK,IAAeF,EAAe;AAEpC,UAAAxN,EAAa,MAAM,OAAO;AAAA,YACtB,GAAG0N;AAAA,YACH,SAAS,MAAM;;AACX,cAAAL,EAAS,QAAQ,KACjBlN,IAAAuN,EAAa,YAAb,QAAAvN,EAAA,KAAAuN;AAAA,YACJ;AAAA,YACA,UAAU,MAAM;;AACZ,cAAAN,EAAO,QAAQ,IACfC,EAAS,QAAQ,KACjBlN,IAAAuN,EAAa,aAAb,QAAAvN,EAAA,KAAAuN;AAAA,YACJ;AAAA,UAChB,CAAa;AAAA,QACL;AAAA,QACA,EAAE,YAAY,GAAG9N,EAAM,MAAM,KAAI;AAAA,MACzC,GAEI2N,EAAS,QAAQD,EAAY,KAAK;AAAA,IACtC,CAEwB,GACxBpM,EAAY,MAAMqM,KAAA,gBAAAA,EAAU,YAAY,mBAIpCnN,EASY+L,GARHvM,EAAM,EAAE,GAAA;AAAA,eACT;AAAA,MAAJ,KAAI0N;AAAA;iBAEJ,MAA2B;AAAA,QAAfF,EAAA,QAAZjL,EAA2BC,EAAA,QAAA,WAAA,EAAA,KAAA,EAAA,CAAA,IAC3BD,EAGQC,EAAA,QAAA,YAAA,EAAA,KAAA,EAAA,CAAA;AAAA;;;;;AC5EhB,SAASuL,GAAW7K,GAAaU,IAAwB,IAAyB;AAC9E,SAAOzD,IACF;AAAA,IACG+C;AAAA,IACAU,EAAQ,UAAU;AAAA,IAClBA,EAAQ,QAAQ,CAAA;AAAA,IAChBA,EAAQ,WAAW,CAAA;AAAA,IACnBA,EAAQ,UAAU,CAAA;AAAA,IAClBA,EAAQ;AAAA,IACRA,EAAQ;AAAA,IACRA,EAAQ,0BAA0B;AAAA,IAClCA,EAAQ,YAAaxE,GAAU,UAAU;AAAA,IACzCwE,EAAQ;AAAA,IACRA,EAAQ;AAAA,IACRA,EAAQ;AAAA,IACRA,EAAQ,SAAS;AAAA,EAAA,EAEpB,KAAK,CAACmB,MAAU;AACb,UAAMiJ,IAAYpK,EAAQ,aAAa,CAAA;AAEvC,kBAAO,KAAKoK,CAAS,EAAE,QAAQ,CAACnN,MAAU;AAEtC,YAAM4E,IAAYJ,EAAUxE,CAAK;AACjC,MAAAkE,EAAM,GAAGU,GAAWuI,EAAUnN,CAAK,CAAC;AAAA,IACxC,CAAC,GAEMkE;AAAA,EACX,CAAC;AACT;"}