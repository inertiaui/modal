(function(k,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue"),require("@inertiaui/vanilla"),require("@inertiajs/vue3"),require("@inertiajs/core"),require("axios")):typeof define=="function"&&define.amd?define(["exports","vue","@inertiaui/vanilla","@inertiajs/vue3","@inertiajs/core","axios"],e):(k=typeof globalThis<"u"?globalThis:k||self,e(k.InertiaUIModal={},k.Vue,k.InertiaUIVanilla,k.InertiaVue3,k.InertiaCore,k.axios))})(this,(function(k,e,C,E,H,$){"use strict";const A={type:"modal",navigate:!1,useNativeDialog:!0,modal:{closeButton:!0,closeExplicitly:!1,closeOnClickOutside:!0,maxWidth:"2xl",paddingClasses:"p-4 sm:p-6",panelClasses:"bg-white rounded",position:"center"},slideover:{closeButton:!0,closeExplicitly:!1,closeOnClickOutside:!0,maxWidth:"md",paddingClasses:"p-4 sm:p-6",panelClasses:"bg-white min-h-screen",position:"right"}};class re{constructor(){this.config={},this.reset()}reset(){this.config=JSON.parse(JSON.stringify(A))}put(o,t){if(typeof o=="object"){this.config={type:o.type??A.type,navigate:o.navigate??A.navigate,useNativeDialog:o.useNativeDialog??A.useNativeDialog,modal:{...A.modal,...o.modal??{}},slideover:{...A.slideover,...o.slideover??{}}};return}const l=o.split(".");let u=this.config;for(let r=0;r<l.length-1;r++)u=u[l[r]]=u[l[r]]||{};u[l[l.length-1]]=t}get(o){if(typeof o>"u")return this.config;const t=o.split(".");let l=this.config;for(const u of t){if(l==null||typeof l!="object")return null;l=l[u]}return l===void 0?null:l}}const U=new re,se=()=>U.reset(),ie=(n,o)=>U.put(n,o),j=n=>U.get(n),T=(n,o)=>U.get(n?`slideover.${o}`:`modal.${o}`);function I(n="inertiaui_modal_"){return C.generateId(n)}function R(n,o){const t=typeof window<"u"?window.location.origin:"http://localhost",l=typeof n=="string"?new URL(n,t):n,u=typeof o=="string"?new URL(o,t):o;return`${l.origin}${l.pathname}`==`${u.origin}${u.pathname}`}const J={__name:"ModalRenderer",props:{index:{type:Number,required:!0}},setup(n){const o=n,t=V(),l=e.computed(()=>t.stack.value[o.index]);return e.provide("modalContext",l),(u,r)=>{var a;return(a=l.value)!=null&&a.component?(e.openBlock(),e.createBlock(e.unref(l).component,e.mergeProps({key:0},e.unref(C.only)(l.value.props??{},l.value.getComponentPropKeys(),!0),{onModalEvent:r[0]||(r[0]=(i,...d)=>l.value.emit(i,...d))}),null,16)):e.createCommentVNode("",!0)}}},Q={__name:"ModalRoot",setup(n){const o=V(),t=E.usePage();let l=!1,u=!1;const r=new Set,a=d=>d.id||`${d.component}:${d.url}`;e.onUnmounted(E.router.on("start",()=>l=!0)),e.onUnmounted(E.router.on("finish",()=>l=!1)),e.onUnmounted(E.router.on("navigate",d=>{const f=d.detail.page.props._inertiaui_modal,m=d.detail.page.url;if(!f){o.closeAll(!0),o.setBaseUrl(null),u=!1;return}if(!R(m,f.url)){o.closeAll(!0),o.setBaseUrl(null),u=!1;return}o.setBaseUrl(f.baseUrl);const c=a(f);r.has(c)||f.id&&o.stack.value.some(p=>p.id===f.id)||o.stack.value.some(p=>{var y,s;return((y=p.response)==null?void 0:y.component)===f.component&&R((s=p.response)==null?void 0:s.url,f.url)})||(r.add(c),o.pushFromResponseData(f,{},()=>{if(!f.baseUrl){console.error("No base url in modal response data so cannot navigate back");return}!l&&typeof window<"u"&&window.location.href!==f.baseUrl&&E.router.visit(f.baseUrl,{preserveScroll:!0,preserveState:!0})}).then(()=>{r.delete(c)}))}));const i=d=>{var m;const f=o.getBaseUrl()??(u?(m=t.props._inertiaui_modal)==null?void 0:m.baseUrl:null);return f&&(d.headers["X-InertiaUI-Modal-Base-Url"]=f),d};return e.onBeforeMount(()=>$.interceptors.request.use(i)),e.onMounted(()=>u=!!t.props._inertiaui_modal),e.onUnmounted(()=>$.interceptors.request.eject(i)),e.watch(()=>{var d;return(d=t.props)==null?void 0:d._inertiaui_modal},(d,f)=>{var m;if(d){if(f&&d.component===f.component&&R(d.url,f.url)){(m=o.stack.value[0])==null||m.updateProps(d.props??{});return}if(!f&&o.stack.value.length>0){const c=o.stack.value.find(p=>{var y,s;return((y=p.response)==null?void 0:y.component)===d.component&&R((s=p.response)==null?void 0:s.url,d.url)});c&&c.updateProps(d.props??{})}}}),(d,f)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.renderSlot(d.$slots,"default"),e.unref(o).stack.value.length?(e.openBlock(),e.createBlock(J,{key:0,index:0})):e.createCommentVNode("",!0)],64))}};let P=null;const S=e.ref(null),w=e.ref([]),L=e.ref({}),W=new Map,z=new Map;function X(n,o,t){return`${o}:${n}:${JSON.stringify(t)}`}function Y(n,o,t){const l=X(n,o,t),u=W.get(l);return u?Date.now()>u.expiresAt?(W.delete(l),null):u.response:null}function ce(n,o,t,l,u){const r=X(n,o,t);W.set(r,{response:l,timestamp:Date.now(),expiresAt:Date.now()+u})}function G(n,o={}){var s;if(n.startsWith("#"))return Promise.resolve();const t=(o.method??"get").toLowerCase(),l=o.data??{},u=o.headers??{},r=o.queryStringArrayFormat??"brackets",a=o.cacheFor??3e4,[i,d]=H.mergeDataIntoQueryString(t,n||"",l,r);if(Y(i,t,d))return Promise.resolve();const m=X(i,t,d),c=z.get(m);if(c)return c.then(()=>{});(s=o.onPrefetching)==null||s.call(o);const p={...u,Accept:"text/html, application/xhtml+xml","X-Requested-With":"XMLHttpRequest","X-Inertia":!0,"X-Inertia-Version":E.usePage().version??"","X-InertiaUI-Modal":I(),"X-InertiaUI-Modal-Base-Url":S.value},y=$({url:i,method:t,data:d,headers:p}).then(g=>{var O;return ce(i,t,d,g,a),(O=o.onPrefetched)==null||O.call(o),g}).finally(()=>{z.delete(m)});return z.set(m,y),y.then(()=>{})}const de=n=>{P=n},ue=n=>{n.resolveComponent&&(P=n.resolveComponent)};class Z{constructor(o,t,l,u,r){this.getComponentPropKeys=()=>{if(!this.component)return[];const a=this.component.props;return Array.isArray(a)?a:a?Object.keys(a):[]},this.getParentModal=()=>{const a=this.index.value;return a<1?null:w.value.slice(0,a).reverse().find(i=>i.isOpen)},this.getChildModal=()=>{const a=this.index.value;return a===w.value.length-1?null:w.value.slice(a+1).find(i=>i.isOpen)??null},this.show=()=>{const a=this.index.value;if(a>-1){if(w.value[a].isOpen)return;w.value[a].isOpen=!0,w.value[a].shouldRender=!0}},this.close=()=>{var i;const a=this.index.value;if(a>-1){if(!w.value[a].isOpen)return;Object.keys(this.listeners).forEach(d=>{this.off(d)}),w.value[a].isOpen=!1,(i=this.onCloseCallback)==null||i.call(this),this.onCloseCallback=null}},this.setOpen=a=>{a?this.show():this.close()},this.afterLeave=()=>{var i;const a=this.index.value;if(a>-1){if(w.value[a].isOpen)return;w.value[a].shouldRender=!1,(i=this.afterLeaveCallback)==null||i.call(this),this.afterLeaveCallback=null}a===0&&(w.value=[],S.value&&typeof window<"u"&&E.router.push({url:S.value,preserveScroll:!0,preserveState:!0,props:d=>{const{_inertiaui_modal:f,...m}=d;return{...m,_inertiaui_modal:void 0}}}),S.value=null)},this.on=(a,i)=>{a=C.kebabCase(a),this.listeners[a]=this.listeners[a]??[],this.listeners[a].push(i)},this.off=(a,i)=>{var d;a=C.kebabCase(a),i?this.listeners[a]=((d=this.listeners[a])==null?void 0:d.filter(f=>f!==i))??[]:delete this.listeners[a]},this.emit=(a,...i)=>{var d;(d=this.listeners[C.kebabCase(a)])==null||d.forEach(f=>f(...i))},this.registerEventListenersFromAttrs=a=>{const i=[];return Object.keys(a).filter(d=>d.startsWith("on")).forEach(d=>{const f=C.kebabCase(d).replace(/^on-/,""),m=a[d];this.on(f,m),i.push(()=>this.off(f,m))}),()=>i.forEach(d=>d())},this.reload=(a={})=>{var m,c;let i=Object.keys(this.response.props);if(a.only&&(i=a.only),a.except&&(i=C.except(i,a.except)),!((m=this.response)!=null&&m.url))return;const d=(a.method??"get").toLowerCase(),f=a.data??{};(c=a.onStart)==null||c.call(a),$({url:this.response.url,method:d,data:d==="get"?{}:f,params:d==="get"?f:{},headers:{...a.headers??{},Accept:"text/html, application/xhtml+xml","X-Inertia":!0,"X-Inertia-Partial-Component":this.response.component,"X-Inertia-Version":this.response.version??"","X-Inertia-Partial-Data":i.join(","),"X-InertiaUI-Modal":I(),"X-InertiaUI-Modal-Base-Url":S.value}}).then(p=>{var y;this.updateProps(p.data.props),(y=a.onSuccess)==null||y.call(a,p)}).catch(p=>{var y;(y=a.onError)==null||y.call(a,p)}).finally(()=>{var p;(p=a.onFinish)==null||p.call(a)})},this.updateProps=a=>{Object.assign(this.props.value,a)},this.id=t.id??I(),this.isOpen=!1,this.shouldRender=!1,this.listeners={},this.component=o,this.props=e.ref(t.props??{}),this.response=t,this.config=l??{},this.onCloseCallback=u??null,this.afterLeaveCallback=r??null,this.index=e.computed(()=>w.value.findIndex(a=>a.id===this.id)),this.onTopOfStack=e.computed(()=>{var i;return w.value.length<2?!0:((i=w.value.map(d=>({id:d.id,shouldRender:d.shouldRender})).reverse().find(d=>d.shouldRender))==null?void 0:i.id)===this.id})}}function fe(n,o){L.value[n]={name:n,callback:o}}function me(n,o,t,l,u){if(!L.value[n])throw new Error(`The local modal "${n}" has not been registered.`);const a=_(null,{props:u??{}},o,t,l);return a.name=n,L.value[n].callback(a),a}function pe(n){return typeof n=="object"&&n!==null&&"component"in n&&typeof n.component=="string"}function ee(n,o,t){!n||!o||typeof window>"u"||E.router.push({url:n,preserveScroll:!0,preserveState:!0,props:t?l=>({...l,_inertiaui_modal:{...t,baseUrl:S.value}}):void 0})}function K(n,o={},t=null,l=null){return P?pe(n)?P(n.component).then(u=>_(e.markRaw(u),n,o,t,l)):Promise.reject(new Error("Invalid modal response. This usually happens when the server returns a redirect (e.g., due to session expiration). Check if the user is still authenticated.")):Promise.reject(new Error("Component resolver not set"))}function ge(n,o,t={},l={},u={},r=null,a=null,i="brackets",d=!1,f=null,m=null,c=null,p=null){const y=I();return new Promise((s,g)=>{var B;if(n.startsWith("#")){s(me(n.substring(1),u,r,a,p));return}const[O,N]=H.mergeDataIntoQueryString(o,n||"",t,i),M=Y(O,o,N);if(M){m==null||m(M),K(M.data,u,r,a).then(h=>{ee(M.data.url,d,M.data),s(h)}).catch(g);return}w.value.length===0&&(S.value=typeof window<"u"?window.location.href:"");const F={...l,Accept:"text/html, application/xhtml+xml","X-Requested-With":"XMLHttpRequest","X-Inertia":!0,"X-Inertia-Version":E.usePage().version??"","X-InertiaUI-Modal":y,"X-InertiaUI-Modal-Base-Url":S.value};f==null||f(),(B=E.progress)==null||B.start(),$({url:O,method:o,data:N,headers:F}).then(h=>{m==null||m(h),K(h.data,u,r,a).then(v=>{ee(h.data.url,d,h.data),s(v)}).catch(g)}).catch((...h)=>{c==null||c(...h),g(h[0])}).finally(()=>{var h;(h=E.progress)==null||h.finish()})})}function he(n){var t,l;const o=(l=(t=n.response)==null?void 0:t.meta)==null?void 0:l.deferredProps;o&&Object.keys(o).forEach(u=>{n.reload({only:o[u]})})}function _(n,o,t,l,u){const r=new Z(n,o,t,l,u);return w.value.push(r),he(r),e.nextTick(()=>r.show()),r}const te=["closeButton","closeExplicitly","closeOnClickOutside","maxWidth","paddingClasses","panelClasses","position","slideover"],xe=(n,o)=>(o.resolveComponent&&(P=o.resolveComponent),()=>e.h(Q,()=>e.h(n,o)));function V(){return{setComponentResolver:de,getBaseUrl:()=>S.value,setBaseUrl:n=>S.value=n,stack:e.readonly(w),push:_,pushFromResponseData:K,closeAll:(n=!1)=>{n?w.value=[]:[...w.value].reverse().forEach(o=>o.close())},reset:()=>w.value=[],visit:ge,registerLocalModal:fe,removeLocalModal:n=>delete L.value[n]}}function ne(){return e.toValue(e.inject("modalContext",null))}const ye={__name:"Deferred",props:{data:{type:[String,Array],required:!0}},setup(n){const o=n,t=e.inject("modalContext");if(!t)throw new Error("Deferred component must be used inside a Modal component");const l=e.computed(()=>(Array.isArray(o.data)?o.data:[o.data]).every(r=>t.value.props[r]!==void 0));return(u,r)=>l.value?e.renderSlot(u.$slots,"default",{key:0}):e.renderSlot(u.$slots,"fallback",{key:1})}},ae=Object.assign({inheritAttrs:!1},{__name:"HeadlessModal",props:{name:{type:String,required:!1},slideover:{type:Boolean,default:null},closeButton:{type:Boolean,default:null},closeExplicitly:{type:Boolean,default:null},closeOnClickOutside:{type:Boolean,default:null},maxWidth:{type:String,default:null},paddingClasses:{type:[Boolean,String],default:null},panelClasses:{type:[Boolean,String],default:null},position:{type:String,default:null}},emits:["modal-event","focus","blur","close","success"],setup(n,{expose:o,emit:t}){const l=n,u=V(),r=l.name?e.ref({}):e.inject("modalContext"),a=e.computed(()=>{var g;const s=((g=r.value.config)==null?void 0:g.slideover)??l.slideover??j("type")==="slideover";return{slideover:s,closeButton:l.closeButton??T(s,"closeButton"),closeExplicitly:l.closeExplicitly??T(s,"closeExplicitly"),closeOnClickOutside:l.closeOnClickOutside??T(s,"closeOnClickOutside"),maxWidth:l.maxWidth??T(s,"maxWidth"),paddingClasses:l.paddingClasses??T(s,"paddingClasses"),panelClasses:l.panelClasses??T(s,"panelClasses"),position:l.position??T(s,"position"),...r.value.config}});l.name&&(u.registerLocalModal(l.name,function(s){r.value=s,f()}),e.onBeforeUnmount(()=>{u.removeLocalModal(l.name)})),e.onMounted(()=>{l.name||f()});const i=e.ref(null);e.onBeforeUnmount(()=>{var s;return(s=i.value)==null?void 0:s.call(i)});const d=e.useAttrs();function f(){i.value=r.value.registerEventListenersFromAttrs(d)}const m=t;function c(s,...g){m("modal-event",s,...g)}o({emit:c,afterLeave:()=>{var s;return(s=r.value)==null?void 0:s.afterLeave()},close:()=>{var s;return(s=r.value)==null?void 0:s.close()},reload:(...s)=>{var g;return(g=r.value)==null?void 0:g.reload(...s)},setOpen:(...s)=>{var g;return(g=r.value)==null?void 0:g.setOpen(...s)},getChildModal:()=>{var s;return(s=r.value)==null?void 0:s.getChildModal()},getParentModal:()=>{var s;return(s=r.value)==null?void 0:s.getParentModal()},get config(){var s;return(s=r.value)==null?void 0:s.config},get id(){var s;return(s=r.value)==null?void 0:s.id},get index(){var s;return(s=r.value)==null?void 0:s.index},get isOpen(){var s;return(s=r.value)==null?void 0:s.isOpen},get modalContext(){var s;return(s=r.value)==null?void 0:s.modalContext},get onTopOfStack(){var s;return(s=r.value)==null?void 0:s.onTopOfStack},get shouldRender(){var s;return(s=r.value)==null?void 0:s.shouldRender}}),e.watch(()=>{var s;return(s=r.value)==null?void 0:s.onTopOfStack},(s,g)=>{s&&!g?m("focus"):!s&&g&&m("blur")}),e.watch(()=>{var s;return(s=r.value)==null?void 0:s.isOpen},(s,g)=>{s?m("success"):g===!0&&m("close")},{immediate:!0});const p=e.computed(()=>{var s;return(s=u.stack.value.find(g=>g.shouldRender&&g.index>r.value.index))==null?void 0:s.index}),y=e.computed(()=>{const s=r.value;return s?e.unref(s.props)??{}:{}});return(s,g)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.unref(r).shouldRender?e.renderSlot(s.$slots,"default",e.mergeProps({key:0},y.value,{id:e.unref(r).id,afterLeave:e.unref(r).afterLeave,close:e.unref(r).close,config:a.value,emit:c,getChildModal:e.unref(r).getChildModal,getParentModal:e.unref(r).getParentModal,index:e.unref(r).index,isOpen:e.unref(r).isOpen,modalContext:e.unref(r),onTopOfStack:e.unref(r).onTopOfStack,reload:e.unref(r).reload,setOpen:e.unref(r).setOpen,shouldRender:e.unref(r).shouldRender})):e.createCommentVNode("",!0),p.value?(e.openBlock(),e.createBlock(J,{key:1,index:p.value},null,8,["index"])):e.createCommentVNode("",!0)],64))}}),q={__name:"CloseButton",setup(n){const o=ne();return(t,l)=>(e.openBlock(),e.createElementBlock("button",{type:"button",class:"im-close-button text-gray-400 hover:text-gray-500",onClick:l[0]||(l[0]=u=>e.unref(o).close())},[...l[1]||(l[1]=[e.createElementVNode("span",{class:"sr-only"},"Close",-1),e.createElementVNode("svg",{class:"size-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor","aria-hidden":"true"},[e.createElementVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])]))}},Ce=Object.freeze(Object.defineProperty({__proto__:null,createDialog:C.createDialog,createFocusTrap:C.createFocusTrap,focusFirstElement:C.focusFirstElement,getFocusableElements:C.getFocusableElements,getScrollLockCount:C.getScrollLockCount,lockScroll:C.lockScroll,markAriaHidden:C.markAriaHidden,onClickOutside:C.onClickOutside,onEscapeKey:C.onEscapeKey,unlockScroll:C.unlockScroll,unmarkAriaHidden:C.unmarkAriaHidden},Symbol.toStringTag,{value:"Module"})),oe={sm:"sm:max-w-sm",md:"sm:max-w-md",lg:"sm:max-w-md md:max-w-lg",xl:"sm:max-w-md md:max-w-xl","2xl":"sm:max-w-md md:max-w-xl lg:max-w-2xl","3xl":"sm:max-w-md md:max-w-xl lg:max-w-3xl","4xl":"sm:max-w-md md:max-w-xl lg:max-w-3xl xl:max-w-4xl","5xl":"sm:max-w-md md:max-w-xl lg:max-w-3xl xl:max-w-5xl","6xl":"sm:max-w-md md:max-w-xl lg:max-w-3xl xl:max-w-5xl 2xl:max-w-6xl","7xl":"sm:max-w-md md:max-w-xl lg:max-w-3xl xl:max-w-5xl 2xl:max-w-7xl"},ke="2xl";function le(n){return oe[n]||oe[ke]}const ve={class:"im-modal-container fixed inset-0 overflow-y-auto p-4"},we=["data-inertiaui-modal-entered"],be={key:0,class:"absolute right-0 top-0 pr-3 pt-3"},Oe=["data-inertiaui-modal-entered"],Be={key:0,class:"absolute right-0 top-0 pr-3 pt-3"},Me={__name:"ModalContent",props:{modalContext:Object,config:Object,useNativeDialog:Boolean,isFirstModal:Boolean},emits:["after-leave"],setup(n,{emit:o}){const t=n,l=o,u=e.ref(!1),r=e.ref(!1),a=e.ref(null),i=e.ref(null);let d=null,f=null;const m=e.computed(()=>le(t.config.maxWidth));function c(){t.useNativeDialog||!a.value||!t.modalContext.onTopOfStack||d||(d=C.createFocusTrap(a.value,{initialFocus:!0,returnFocus:!1}))}function p(){d&&(d(),d=null)}function y(){var v;t.useNativeDialog||f||(v=t.config)!=null&&v.closeExplicitly||(f=C.onEscapeKey(()=>{t.modalContext.onTopOfStack&&t.modalContext.close()}))}function s(){f&&(f(),f=null)}function g(v){var x,b;t.useNativeDialog||t.modalContext.onTopOfStack&&((x=t.config)!=null&&x.closeExplicitly||((b=t.config)==null?void 0:b.closeOnClickOutside)!==!1&&a.value&&(a.value.contains(v.target)||t.modalContext.close()))}function O(){u.value=!0,c()}function N(){l("after-leave"),t.modalContext.afterLeave()}function M(v){var x;v.preventDefault(),t.modalContext.onTopOfStack&&!((x=t.config)!=null&&x.closeExplicitly)&&t.modalContext.close()}function F(v){var x,b;v.target===i.value&&t.modalContext.onTopOfStack&&!((x=t.config)!=null&&x.closeExplicitly)&&((b=t.config)==null?void 0:b.closeOnClickOutside)!==!1&&t.modalContext.close()}function B(){i.value&&!i.value.open&&(i.value.showModal(),e.nextTick(()=>{requestAnimationFrame(()=>{u.value=!0})}))}function h(){i.value&&i.value.open&&(r.value=!0,u.value=!1,setTimeout(()=>{i.value&&i.value.close(),r.value=!1,l("after-leave"),t.modalContext.afterLeave()},300))}return e.onMounted(()=>{t.useNativeDialog?t.modalContext.isOpen&&B():y()}),e.onUnmounted(()=>{var v;t.useNativeDialog?(v=i.value)!=null&&v.open&&i.value.close():(p(),s())}),e.watch(()=>t.modalContext.onTopOfStack,v=>{t.useNativeDialog||(v?(y(),u.value&&c()):(p(),s()))}),e.watch(()=>t.modalContext.isOpen,v=>{t.useNativeDialog&&(v?B():r.value||h())}),(v,x)=>n.useNativeDialog?(e.openBlock(),e.createElementBlock("dialog",{key:0,ref_key:"dialogRef",ref:i,class:e.normalizeClass(["im-modal-dialog m-0 overflow-visible bg-transparent p-0","size-full max-h-none max-w-none","backdrop:bg-black/75 backdrop:transition-opacity backdrop:duration-300",u.value?"backdrop:opacity-100":"backdrop:opacity-0",!n.isFirstModal&&"backdrop:bg-transparent"]),onCancel:M,onClick:F},[e.createElementVNode("div",ve,[e.createElementVNode("div",{class:e.normalizeClass(["im-modal-positioner flex min-h-full justify-center",{"items-start":n.config.position==="top","items-center":n.config.position==="center","items-end":n.config.position==="bottom"}])},[e.createElementVNode("div",{class:e.normalizeClass(["im-modal-wrapper w-full transition duration-300 ease-in-out",n.modalContext.onTopOfStack?"":"blur-xs",u.value&&!r.value?"translate-y-0 opacity-100 sm:scale-100":"translate-y-4 opacity-0 sm:translate-y-0 sm:scale-95",m.value])},[e.createElementVNode("div",{class:e.normalizeClass(["im-modal-content relative",[n.config.paddingClasses,n.config.panelClasses]]),"data-inertiaui-modal-entered":u.value},[n.config.closeButton?(e.openBlock(),e.createElementBlock("div",be,[e.createVNode(q)])):e.createCommentVNode("",!0),e.renderSlot(v.$slots,"default",{modalContext:n.modalContext,config:n.config})],10,we)],2)],2)])],34)):(e.openBlock(),e.createElementBlock("div",{key:1,class:"im-modal-container fixed inset-0 z-40 overflow-y-auto p-4",onMousedown:e.withModifiers(g,["self"])},[e.createElementVNode("div",{class:e.normalizeClass(["im-modal-positioner flex min-h-full justify-center",{"items-start":n.config.position==="top","items-center":n.config.position==="center","items-end":n.config.position==="bottom"}]),onMousedown:e.withModifiers(g,["self"])},[e.createVNode(e.Transition,{appear:"","enter-active-class":"transition duration-300 ease-in-out","enter-from-class":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to-class":"opacity-100 translate-y-0 sm:scale-100","leave-active-class":"transition duration-300 ease-in-out","leave-from-class":"opacity-100 translate-y-0 sm:scale-100","leave-to-class":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",onAfterEnter:O,onAfterLeave:N},{default:e.withCtx(()=>[n.modalContext.isOpen?(e.openBlock(),e.createElementBlock("div",{key:0,ref_key:"wrapperRef",ref:a,role:"dialog","aria-modal":"true",class:e.normalizeClass(["im-modal-wrapper w-full",n.modalContext.onTopOfStack?"":"blur-xs",m.value])},[x[0]||(x[0]=e.createElementVNode("span",{class:"sr-only"},"Dialog",-1)),e.createElementVNode("div",{class:e.normalizeClass(["im-modal-content relative",[n.config.paddingClasses,n.config.panelClasses]]),"data-inertiaui-modal-entered":u.value},[n.config.closeButton?(e.openBlock(),e.createElementBlock("div",Be,[e.createVNode(q)])):e.createCommentVNode("",!0),e.renderSlot(v.$slots,"default",{modalContext:n.modalContext,config:n.config})],10,Oe)],2)):e.createCommentVNode("",!0)]),_:3})],34)],32))}},Ee={class:"im-slideover-container fixed inset-0 overflow-y-auto overflow-x-hidden"},Se=["data-inertiaui-modal-entered"],Ne={key:0,class:"absolute right-0 top-0 pr-3 pt-3"},Fe=["data-inertiaui-modal-entered"],Te={key:0,class:"absolute right-0 top-0 pr-3 pt-3"},De={__name:"SlideoverContent",props:{modalContext:Object,config:Object,useNativeDialog:Boolean,isFirstModal:Boolean},emits:["after-leave"],setup(n,{emit:o}){const t=n,l=o,u=e.ref(!1),r=e.ref(!1),a=e.ref(null),i=e.ref(null);let d=null,f=null;const m=e.computed(()=>le(t.config.maxWidth)),c=e.computed(()=>t.config.position==="left"?"-translate-x-full":"translate-x-full");function p(){t.useNativeDialog||!a.value||!t.modalContext.onTopOfStack||d||(d=C.createFocusTrap(a.value,{initialFocus:!0,returnFocus:!1}))}function y(){d&&(d(),d=null)}function s(){var x;t.useNativeDialog||f||(x=t.config)!=null&&x.closeExplicitly||(f=C.onEscapeKey(()=>{t.modalContext.onTopOfStack&&t.modalContext.close()}))}function g(){f&&(f(),f=null)}function O(x){var b,D;t.useNativeDialog||t.modalContext.onTopOfStack&&((b=t.config)!=null&&b.closeExplicitly||((D=t.config)==null?void 0:D.closeOnClickOutside)!==!1&&a.value&&(a.value.contains(x.target)||t.modalContext.close()))}function N(){u.value=!0,p()}function M(){l("after-leave"),t.modalContext.afterLeave()}function F(x){var b;x.preventDefault(),t.modalContext.onTopOfStack&&!((b=t.config)!=null&&b.closeExplicitly)&&t.modalContext.close()}function B(x){var b,D;x.target===i.value&&t.modalContext.onTopOfStack&&!((b=t.config)!=null&&b.closeExplicitly)&&((D=t.config)==null?void 0:D.closeOnClickOutside)!==!1&&t.modalContext.close()}function h(){i.value&&!i.value.open&&(i.value.showModal(),e.nextTick(()=>{requestAnimationFrame(()=>{u.value=!0})}))}function v(){i.value&&i.value.open&&(r.value=!0,u.value=!1,setTimeout(()=>{i.value&&i.value.close(),r.value=!1,l("after-leave"),t.modalContext.afterLeave()},300))}return e.onMounted(()=>{t.useNativeDialog?t.modalContext.isOpen&&h():s()}),e.onUnmounted(()=>{var x;t.useNativeDialog?(x=i.value)!=null&&x.open&&i.value.close():(y(),g())}),e.watch(()=>t.modalContext.onTopOfStack,x=>{t.useNativeDialog||(x?(s(),u.value&&p()):(y(),g()))}),e.watch(()=>t.modalContext.isOpen,x=>{t.useNativeDialog&&(x?h():r.value||v())}),(x,b)=>n.useNativeDialog?(e.openBlock(),e.createElementBlock("dialog",{key:0,ref_key:"dialogRef",ref:i,class:e.normalizeClass(["im-slideover-dialog m-0 overflow-visible bg-transparent p-0","size-full max-h-none max-w-none","backdrop:bg-black/75 backdrop:transition-opacity backdrop:duration-300",u.value?"backdrop:opacity-100":"backdrop:opacity-0",!n.isFirstModal&&"backdrop:bg-transparent"]),onCancel:F,onClick:B},[e.createElementVNode("div",Ee,[e.createElementVNode("div",{class:e.normalizeClass(["im-slideover-positioner flex min-h-full items-center",{"justify-start rtl:justify-end":n.config.position==="left","justify-end rtl:justify-start":n.config.position==="right"}])},[e.createElementVNode("div",{class:e.normalizeClass(["im-slideover-wrapper w-full transition duration-300 ease-in-out",n.modalContext.onTopOfStack?"":"blur-xs",u.value&&!r.value?"translate-x-0 opacity-100":n.config.position==="left"?"-translate-x-full opacity-0":"translate-x-full opacity-0",m.value])},[e.createElementVNode("div",{class:e.normalizeClass(["im-slideover-content relative",[n.config.paddingClasses,n.config.panelClasses]]),"data-inertiaui-modal-entered":u.value},[n.config.closeButton?(e.openBlock(),e.createElementBlock("div",Ne,[e.createVNode(q)])):e.createCommentVNode("",!0),e.renderSlot(x.$slots,"default",{modalContext:n.modalContext,config:n.config})],10,Se)],2)],2)])],34)):(e.openBlock(),e.createElementBlock("div",{key:1,class:"im-slideover-container fixed inset-0 z-40 overflow-y-auto overflow-x-hidden",onMousedown:e.withModifiers(O,["self"])},[e.createElementVNode("div",{class:e.normalizeClass(["im-slideover-positioner flex min-h-full items-center",{"justify-start rtl:justify-end":n.config.position==="left","justify-end rtl:justify-start":n.config.position==="right"}]),onMousedown:e.withModifiers(O,["self"])},[e.createVNode(e.Transition,{appear:"","enter-active-class":"transition duration-300 ease-in-out","enter-from-class":"opacity-0 "+c.value,"enter-to-class":"opacity-100 translate-x-0","leave-active-class":"transition duration-300 ease-in-out","leave-from-class":"opacity-100 translate-x-0","leave-to-class":"opacity-0 "+c.value,onAfterEnter:N,onAfterLeave:M},{default:e.withCtx(()=>[n.modalContext.isOpen?(e.openBlock(),e.createElementBlock("div",{key:0,ref_key:"wrapperRef",ref:a,role:"dialog","aria-modal":"true",class:e.normalizeClass(["im-slideover-wrapper w-full",n.modalContext.onTopOfStack?"":"blur-xs",m.value])},[b[0]||(b[0]=e.createElementVNode("span",{class:"sr-only"},"Dialog",-1)),e.createElementVNode("div",{class:e.normalizeClass(["im-slideover-content relative",[n.config.paddingClasses,n.config.panelClasses]]),"data-inertiaui-modal-entered":u.value},[n.config.closeButton?(e.openBlock(),e.createElementBlock("div",Te,[e.createVNode(q)])):e.createCommentVNode("",!0),e.renderSlot(x.$slots,"default",{modalContext:n.modalContext,config:n.config})],10,Fe)],2)):e.createCommentVNode("",!0)]),_:3},8,["enter-from-class","leave-to-class"])],34)],32))}},Ae=["data-inertiaui-modal-id","data-inertiaui-modal-index","aria-hidden"],Ve={key:0,class:"im-backdrop fixed inset-0 z-30 bg-black/75"},$e={__name:"Modal",emits:["after-leave","blur","close","focus","success"],setup(n,{expose:o,emit:t}){const l=e.ref(null),u=e.ref(!1),r=t;o({afterLeave:()=>{var c;return(c=l.value)==null?void 0:c.afterLeave()},close:()=>{var c;return(c=l.value)==null?void 0:c.close()},emit:(...c)=>{var p;return(p=l.value)==null?void 0:p.emit(...c)},getChildModal:()=>{var c;return(c=l.value)==null?void 0:c.getChildModal()},getParentModal:()=>{var c;return(c=l.value)==null?void 0:c.getParentModal()},reload:(...c)=>{var p;return(p=l.value)==null?void 0:p.reload(...c)},setOpen:(...c)=>{var p;return(p=l.value)==null?void 0:p.setOpen(...c)},get config(){var c;return(c=l.value)==null?void 0:c.config},get id(){var c;return(c=l.value)==null?void 0:c.id},get index(){var c;return(c=l.value)==null?void 0:c.index},get isOpen(){var c;return(c=l.value)==null?void 0:c.isOpen},get modalContext(){var c;return(c=l.value)==null?void 0:c.modalContext},get onTopOfStack(){var c;return(c=l.value)==null?void 0:c.onTopOfStack},get shouldRender(){var c;return(c=l.value)==null?void 0:c.shouldRender}});let a=null,i=null;e.onMounted(()=>{var c;(c=l.value)!=null&&c.isOpen&&!a&&(a=C.lockScroll(),i=C.markAriaHidden("#app"))}),e.onUnmounted(()=>{a==null||a(),i==null||i()});function d(){r("success"),a||(a=C.lockScroll(),i=C.markAriaHidden("#app"))}function f(){r("close"),a==null||a(),i==null||i(),a=null,i=null}const m=e.computed(()=>j("useNativeDialog"));return(c,p)=>(e.openBlock(),e.createBlock(ae,{ref_key:"modal",ref:l,onSuccess:d,onClose:f,onFocus:p[2]||(p[2]=y=>r("focus")),onBlur:p[3]||(p[3]=y=>r("blur"))},{default:e.withCtx(({afterLeave:y,close:s,config:g,emit:O,getChildModal:N,getParentModal:M,id:F,index:B,isOpen:h,modalContext:v,onTopOfStack:x,reload:b,setOpen:D,shouldRender:Ie,...Re})=>[(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"data-inertiaui-modal-id":F,"data-inertiaui-modal-index":B,class:"im-dialog relative z-20","aria-hidden":!x},[B===0&&!m.value?(e.openBlock(),e.createBlock(e.Transition,{key:0,appear:!u.value,"enter-active-class":"transition transform ease-in-out duration-300","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition transform ease-in-out duration-300","leave-from-class":"opacity-100","leave-to-class":"opacity-0",onAfterAppear:p[0]||(p[0]=Le=>u.value=!0)},{default:e.withCtx(()=>[h?(e.openBlock(),e.createElementBlock("div",Ve)):e.createCommentVNode("",!0)]),_:2},1032,["appear"])):e.createCommentVNode("",!0),(e.openBlock(),e.createBlock(e.resolveDynamicComponent(g!=null&&g.slideover?De:Me),{"modal-context":v,config:g,"use-native-dialog":m.value,"is-first-modal":B===0,onAfterLeave:p[1]||(p[1]=Le=>c.$emit("after-leave"))},{default:e.withCtx(()=>[e.renderSlot(c.$slots,"default",e.mergeProps(Re,{id:F,afterLeave:y,close:s,config:g,emit:O,getChildModal:N,getParentModal:M,index:B,isOpen:h,modalContext:v,onTopOfStack:x,reload:b,setOpen:D,shouldRender:Ie}))]),_:2},1064,["modal-context","config","use-native-dialog","is-first-modal"]))],8,Ae)]))]),_:3},512))}},je={__name:"ModalLink",props:{href:{type:String,required:!0},method:{type:String,default:"get"},data:{type:Object,default:()=>({})},as:{type:[String,Object],default:"a"},headers:{type:Object,default:()=>({})},queryStringArrayFormat:{type:String,default:"brackets"},navigate:{type:Boolean,default:null},prefetch:{type:[Boolean,String,Array],default:!1},cacheFor:{type:Number,default:3e4},closeButton:{type:Boolean,required:!1,default:null},closeExplicitly:{type:Boolean,required:!1,default:null},closeOnClickOutside:{type:Boolean,required:!1,default:null},maxWidth:{type:String,required:!1,default:null},paddingClasses:{type:[Boolean,String],required:!1,default:null},panelClasses:{type:[Boolean,String],required:!1,default:null},position:{type:String,required:!1,default:null},slideover:{type:Boolean,required:!1,default:null}},emits:["after-leave","blur","close","error","focus","start","success","prefetching","prefetched"],setup(n,{emit:o}){const t=n,l=e.ref(!1),u=V(),r=e.ref(null);e.provide("modalContext",r);const a=o,i=e.ref(!1),d=e.computed(()=>t.navigate??j("navigate")),f=e.ref(null),m=e.computed(()=>t.prefetch===!0?["hover"]:t.prefetch===!1?[]:Array.isArray(t.prefetch)?t.prefetch:[t.prefetch]);function c(){G(t.href,{method:t.method,data:t.data,headers:t.headers,queryStringArrayFormat:t.queryStringArrayFormat,cacheFor:t.cacheFor,onPrefetching:()=>a("prefetching"),onPrefetched:()=>a("prefetched")})}function p(){m.value.includes("hover")&&(f.value=setTimeout(()=>{c()},75))}function y(){f.value&&(clearTimeout(f.value),f.value=null)}function s(h){m.value.includes("click")&&h.button===0&&c()}e.onMounted(()=>{m.value.includes("mount")&&c()}),e.watch(()=>{var h;return(h=r.value)==null?void 0:h.onTopOfStack},h=>{r.value&&(h&&i.value?a("focus"):h||a("blur"),i.value=!h)});const g=e.ref(null);e.onBeforeUnmount(()=>{var h;(h=g.value)==null||h.call(g),f.value&&clearTimeout(f.value)});const O=e.useAttrs();function N(){g.value=r.value.registerEventListenersFromAttrs(O)}e.watch(r,(h,v)=>{h&&!v&&(N(),a("success"))});function M(){a("close")}function F(){r.value=null,a("after-leave")}function B(){l.value||(t.href.startsWith("#")||(l.value=!0,a("start")),u.visit(t.href,t.method,t.data,t.headers,C.rejectNullValues(C.only(t,te)),M,F,t.queryStringArrayFormat,d.value).then(h=>{r.value=h}).catch(h=>a("error",h)).finally(()=>l.value=!1))}return(h,v)=>(e.openBlock(),e.createBlock(e.resolveDynamicComponent(n.as),e.mergeProps(e.unref(O),{href:n.href,onClick:e.withModifiers(B,["prevent"]),onMouseenter:p,onMouseleave:y,onMousedown:s}),{default:e.withCtx(()=>[e.renderSlot(h.$slots,"default",{loading:l.value})]),_:3},16,["href"]))}},Pe={__name:"WhenVisible",props:{data:[String,Array],params:Object,buffer:{type:Number,default:0},as:{type:String,default:"div"},always:{type:Boolean,default:!1}},setup(n){const o=n,t=e.inject("modalContext");if(!t)throw new Error("Deferred component must be used inside a Modal component");const l=e.ref(!1),u=e.ref(!1),r=e.ref(null);let a=null;const i=()=>{if(o.data)return{only:Array.isArray(o.data)?o.data:[o.data]};if(!o.params)throw new Error("You must provide either a `data` or `params` prop.");return o.params},d=()=>{r.value&&(a=new IntersectionObserver(f=>{if(!f[0].isIntersecting||(o.always||a.disconnect(),u.value))return;u.value=!0;const m=i();t.value.reload({...m,onStart:()=>{var c;u.value=!0,(c=m.onStart)==null||c.call(m)},onFinish:()=>{var c;l.value=!0,u.value=!1,(c=m.onFinish)==null||c.call(m)}})},{rootMargin:`${o.buffer}px`}),a.observe(r.value))};return e.onMounted(d),e.onUnmounted(()=>a==null?void 0:a.disconnect()),(f,m)=>(e.openBlock(),e.createBlock(e.resolveDynamicComponent(o.as),{ref_key:"rootElement",ref:r},{default:e.withCtx(()=>[l.value?e.renderSlot(f.$slots,"default",{key:0}):e.renderSlot(f.$slots,"fallback",{key:1})]),_:3},512))}};function Ue(n,o={}){return V().visit(n,o.method??"get",o.data??{},o.headers??{},o.config??{},o.onClose,o.onAfterLeave,o.queryStringArrayFormat??"brackets",o.navigate??j("navigate"),o.onStart,o.onSuccess,o.onError,o.props??null).then(t=>{const l=o.listeners??{};return Object.keys(l).forEach(u=>{const r=C.kebabCase(u);t.on(r,l[u])}),t})}k.Deferred=ye,k.HeadlessModal=ae,k.Modal=$e,k.ModalInstance=Z,k.ModalLink=je,k.ModalRoot=Q,k.WhenVisible=Pe,k.dialogUtils=Ce,k.getConfig=j,k.initFromPageProps=ue,k.modalPropNames=te,k.prefetch=G,k.putConfig=ie,k.renderApp=xe,k.resetConfig=se,k.useModal=ne,k.useModalStack=V,k.visitModal=Ue,Object.defineProperty(k,Symbol.toStringTag,{value:"Module"})}));
//# sourceMappingURL=inertiaui-modal.umd.cjs.map
