{"version":3,"file":"inertiaui-modal.umd.cjs","sources":["../src/config.ts","../src/helpers.ts","../src/ModalRoot.tsx","../src/ModalRenderer.tsx","../src/useModal.ts","../src/Deferred.tsx","../src/HeadlessModal.tsx","../src/CloseButton.tsx","../node_modules/clsx/dist/clsx.mjs","../src/constants.ts","../src/ModalContent.tsx","../src/SlideoverContent.tsx","../src/Modal.tsx","../src/ModalLink.tsx","../src/WhenVisible.tsx","../src/inertiauiModal.ts"],"sourcesContent":["export interface ModalTypeConfig {\n    closeButton: boolean\n    closeExplicitly: boolean\n    closeOnClickOutside: boolean\n    maxWidth: string\n    paddingClasses: string\n    panelClasses: string\n    position: string\n}\n\nexport interface ModalConfig {\n    type: 'modal' | 'slideover'\n    navigate: boolean\n    useNativeDialog: boolean\n    appElement: string | null\n    modal: ModalTypeConfig\n    slideover: ModalTypeConfig\n}\n\nconst defaultConfig: ModalConfig = {\n    type: 'modal',\n    navigate: false,\n    useNativeDialog: true,\n    appElement: '#app',\n    modal: {\n        closeButton: true,\n        closeExplicitly: false,\n        closeOnClickOutside: true,\n        maxWidth: '2xl',\n        paddingClasses: 'p-4 sm:p-6',\n        panelClasses: 'bg-white rounded',\n        position: 'center',\n    },\n    slideover: {\n        closeButton: true,\n        closeExplicitly: false,\n        closeOnClickOutside: true,\n        maxWidth: 'md',\n        paddingClasses: 'p-4 sm:p-6',\n        panelClasses: 'bg-white min-h-screen',\n        position: 'right',\n    },\n}\n\nclass Config {\n    private config: ModalConfig\n\n    constructor() {\n        this.config = {} as ModalConfig\n        this.reset()\n    }\n\n    reset(): void {\n        this.config = JSON.parse(JSON.stringify(defaultConfig))\n    }\n\n    put(key: string | Partial<ModalConfig>, value?: unknown): void {\n        if (typeof key === 'object') {\n            this.config = {\n                type: key.type ?? defaultConfig.type,\n                navigate: key.navigate ?? defaultConfig.navigate,\n                useNativeDialog: key.useNativeDialog ?? defaultConfig.useNativeDialog,\n                appElement: key.appElement !== undefined ? key.appElement : defaultConfig.appElement,\n                modal: { ...defaultConfig.modal, ...(key.modal ?? {}) },\n                slideover: { ...defaultConfig.slideover, ...(key.slideover ?? {}) },\n            }\n            return\n        }\n        const keys = key.split('.')\n        let current: Record<string, unknown> = this.config as unknown as Record<string, unknown>\n        for (let i = 0; i < keys.length - 1; i++) {\n            current = (current[keys[i]] = current[keys[i]] || {}) as Record<string, unknown>\n        }\n        current[keys[keys.length - 1]] = value\n    }\n\n    get(key?: string): unknown {\n        if (typeof key === 'undefined') {\n            return this.config\n        }\n        const keys = key.split('.')\n        let current: unknown = this.config\n        for (const k of keys) {\n            if (current === null || current === undefined || typeof current !== 'object') {\n                return null\n            }\n            current = (current as Record<string, unknown>)[k]\n        }\n        return current === undefined ? null : current\n    }\n}\n\nconst configInstance = new Config()\n\nexport const resetConfig = (): void => configInstance.reset()\nexport const putConfig = (key: string | Partial<ModalConfig>, value?: unknown): void => configInstance.put(key, value)\nexport const getConfig = (key?: string): unknown => configInstance.get(key)\nexport const getConfigByType = (isSlideover: boolean, key: string): unknown =>\n    configInstance.get(isSlideover ? `slideover.${key}` : `modal.${key}`)\n","// Re-export helper utilities from vanilla\nexport { sameUrlPath, except, only, rejectNullValues, kebabCase, isStandardDomEvent } from '@inertiaui/vanilla'\nimport { generateId as vanillaGenerateId } from '@inertiaui/vanilla'\n\n// Wrap generateId with custom callback support for testing\nlet generateIdUsingCallback: (() => string) | null = null\n\nexport function generateIdUsing(callback: (() => string) | null): void {\n    generateIdUsingCallback = callback\n}\n\nexport function generateId(prefix = 'inertiaui_'): string {\n    if (generateIdUsingCallback) {\n        return generateIdUsingCallback()\n    }\n    return vanillaGenerateId(prefix)\n}\n\n// Re-export dialog utilities from vanilla\nexport {\n    lockScroll,\n    unlockScroll,\n    getScrollLockCount,\n    getFocusableElements,\n    createFocusTrap,\n    focusFirstElement,\n    onClickOutside,\n    onEscapeKey,\n    markAriaHidden,\n    unmarkAriaHidden,\n    createDialog,\n} from '@inertiaui/vanilla'\n\n// Re-export types from vanilla\nexport type {\n    CleanupFunction,\n    FocusTrapOptions,\n    ClickOutsideOptions,\n    EscapeKeyOptions,\n    DialogOptions,\n    Dialog,\n} from '@inertiaui/vanilla'\n","import { createElement, useEffect, useState, useRef, useReducer, ReactNode, ComponentType } from 'react'\nimport { default as Axios, AxiosResponse, InternalAxiosRequestConfig } from 'axios'\nimport { except, kebabCase, generateId, sameUrlPath } from './helpers'\nimport { router, usePage, progress } from '@inertiajs/react'\nimport { mergeDataIntoQueryString, type RequestPayload } from '@inertiajs/core'\nimport { createContext, useContext } from 'react'\nimport ModalRenderer from './ModalRenderer'\nimport { getConfig } from './config'\nimport type {\n    Modal,\n    ModalConfig,\n    ModalResponseData,\n    ModalStackContextValue,\n    VisitOptions,\n    ReloadOptions,\n    EventCallback,\n    ComponentResolver,\n    PageProps,\n    ModalRootProps,\n    LocalModal,\n    PrefetchOptions,\n} from './types'\n\nconst ModalStackContext = createContext<ModalStackContextValue | null>(null)\nModalStackContext.displayName = 'ModalStackContext'\n\nlet pageVersion: string | null = null\nlet resolveComponent: ComponentResolver | null = null\nlet baseUrl: string | null = null\n\n// Track the URL we're closing to (prevents navigate handler from re-setting baseUrl)\n// Only suppresses if navigate event URL matches this URL\nlet closingToBaseUrlTarget: string | null = null\n\n// Prefetch cache (#146)\ninterface PrefetchCacheEntry {\n    response: AxiosResponse\n    timestamp: number\n    expiresAt: number\n}\n\nconst prefetchCache = new Map<string, PrefetchCacheEntry>()\nconst prefetchInFlight = new Map<string, Promise<AxiosResponse>>()\n\nfunction getPrefetchCacheKey(url: string, method: string, data: RequestPayload): string {\n    return `${method}:${url}:${JSON.stringify(data)}`\n}\n\nfunction getCachedResponse(url: string, method: string, data: RequestPayload): AxiosResponse | null {\n    const key = getPrefetchCacheKey(url, method, data)\n    const cached = prefetchCache.get(key)\n\n    if (!cached) {\n        return null\n    }\n\n    if (Date.now() > cached.expiresAt) {\n        prefetchCache.delete(key)\n        return null\n    }\n\n    return cached.response\n}\n\nfunction setCachedResponse(url: string, method: string, data: RequestPayload, response: AxiosResponse, cacheFor: number): void {\n    const key = getPrefetchCacheKey(url, method, data)\n    prefetchCache.set(key, {\n        response,\n        timestamp: Date.now(),\n        expiresAt: Date.now() + cacheFor,\n    })\n}\n\nexport function prefetch(href: string, options: PrefetchOptions = {}): Promise<void> {\n    if (href.startsWith('#')) {\n        return Promise.resolve()\n    }\n\n    const method = (options.method ?? 'get').toLowerCase()\n    const data = options.data ?? ({} as RequestPayload)\n    const headers = options.headers ?? {}\n    const queryStringArrayFormat = options.queryStringArrayFormat ?? 'brackets'\n    const cacheFor = options.cacheFor ?? 30000\n\n    const [url, mergedData] = mergeDataIntoQueryString(method as 'get' | 'post' | 'put' | 'patch' | 'delete', href || '', data, queryStringArrayFormat)\n\n    // Check if already cached\n    const cached = getCachedResponse(url, method, mergedData)\n    if (cached) {\n        return Promise.resolve()\n    }\n\n    // Check if already in flight\n    const cacheKey = getPrefetchCacheKey(url, method, mergedData)\n    const inFlight = prefetchInFlight.get(cacheKey)\n    if (inFlight) {\n        return inFlight.then(() => {})\n    }\n\n    options.onPrefetching?.()\n\n    const requestHeaders: Record<string, string> = {\n        ...headers,\n        Accept: 'text/html, application/xhtml+xml',\n        'X-Requested-With': 'XMLHttpRequest',\n        'X-Inertia': 'true',\n        'X-Inertia-Version': pageVersion ?? '',\n        'X-InertiaUI-Modal': generateId(),\n        'X-InertiaUI-Modal-Base-Url': baseUrl ?? '',\n    }\n\n    const request = Axios({\n        url,\n        method,\n        data: mergedData,\n        headers: requestHeaders,\n    })\n        .then((response) => {\n            setCachedResponse(url, method, mergedData, response, cacheFor)\n            options.onPrefetched?.()\n            return response\n        })\n        .finally(() => {\n            prefetchInFlight.delete(cacheKey)\n        })\n\n    prefetchInFlight.set(cacheKey, request)\n\n    return request.then(() => {})\n}\n\ninterface ModalStackProviderProps {\n    children: ReactNode\n}\n\nexport const ModalStackProvider = ({ children }: ModalStackProviderProps) => {\n    // Use ref for synchronous access to stack, state only for triggering re-renders\n    const stackRef = useRef<Modal[]>([])\n    const [, forceUpdate] = useReducer((x) => x + 1, 0)\n    const [localModals, setLocalModals] = useState<Record<string, LocalModal>>({})\n\n    const updateStack = (withStack: (prevStack: Modal[]) => Modal[]) => {\n        const newStack = withStack([...stackRef.current])\n\n        const isOnTopOfStack = (modalId: string) => {\n            if (newStack.length < 2) {\n                return true\n            }\n\n            return (\n                newStack\n                    .map((modal) => ({ id: modal.id, shouldRender: modal.shouldRender }))\n                    .reverse()\n                    .find((modal) => modal.shouldRender)?.id === modalId\n            )\n        }\n\n        newStack.forEach((modal, index) => {\n            newStack[index].onTopOfStack = isOnTopOfStack(modal.id)\n            newStack[index].getParentModal = () => {\n                if (index < 1) {\n                    // This is the first modal in the stack\n                    return null\n                }\n\n                // Find the first open modal before this one\n                return (\n                    stackRef.current\n                        .slice(0, index)\n                        .reverse()\n                        .find((m) => m.isOpen) ?? null\n                )\n            }\n            newStack[index].getChildModal = () => {\n                if (index === stackRef.current.length - 1) {\n                    // This is the last modal in the stack\n                    return null\n                }\n\n                // Find the first open modal after this one\n                return stackRef.current.slice(index + 1).find((m) => m.isOpen) ?? null\n            }\n        })\n\n        stackRef.current = newStack\n        forceUpdate()\n    }\n\n    class ModalClass implements Modal {\n        id: string\n        isOpen: boolean\n        shouldRender: boolean\n        listeners: Record<string, EventCallback[]>\n        component: ComponentType | null\n        props: Record<string, unknown>\n        response: ModalResponseData\n        config: ModalConfig\n        onCloseCallback: (() => void) | null\n        afterLeaveCallback: (() => void) | null\n        index: number\n        onTopOfStack: boolean\n        name?: string\n        getParentModal: () => Modal | null\n        getChildModal: () => Modal | null\n\n        constructor(\n            component: ComponentType | null,\n            response: ModalResponseData,\n            config?: ModalConfig | null,\n            onClose?: (() => void) | null,\n            afterLeave?: (() => void) | null,\n        ) {\n            this.id = response.id ?? generateId()\n            this.isOpen = false\n            this.shouldRender = false\n            this.listeners = {}\n\n            this.component = component\n            this.props = response.props ?? {}\n            this.response = response\n            this.config = config ?? {}\n            this.onCloseCallback = onClose ?? null\n            this.afterLeaveCallback = afterLeave ?? null\n\n            this.index = -1 // Will be set when added to the stack\n            this.getParentModal = () => null // Will be set in push()\n            this.getChildModal = () => null // Will be set in push()\n            this.onTopOfStack = true // Will be updated in push()\n        }\n\n        show = () => {\n            updateStack((prevStack) =>\n                prevStack.map((modal) => {\n                    if (modal.id === this.id && !modal.isOpen) {\n                        modal.isOpen = true\n                        modal.shouldRender = true\n                    }\n                    return modal\n                }),\n            )\n        }\n\n        setOpen = (open: boolean) => {\n            if (open) {\n                this.show()\n            } else {\n                this.close()\n            }\n        }\n\n        close = () => {\n            updateStack((currentStack) => {\n                let modalClosed = false\n\n                const newStack = currentStack.map((modal) => {\n                    if (modal.id === this.id && modal.isOpen) {\n                        Object.keys(modal.listeners).forEach((event) => {\n                            modal.off(event)\n                        })\n\n                        modal.isOpen = false\n                        modal.onCloseCallback?.()\n                        modalClosed = true\n                    }\n                    return modal\n                })\n\n                return modalClosed ? newStack : currentStack\n            })\n        }\n\n        afterLeave = () => {\n            if (this.isOpen) {\n                return\n            }\n\n            updateStack((prevStack) => {\n                const updatedStack = prevStack.map((modal) => {\n                    if (modal.id === this.id && !modal.isOpen) {\n                        modal.shouldRender = false\n                        modal.afterLeaveCallback?.()\n                        modal.afterLeaveCallback = null\n                    }\n                    return modal\n                })\n\n                if (this.index === 0) {\n                    // Update browser URL back to base when all modals are closed\n                    // Clear baseUrl BEFORE router.push to prevent the navigate event\n                    // from setting it back (race condition with props callback)\n                    const savedBaseUrl = baseUrl\n                    baseUrl = null\n\n                    // Set target URL to prevent navigate handler from re-setting baseUrl\n                    // Only suppresses navigate events to this specific URL\n                    closingToBaseUrlTarget = savedBaseUrl\n\n                    if (savedBaseUrl && typeof window !== 'undefined') {\n                        router.push({\n                            url: savedBaseUrl,\n                            preserveScroll: true,\n                            preserveState: true,\n                            // Clear _inertiaui_modal prop to prevent modal from reopening\n                            props: (currentProps: Record<string, unknown>) => {\n                                // eslint-disable-next-line @typescript-eslint/no-unused-vars\n                                const { _inertiaui_modal, ...rest } = currentProps\n                                return { ...rest, _inertiaui_modal: undefined }\n                            },\n                        })\n                    }\n                    return []\n                }\n\n                return updatedStack\n            })\n        }\n\n        on = (event: string, callback: EventCallback) => {\n            event = kebabCase(event)\n            this.listeners[event] = this.listeners[event] ?? []\n            this.listeners[event].push(callback)\n        }\n\n        off = (event: string, callback?: EventCallback) => {\n            event = kebabCase(event)\n            if (callback) {\n                this.listeners[event] = this.listeners[event]?.filter((cb) => cb !== callback) ?? []\n            } else {\n                delete this.listeners[event]\n            }\n        }\n\n        emit = (event: string, ...args: unknown[]) => {\n            this.listeners[kebabCase(event)]?.forEach((callback) => callback(...args))\n        }\n\n        registerEventListenersFromProps = (props: Record<string, unknown>) => {\n            const unsubscribers: (() => void)[] = []\n\n            Object.keys(props)\n                .filter((key) => key.startsWith('on'))\n                .forEach((key) => {\n                    // e.g. onRefreshKey -> refresh-key\n                    const eventName = kebabCase(key).replace(/^on-/, '')\n                    const callback = props[key] as EventCallback\n                    this.on(eventName, callback)\n                    unsubscribers.push(() => this.off(eventName, callback))\n                })\n\n            return () => unsubscribers.forEach((unsub) => unsub())\n        }\n\n        reload = (options: ReloadOptions = {}) => {\n            let keys = Object.keys(this.response.props)\n\n            if (options.only) {\n                keys = options.only\n            }\n\n            if (options.except) {\n                keys = except(keys, options.except) as string[]\n            }\n\n            if (!this.response?.url) {\n                return\n            }\n\n            const method = (options.method ?? 'get').toLowerCase()\n            const data = options.data ?? {}\n\n            options.onStart?.()\n\n            Axios({\n                url: this.response.url,\n                method,\n                data: method === 'get' ? {} : data,\n                params: method === 'get' ? data : {},\n                headers: {\n                    ...(options.headers ?? {}),\n                    Accept: 'text/html, application/xhtml+xml',\n                    'X-Inertia': 'true',\n                    'X-Inertia-Partial-Component': this.response.component,\n                    'X-Inertia-Version': this.response.version ?? '',\n                    'X-Inertia-Partial-Data': keys.join(','),\n                    'X-InertiaUI-Modal': generateId(),\n                    'X-InertiaUI-Modal-Base-Url': baseUrl ?? '',\n                },\n            })\n                .then((response) => {\n                    this.updateProps(response.data.props)\n\n                    options.onSuccess?.(response)\n                })\n                .catch((error) => {\n                    options.onError?.(error)\n                })\n                .finally(() => {\n                    options.onFinish?.()\n                })\n        }\n\n        updateProps = (props: Record<string, unknown>) => {\n            Object.assign(this.props, props)\n            updateStack((prevStack) => prevStack) // Trigger re-render\n        }\n    }\n\n    const isValidModalResponse = (data: unknown): data is ModalResponseData => {\n        return (\n            typeof data === 'object' &&\n            data !== null &&\n            'component' in data &&\n            typeof (data as ModalResponseData).component === 'string'\n        )\n    }\n\n    const pushFromResponseData = (\n        responseData: ModalResponseData,\n        config: ModalConfig = {},\n        onClose: (() => void) | null = null,\n        onAfterLeave: (() => void) | null = null,\n    ): Promise<Modal> => {\n        if (!resolveComponent) {\n            return Promise.reject(new Error('resolveComponent not set'))\n        }\n\n        if (!isValidModalResponse(responseData)) {\n            return Promise.reject(\n                new Error(\n                    'Invalid modal response. This usually happens when the server returns a redirect (e.g., due to session expiration). ' +\n                        'Check if the user is still authenticated.',\n                ),\n            )\n        }\n\n        return resolveComponent(responseData.component).then((component) =>\n            push(component, responseData, config, onClose, onAfterLeave),\n        )\n    }\n\n    const loadDeferredProps = (modal: Modal) => {\n        const deferred = modal.response?.meta?.deferredProps\n\n        if (!deferred) {\n            return\n        }\n\n        Object.keys(deferred).forEach((key) => {\n            modal.reload({ only: deferred[key] })\n        })\n    }\n\n    const push = (\n        component: ComponentType | null,\n        response: ModalResponseData,\n        config?: ModalConfig | null,\n        onClose?: (() => void) | null,\n        afterLeave?: (() => void) | null,\n    ): Modal => {\n        const newModal = new ModalClass(component, response, config, onClose, afterLeave)\n        newModal.index = stackRef.current.length\n\n        updateStack((prevStack) => [...prevStack, newModal])\n        loadDeferredProps(newModal)\n\n        newModal.show()\n\n        return newModal\n    }\n\n    function pushLocalModal(\n        name: string,\n        config?: ModalConfig | null,\n        onClose?: (() => void) | null,\n        afterLeave?: (() => void) | null,\n        props?: Record<string, unknown> | null,\n    ): Modal {\n        if (!localModals[name]) {\n            throw new Error(`The local modal \"${name}\" has not been registered.`)\n        }\n\n        const responseData = { props: props ?? {} } as ModalResponseData\n        const modal = push(null, responseData, config, onClose, afterLeave)\n        modal.name = name\n        localModals[name].callback(modal)\n        return modal\n    }\n\n    const visitModal = (url: string, options: VisitOptions = {}): Promise<Modal> =>\n        visit(\n            url,\n            options.method ?? 'get',\n            options.data ?? ({} as RequestPayload),\n            options.headers ?? {},\n            options.config ?? {},\n            options.onClose ?? null,\n            options.onAfterLeave ?? null,\n            options.queryStringArrayFormat ?? 'brackets',\n            options.navigate ?? (getConfig('navigate') as boolean),\n            options.onStart ?? null,\n            options.onSuccess ?? null,\n            options.onError ?? null,\n            options.props ?? null,\n        ).then((modal) => {\n            const listeners = options.listeners ?? {}\n\n            Object.keys(listeners).forEach((event) => {\n                // e.g. refreshKey -> refresh-key\n                const eventName = kebabCase(event)\n                modal.on(eventName, listeners[event])\n            })\n\n            return modal\n        })\n\n    const updateBrowserUrl = (url: string | undefined, useBrowserHistory: boolean, modalData?: ModalResponseData): void => {\n        if (!url || !useBrowserHistory || typeof window === 'undefined') {\n            return\n        }\n\n        router.push({\n            url,\n            preserveScroll: true,\n            preserveState: true,\n            // Store modal data in page props for history navigation\n            props: modalData\n                ? (currentProps: Record<string, unknown>) => ({\n                      ...currentProps,\n                      _inertiaui_modal: {\n                          ...modalData,\n                          baseUrl,\n                      },\n                  })\n                : undefined,\n        })\n    }\n\n    const visit = (\n        href: string,\n        method: string,\n        payload: RequestPayload = {},\n        headers: Record<string, string> = {},\n        config: ModalConfig = {},\n        onClose: (() => void) | null = null,\n        onAfterLeave: (() => void) | null = null,\n        queryStringArrayFormat: 'brackets' | 'indices' = 'brackets',\n        useBrowserHistory = false,\n        onStart: (() => void) | null = null,\n        onSuccess: ((response?: AxiosResponse) => void) | null = null,\n        onError: ((...args: unknown[]) => void) | null = null,\n        props: Record<string, unknown> | null = null,\n    ): Promise<Modal> => {\n        const modalId = generateId()\n\n        return new Promise((resolve, reject) => {\n            if (href.startsWith('#')) {\n                resolve(pushLocalModal(href.substring(1), config, onClose, onAfterLeave, props))\n                return\n            }\n\n            const [url, data] = mergeDataIntoQueryString(method as 'get' | 'post' | 'put' | 'patch' | 'delete', href || '', payload, queryStringArrayFormat)\n\n            // Check for cached prefetch response (#146)\n            const cachedResponse = getCachedResponse(url, method, data)\n            if (cachedResponse) {\n                onSuccess?.(cachedResponse)\n                pushFromResponseData(cachedResponse.data, config, onClose, onAfterLeave)\n                    .then((modal) => {\n                        updateBrowserUrl(cachedResponse.data.url, useBrowserHistory, cachedResponse.data)\n                        resolve(modal)\n                    })\n                    .catch(reject)\n                return\n            }\n\n            if (stackRef.current.length === 0) {\n                baseUrl = typeof window !== 'undefined' ? window.location.href : ''\n            }\n\n            const requestHeaders: Record<string, string> = {\n                ...headers,\n                Accept: 'text/html, application/xhtml+xml',\n                'X-Requested-With': 'XMLHttpRequest',\n                'X-Inertia': 'true',\n                'X-Inertia-Version': pageVersion ?? '',\n                'X-InertiaUI-Modal': modalId,\n                'X-InertiaUI-Modal-Base-Url': baseUrl ?? '',\n            }\n\n            onStart?.()\n\n            progress?.start()\n\n            Axios({\n                url,\n                method,\n                data,\n                headers: requestHeaders,\n            })\n                .then((response) => {\n                    onSuccess?.(response)\n                    pushFromResponseData(response.data, config, onClose, onAfterLeave)\n                        .then((modal) => {\n                            updateBrowserUrl(response.data.url, useBrowserHistory, response.data)\n                            resolve(modal)\n                        })\n                        .catch(reject)\n                })\n                .catch((...args: unknown[]) => {\n                    onError?.(...args)\n                    reject(args[0])\n                })\n                .finally(() => {\n                    progress?.finish()\n                })\n        })\n    }\n\n    const registerLocalModal = (name: string, callback: (modal: Modal) => void) => {\n        setLocalModals((prevLocalModals) => ({\n            ...prevLocalModals,\n            [name]: { name, callback },\n        }))\n    }\n\n    const removeLocalModal = (name: string) => {\n        setLocalModals((prevLocalModals) => {\n            const newLocalModals = { ...prevLocalModals }\n            delete newLocalModals[name]\n            return newLocalModals\n        })\n    }\n\n    // Create value object with getter for stack to ensure we always get current ref value\n    const value: ModalStackContextValue = {\n        get stack() {\n            return stackRef.current\n        },\n        localModals,\n        push,\n        pushFromResponseData,\n        length: () => stackRef.current.length,\n        closeAll: (force = false) => {\n            if (force) {\n                // Force close: immediately remove all modals without transition\n                updateStack(() => [])\n            } else {\n                // Normal close: trigger leave transition for each modal\n                ;[...stackRef.current].reverse().forEach((modal) => modal.close())\n            }\n        },\n        reset: () => updateStack(() => []),\n        visit,\n        visitModal,\n        registerLocalModal,\n        removeLocalModal,\n    }\n\n    return <ModalStackContext.Provider value={value}>{children}</ModalStackContext.Provider>\n}\n\nexport const useModalStack = (): ModalStackContextValue => {\n    const context = useContext(ModalStackContext)\n    if (context === null) {\n        throw new Error('useModalStack must be used within a ModalStackProvider')\n    }\n    return context\n}\n\nexport const modalPropNames = ['closeButton', 'closeExplicitly', 'closeOnClickOutside', 'maxWidth', 'paddingClasses', 'panelClasses', 'position', 'slideover']\n\nexport const initFromPageProps = (pageProps: PageProps) => {\n    if (pageProps.initialPage) {\n        pageVersion = pageProps.initialPage.version ?? null\n    }\n\n    if (pageProps.resolveComponent) {\n        resolveComponent = pageProps.resolveComponent\n    }\n}\n\ninterface RenderInertiaAppProps {\n    Component: ComponentType & { layout?: ((page: ReactNode) => ReactNode) | ComponentType[] }\n    props: Record<string, unknown>\n    key: string\n}\n\nexport const renderApp = (App: ComponentType<{ children: (props: RenderInertiaAppProps) => ReactNode }>, pageProps: PageProps) => {\n    initFromPageProps(pageProps)\n\n    const renderInertiaApp = ({ Component, props, key }: RenderInertiaAppProps) => {\n        const renderComponent = () => {\n            const child = createElement(Component, { key, ...props })\n\n            if (typeof Component.layout === 'function') {\n                return Component.layout(child)\n            }\n\n            if (Array.isArray(Component.layout)) {\n                return Component.layout\n                    .slice()\n                    .reverse()\n                    .reduce(\n                        (acc, Layout) => createElement(Layout as ComponentType<Record<string, unknown>>, props, acc),\n                        child as ReactNode,\n                    )\n            }\n\n            return child\n        }\n\n        return (\n            <>\n                {renderComponent()}\n                <ModalRoot />\n            </>\n        )\n    }\n\n    return (\n        <ModalStackProvider>\n            <App {...(pageProps as Record<string, unknown>)}>{renderInertiaApp}</App>\n        </ModalStackProvider>\n    )\n}\n\ninterface InertiaUIModalPageProps {\n    _inertiaui_modal?: ModalResponseData & { baseUrl: string }\n    [key: string]: unknown\n}\n\nexport const ModalRoot = ({ children }: ModalRootProps) => {\n    const context = useContext(ModalStackContext)\n    const $page = usePage<InertiaUIModalPageProps>()\n    const pendingModalKeysRef = useRef(new Set<string>())\n\n    // Generate a unique key for deduplication (handles case when modal has no id)\n    const getModalKey = (modalData: ModalResponseData) => modalData.id || `${modalData.component}:${modalData.url}`\n\n    const isNavigatingRef = useRef(false)\n    const initialModalStillOpenedRef = useRef(!!$page.props?._inertiaui_modal)\n\n    useEffect(() => router.on('start', () => (isNavigatingRef.current = true)), [])\n    useEffect(() => router.on('finish', () => (isNavigatingRef.current = false)), [])\n    useEffect(\n        () =>\n            router.on('navigate', function ($event) {\n                const modalOnBase = ($event as { detail: { page: { props: InertiaUIModalPageProps; url: string } } }).detail.page.props._inertiaui_modal\n                const pageUrl = ($event as { detail: { page: { url: string } } }).detail.page.url\n\n                // If we're closing to this specific URL, don't re-open the modal\n                // This handles the race condition where router.push in afterLeave\n                // fires a navigate event before the props callback clears _inertiaui_modal\n                // Only suppresses when navigating to our closing target URL (not browser back to modal)\n                if (closingToBaseUrlTarget) {\n                    const targetPath = new URL(closingToBaseUrlTarget, 'http://x').pathname\n                    const pagePath = new URL(pageUrl, 'http://x').pathname\n                    if (targetPath === pagePath) {\n                        closingToBaseUrlTarget = null\n                        context?.closeAll(true)\n                        baseUrl = null\n                        initialModalStillOpenedRef.current = false\n                        return\n                    }\n                    closingToBaseUrlTarget = null\n                }\n\n                if (!modalOnBase) {\n                    // No modal data - close any open modals (force close without transition)\n                    context?.closeAll(true)\n                    baseUrl = null\n                    initialModalStillOpenedRef.current = false\n                    return\n                }\n\n                // If the page URL doesn't match the modal URL, close all modals\n                if (!sameUrlPath(pageUrl, modalOnBase.url)) {\n                    context?.closeAll(true)\n                    baseUrl = null\n                    initialModalStillOpenedRef.current = false\n                    return\n                }\n\n                // Skip if this modal is already being pushed (handles duplicate navigate events)\n                const modalKey = getModalKey(modalOnBase)\n                if (pendingModalKeysRef.current.has(modalKey)) {\n                    return\n                }\n\n                // Also skip if a modal with this id is already in the stack\n                if (modalOnBase.id && context?.stack.some((m) => m.id === modalOnBase.id)) {\n                    return\n                }\n\n                // Skip if a modal with the same component and URL is already open\n                if (context?.stack.some((m) => m.response?.component === modalOnBase.component && sameUrlPath(m.response?.url, modalOnBase.url))) {\n                    return\n                }\n\n                // Only set baseUrl when we're actually opening a new modal\n                // (after deduplication checks pass)\n                baseUrl = modalOnBase.baseUrl\n\n                pendingModalKeysRef.current.add(modalKey)\n\n                context\n                    ?.pushFromResponseData(modalOnBase, {}, () => {\n                        if (!modalOnBase.baseUrl) {\n                            console.error('No base url in modal response data so cannot navigate back')\n                            return\n                        }\n                        if (!isNavigatingRef.current && typeof window !== 'undefined' && window.location.href !== modalOnBase.baseUrl) {\n                            router.visit(modalOnBase.baseUrl, {\n                                preserveScroll: true,\n                                preserveState: true,\n                            })\n                        }\n                    })\n                    .finally(() => {\n                        pendingModalKeysRef.current.delete(modalKey)\n                    })\n            }),\n        [],\n    )\n\n    const axiosRequestInterceptor = (config: InternalAxiosRequestConfig) => {\n        // A Modal is opened on top of a base route, so we need to pass this base route\n        // so it can redirect back with the back() helper method...\n        // Only send the header when we have an actual base URL value\n        const baseUrlValue = baseUrl ?? (initialModalStillOpenedRef.current ? $page.props._inertiaui_modal?.baseUrl : null)\n        if (baseUrlValue) {\n            config.headers['X-InertiaUI-Modal-Base-Url'] = baseUrlValue\n        }\n\n        return config\n    }\n\n    useEffect(() => {\n        const interceptorId = Axios.interceptors.request.use(axiosRequestInterceptor)\n        return () => Axios.interceptors.request.eject(interceptorId)\n    }, [])\n\n    const previousModalRef = useRef<(ModalResponseData & { baseUrl: string }) | undefined>(undefined)\n\n    useEffect(() => {\n        const newModal = $page.props?._inertiaui_modal\n        const previousModal = previousModalRef.current\n\n        // Store the current value for the next render\n        previousModalRef.current = newModal\n\n        if (!newModal) {\n            return\n        }\n\n        // If there's a previous modal with same component/URL, update its props\n        if (previousModal && newModal.component === previousModal.component && sameUrlPath(newModal.url, previousModal.url)) {\n            context?.stack[0]?.updateProps(newModal.props ?? {})\n            return\n        }\n\n        // If there's no previous modal but we have modals in the stack (opened via XHR),\n        // check if the new modal matches any open modal and update its props\n        if (!previousModal && context && context.stack.length > 0) {\n            const existingModal = context.stack.find(\n                (m) => m.response?.component === newModal.component && sameUrlPath(m.response?.url, newModal.url),\n            )\n            if (existingModal) {\n                existingModal.updateProps(newModal.props ?? {})\n            }\n        }\n    }, [$page.props?._inertiaui_modal])\n\n    return (\n        <>\n            {children}\n            {context && context.stack.length > 0 && <ModalRenderer index={0} />}\n        </>\n    )\n}\n","import React, { useMemo, createElement } from 'react'\nimport { useModalStack } from './ModalRoot'\nimport type { ModalRendererProps } from './types'\n\nconst ModalIndexContext = React.createContext<number | null>(null)\nModalIndexContext.displayName = 'ModalIndexContext'\n\nexport const useModalIndex = (): number | null => {\n    return React.useContext(ModalIndexContext)\n}\n\nconst ModalRenderer = ({ index }: ModalRendererProps) => {\n    const { stack } = useModalStack()\n\n    const modalContext = useMemo(() => {\n        return stack[index]\n    }, [stack, index])\n\n    if (!modalContext?.component) {\n        return null\n    }\n\n    return (\n        <ModalIndexContext.Provider value={index}>\n            {createElement(modalContext.component as React.ComponentType<Record<string, unknown>>, {\n                ...modalContext.props,\n                onModalEvent: (...args: unknown[]) => modalContext.emit('modal-event', ...args),\n            })}\n        </ModalIndexContext.Provider>\n    )\n}\n\nexport default ModalRenderer\n","import { useModalIndex } from './ModalRenderer'\nimport { useModalStack } from './ModalRoot'\nimport type { Modal } from './types'\n\nexport default function useModal(): Modal | null {\n    return useModalStack().stack[useModalIndex()] ?? null\n}\n","// See: https://github.com/inertiajs/inertia/blob/48bcd21fb7daf467d0df1bfde2408f161f94a579/packages/react/src/Deferred.ts\nimport { useEffect, useState, ReactNode } from 'react'\nimport useModal from './useModal'\n\ninterface DeferredProps {\n    children: ReactNode\n    data: string | string[]\n    fallback?: ReactNode\n}\n\nconst Deferred = ({ children, data, fallback }: DeferredProps) => {\n    if (!data) {\n        throw new Error('`<Deferred>` requires a `data` prop to be a string or array of strings')\n    }\n\n    const [loaded, setLoaded] = useState(false)\n    const keys = Array.isArray(data) ? data : [data]\n    const modal = useModal()\n    const modalProps = modal?.props ?? {}\n\n    useEffect(() => {\n        setLoaded(keys.every((key) => modalProps[key] !== undefined))\n    }, [modalProps, keys])\n\n    return loaded ? children : fallback\n}\n\nDeferred.displayName = 'InertiaModalDeferred'\n\nexport default Deferred\n","import { useMemo, useState, forwardRef, useImperativeHandle, useEffect, useRef, ReactNode } from 'react'\nimport { getConfig, getConfigByType } from './config'\nimport { useModalIndex } from './ModalRenderer'\nimport { useModalStack } from './ModalRoot'\nimport ModalRenderer from './ModalRenderer'\nimport type { Modal, ModalConfig, ReloadOptions } from './types'\n\ninterface HeadlessModalConfig {\n    slideover: boolean\n    closeButton: boolean\n    closeExplicitly: boolean\n    closeOnClickOutside: boolean\n    maxWidth: string\n    paddingClasses: string\n    panelClasses: string\n    position: string\n}\n\ninterface HeadlessModalRenderProps {\n    afterLeave: () => void\n    close: () => void\n    config: HeadlessModalConfig\n    emit: (event: string, ...args: unknown[]) => void\n    getChildModal: () => Modal | null\n    getParentModal: () => Modal | null\n    id: string\n    index: number\n    isOpen: boolean\n    modalContext: Modal\n    onTopOfStack: boolean\n    reload: (options?: ReloadOptions) => void\n    setOpen: (open: boolean) => void\n    shouldRender: boolean\n    // Allow additional props from visitModal\n    [key: string]: unknown\n}\n\ninterface HeadlessModalBaseProps {\n    name?: string\n    children: ReactNode | ((props: HeadlessModalRenderProps) => ReactNode)\n    onFocus?: () => void\n    onBlur?: () => void\n    onClose?: () => void\n    onSuccess?: () => void\n    slideover?: boolean\n    closeButton?: boolean\n    closeExplicitly?: boolean\n    closeOnClickOutside?: boolean\n    maxWidth?: string\n    paddingClasses?: string\n    panelClasses?: string\n    position?: string\n}\n\ntype HeadlessModalProps = HeadlessModalBaseProps & Record<string, unknown>\n\nexport interface HeadlessModalRef {\n    afterLeave: () => void\n    close: () => void\n    emit: (event: string, ...args: unknown[]) => void\n    getChildModal: () => Modal | null | undefined\n    getParentModal: () => Modal | null | undefined\n    reload: (options?: ReloadOptions) => void\n    setOpen: (open: boolean) => void\n    readonly id: string | undefined\n    readonly index: number | undefined\n    readonly isOpen: boolean | undefined\n    readonly config: ModalConfig | undefined\n    readonly modalContext: Modal | null\n    readonly onTopOfStack: boolean | undefined\n    readonly shouldRender: boolean | undefined\n}\n\nconst HeadlessModal = forwardRef<HeadlessModalRef, HeadlessModalProps>(\n    (allProps, ref) => {\n        const { name, children, onFocus, onBlur, onClose, onSuccess, ...props } = allProps as HeadlessModalBaseProps & Record<string, unknown>\n        const modalIndex = useModalIndex()\n        const { stack, registerLocalModal, removeLocalModal } = useModalStack()\n\n        const [localModalContext, setLocalModalContext] = useState<Modal | null>(null)\n        const modalContext = useMemo(\n            () => (name ? localModalContext : stack[modalIndex]),\n            [name, localModalContext, modalIndex, stack],\n        )\n\n        const nextIndex = useMemo(() => {\n            return stack.find((m) => m.shouldRender && m.index > (modalContext?.index ?? -1))?.index\n        }, [modalIndex, stack])\n\n        const configSlideover = useMemo(\n            () => modalContext?.config.slideover ?? props.slideover ?? getConfig('type') === 'slideover',\n            [props.slideover, modalContext?.config.slideover],\n        )\n\n        const config: HeadlessModalConfig = useMemo(\n            () => ({\n                slideover: configSlideover as boolean,\n                closeButton: (props.closeButton ?? getConfigByType(configSlideover as boolean, 'closeButton')) as boolean,\n                closeExplicitly: (props.closeExplicitly ?? getConfigByType(configSlideover as boolean, 'closeExplicitly')) as boolean,\n                closeOnClickOutside: (props.closeOnClickOutside ?? getConfigByType(configSlideover as boolean, 'closeOnClickOutside')) as boolean,\n                maxWidth: (props.maxWidth ?? getConfigByType(configSlideover as boolean, 'maxWidth')) as string,\n                paddingClasses: (props.paddingClasses ?? getConfigByType(configSlideover as boolean, 'paddingClasses')) as string,\n                panelClasses: (props.panelClasses ?? getConfigByType(configSlideover as boolean, 'panelClasses')) as string,\n                position: (props.position ?? getConfigByType(configSlideover as boolean, 'position')) as string,\n                ...modalContext?.config,\n            }),\n            [props, modalContext?.config, configSlideover],\n        )\n\n        useEffect(() => {\n            if (name) {\n                let removeListeners: (() => void) | null = null\n\n                registerLocalModal(name as string, (localContext) => {\n                    removeListeners = localContext.registerEventListenersFromProps(props as Record<string, unknown>)\n                    setLocalModalContext(localContext)\n                })\n\n                return () => {\n                    removeListeners?.()\n                    removeListeners = null\n                    removeLocalModal(name as string)\n                }\n            }\n\n            return modalContext?.registerEventListenersFromProps(props as Record<string, unknown>)\n        }, [name])\n\n        // Store the latest modalContext in a ref to maintain reference\n        const modalContextRef = useRef(modalContext)\n\n        // Update the ref whenever modalContext changes\n        useEffect(() => {\n            modalContextRef.current = modalContext\n        }, [modalContext])\n\n        // Track previous isOpen value to only emit close when transitioning from true to false\n        const previousIsOpenRef = useRef<boolean | undefined>(undefined)\n\n        useEffect(() => {\n            if (modalContext !== null) {\n                if (modalContext.isOpen) {\n                    onSuccess?.()\n                } else if (previousIsOpenRef.current === true) {\n                    // Only call onClose when transitioning from open to closed,\n                    // not when the component first mounts with isOpen undefined/false\n                    onClose?.()\n                }\n                previousIsOpenRef.current = modalContext.isOpen\n            }\n        }, [modalContext?.isOpen])\n\n        const [rendered, setRendered] = useState(false)\n\n        useEffect(() => {\n            if (rendered && modalContext !== null && modalContext.isOpen) {\n                if (modalContext.onTopOfStack) {\n                    onFocus?.()\n                } else {\n                    onBlur?.()\n                }\n            }\n\n            setRendered(true)\n        }, [modalContext?.onTopOfStack])\n\n        useImperativeHandle(\n            ref,\n            () => ({\n                afterLeave: () => modalContextRef.current?.afterLeave(),\n                close: () => modalContextRef.current?.close(),\n                emit: (...args: [string, ...unknown[]]) => modalContextRef.current?.emit(...args),\n                getChildModal: () => modalContextRef.current?.getChildModal(),\n                getParentModal: () => modalContextRef.current?.getParentModal(),\n                reload: (options?: ReloadOptions) => modalContextRef.current?.reload(options),\n                setOpen: (open: boolean) => modalContextRef.current?.setOpen(open),\n\n                get id() {\n                    return modalContextRef.current?.id\n                },\n                get index() {\n                    return modalContextRef.current?.index\n                },\n                get isOpen() {\n                    return modalContextRef.current?.isOpen\n                },\n                get config() {\n                    return modalContextRef.current?.config\n                },\n                get modalContext() {\n                    return modalContextRef.current\n                },\n                get onTopOfStack() {\n                    return modalContextRef.current?.onTopOfStack\n                },\n                get shouldRender() {\n                    return modalContextRef.current?.shouldRender\n                },\n            }),\n            [modalContext],\n        )\n\n        if (!modalContext?.shouldRender) {\n            return null\n        }\n\n        return (\n            <>\n                {typeof children === 'function'\n                    ? children({\n                          // Spread props first so they can be overridden by built-in props\n                          ...modalContext.props,\n                          afterLeave: modalContext.afterLeave,\n                          close: modalContext.close,\n                          config,\n                          emit: modalContext.emit,\n                          getChildModal: modalContext.getChildModal,\n                          getParentModal: modalContext.getParentModal,\n                          id: modalContext.id,\n                          index: modalContext.index,\n                          isOpen: modalContext.isOpen,\n                          modalContext,\n                          onTopOfStack: modalContext.onTopOfStack,\n                          reload: modalContext.reload,\n                          setOpen: modalContext.setOpen,\n                          shouldRender: modalContext.shouldRender,\n                      })\n                    : children}\n\n                {/* Next modal in the stack */}\n                {nextIndex !== undefined && <ModalRenderer index={nextIndex} />}\n            </>\n        )\n    },\n)\n\nHeadlessModal.displayName = 'HeadlessModal'\nexport default HeadlessModal\n","interface CloseButtonProps {\n    onClick: () => void\n}\n\nexport default function CloseButton({ onClick }: CloseButtonProps) {\n    return (\n        <button\n            type=\"button\"\n            className=\"im-close-button text-gray-400 hover:text-gray-500\"\n            onClick={onClick}\n        >\n            <span className=\"sr-only\">Close</span>\n            <svg\n                className=\"size-6\"\n                xmlns=\"http://www.w3.org/2000/svg\"\n                fill=\"none\"\n                viewBox=\"0 0 24 24\"\n                strokeWidth=\"2\"\n                stroke=\"currentColor\"\n                aria-hidden=\"true\"\n            >\n                <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    d=\"M6 18L18 6M6 6l12 12\"\n                />\n            </svg>\n        </button>\n    )\n}\n","function r(e){var t,f,n=\"\";if(\"string\"==typeof e||\"number\"==typeof e)n+=e;else if(\"object\"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(f=r(e[t]))&&(n&&(n+=\" \"),n+=f)}else for(f in e)e[f]&&(n&&(n+=\" \"),n+=f);return n}export function clsx(){for(var e,t,f=0,n=\"\",o=arguments.length;f<o;f++)(e=arguments[f])&&(t=r(e))&&(n&&(n+=\" \"),n+=t);return n}export default clsx;","/**\n * Max width classes for modals and slideovers.\n * Uses a map lookup for Tailwind 4 compatibility (scanner picks up full class strings).\n */\nexport const maxWidthClasses: Record<string, string> = {\n    sm: 'sm:max-w-sm',\n    md: 'sm:max-w-md',\n    lg: 'sm:max-w-md md:max-w-lg',\n    xl: 'sm:max-w-md md:max-w-xl',\n    '2xl': 'sm:max-w-md md:max-w-xl lg:max-w-2xl',\n    '3xl': 'sm:max-w-md md:max-w-xl lg:max-w-3xl',\n    '4xl': 'sm:max-w-md md:max-w-xl lg:max-w-3xl xl:max-w-4xl',\n    '5xl': 'sm:max-w-md md:max-w-xl lg:max-w-3xl xl:max-w-5xl',\n    '6xl': 'sm:max-w-md md:max-w-xl lg:max-w-3xl xl:max-w-5xl 2xl:max-w-6xl',\n    '7xl': 'sm:max-w-md md:max-w-xl lg:max-w-3xl xl:max-w-5xl 2xl:max-w-7xl',\n}\n\nexport const defaultMaxWidth = '2xl'\n\nexport function getMaxWidthClass(maxWidth: string): string {\n    return maxWidthClasses[maxWidth] || maxWidthClasses[defaultMaxWidth]\n}\n","import { useState, useEffect, useRef, useCallback, useMemo, ReactNode, SyntheticEvent, MouseEvent } from 'react'\nimport CloseButton from './CloseButton'\nimport clsx from 'clsx'\nimport { createFocusTrap, onEscapeKey, onTransitionEnd } from '@inertiaui/vanilla'\nimport { getMaxWidthClass } from './constants'\nimport type { Modal } from './types'\n\ninterface ModalContentConfig {\n    maxWidth: string\n    paddingClasses: string\n    panelClasses: string\n    position: string\n    closeButton: boolean\n    closeExplicitly?: boolean\n    closeOnClickOutside?: boolean\n}\n\ninterface ModalContentProps {\n    modalContext: Modal\n    config: ModalContentConfig\n    useNativeDialog: boolean\n    isFirstModal: boolean\n    onAfterLeave?: () => void\n    children: ReactNode | ((props: { modalContext: Modal; config: ModalContentConfig }) => ReactNode)\n}\n\nconst ModalContent = ({ modalContext, config, useNativeDialog, isFirstModal, onAfterLeave, children }: ModalContentProps) => {\n    const [entered, setEntered] = useState(false)\n    const [isLeaving, setIsLeaving] = useState(false)\n    const [transitionState, setTransitionState] = useState<'entering' | 'entered' | 'leaving' | 'exited'>('entering')\n    const wrapperRef = useRef<HTMLDivElement>(null)\n    const dialogRef = useRef<HTMLDialogElement>(null)\n    const nativeWrapperRef = useRef<HTMLDivElement>(null)\n    const cleanupFocusTrapRef = useRef<(() => void) | null>(null)\n    const cleanupEscapeKeyRef = useRef<(() => void) | null>(null)\n    const initialRender = useRef(true)\n\n    const maxWidthClass = useMemo(() => getMaxWidthClass(config.maxWidth), [config.maxWidth])\n\n    // ============ Non-native dialog handlers ============\n\n    const setupFocusTrap = useCallback(() => {\n        if (useNativeDialog) return\n        if (!wrapperRef.current || !modalContext.onTopOfStack) return\n        if (cleanupFocusTrapRef.current) return\n\n        cleanupFocusTrapRef.current = createFocusTrap(wrapperRef.current, {\n            initialFocus: true,\n            returnFocus: false,\n        })\n    }, [modalContext.onTopOfStack, useNativeDialog])\n\n    const cleanupFocusTrap = useCallback(() => {\n        if (cleanupFocusTrapRef.current) {\n            cleanupFocusTrapRef.current()\n            cleanupFocusTrapRef.current = null\n        }\n    }, [])\n\n    const setupEscapeKey = useCallback(() => {\n        if (useNativeDialog) return\n        if (cleanupEscapeKeyRef.current) return\n        if (config?.closeExplicitly) return\n\n        cleanupEscapeKeyRef.current = onEscapeKey(() => {\n            if (modalContext.onTopOfStack) {\n                modalContext.close()\n            }\n        })\n    }, [config?.closeExplicitly, modalContext, useNativeDialog])\n\n    const cleanupEscapeKey = useCallback(() => {\n        if (cleanupEscapeKeyRef.current) {\n            cleanupEscapeKeyRef.current()\n            cleanupEscapeKeyRef.current = null\n        }\n    }, [])\n\n    const handleClickOutside = useCallback(\n        (event: MouseEvent) => {\n            if (useNativeDialog) return\n            if (!modalContext.onTopOfStack) return\n            if (config?.closeExplicitly) return\n            if (config?.closeOnClickOutside === false) return\n            if (!wrapperRef.current) return\n\n            if (!wrapperRef.current.contains(event.target as Node)) {\n                modalContext.close()\n            }\n        },\n        [modalContext, config?.closeExplicitly, config?.closeOnClickOutside, useNativeDialog],\n    )\n\n    // ============ Native dialog handlers ============\n\n    const handleCancel = useCallback(\n        (event: SyntheticEvent) => {\n            event.preventDefault()\n            if (modalContext.onTopOfStack && !config?.closeExplicitly) {\n                modalContext.close()\n            }\n        },\n        [modalContext, config?.closeExplicitly],\n    )\n\n    const handleDialogClick = useCallback(\n        (event: MouseEvent) => {\n            if (event.target === dialogRef.current) {\n                if (modalContext.onTopOfStack && !config?.closeExplicitly && config?.closeOnClickOutside !== false) {\n                    modalContext.close()\n                }\n            }\n        },\n        [modalContext, config?.closeExplicitly, config?.closeOnClickOutside],\n    )\n\n    const openDialog = useCallback(() => {\n        if (dialogRef.current && !dialogRef.current.open) {\n            dialogRef.current.showModal()\n            requestAnimationFrame(() => {\n                requestAnimationFrame(() => {\n                    setEntered(true)\n                })\n            })\n        }\n    }, [])\n\n    const finishClose = useCallback(() => {\n        if (dialogRef.current) {\n            dialogRef.current.close()\n        }\n        setIsLeaving(false)\n        onAfterLeave?.()\n        modalContext.afterLeave()\n    }, [onAfterLeave, modalContext])\n\n    const closeDialog = useCallback(() => {\n        if (dialogRef.current && dialogRef.current.open) {\n            setIsLeaving(true)\n            setEntered(false)\n\n            const wrapper = nativeWrapperRef.current\n            if (wrapper) {\n                onTransitionEnd(wrapper, finishClose)\n            } else {\n                finishClose()\n            }\n        }\n    }, [finishClose])\n\n    // ============ Lifecycle ============\n\n    // Initial mount\n    useEffect(() => {\n        if (useNativeDialog) {\n            if (modalContext.isOpen) {\n                openDialog()\n            }\n        } else {\n            setupEscapeKey()\n        }\n        return () => {\n            if (useNativeDialog) {\n                if (dialogRef.current?.open) {\n                    dialogRef.current.close()\n                }\n            } else {\n                cleanupFocusTrap()\n                cleanupEscapeKey()\n            }\n        }\n    }, [])\n\n    // Handle becoming top of stack / losing top of stack (non-native only)\n    useEffect(() => {\n        if (useNativeDialog) return\n\n        if (modalContext.onTopOfStack) {\n            setupEscapeKey()\n            if (entered) {\n                setupFocusTrap()\n            }\n        } else {\n            cleanupFocusTrap()\n            cleanupEscapeKey()\n        }\n    }, [modalContext.onTopOfStack, entered, setupEscapeKey, setupFocusTrap, cleanupFocusTrap, cleanupEscapeKey, useNativeDialog])\n\n    // Handle enter animation (non-native only)\n    useEffect(() => {\n        if (useNativeDialog) return\n\n        if (initialRender.current && modalContext.isOpen) {\n            initialRender.current = false\n            requestAnimationFrame(() => {\n                requestAnimationFrame(() => {\n                    setTransitionState('entered')\n                    const wrapper = wrapperRef.current\n                    if (wrapper) {\n                        onTransitionEnd(wrapper, () => {\n                            setEntered(true)\n                            setupFocusTrap()\n                        })\n                    }\n                })\n            })\n        }\n    }, [modalContext.isOpen, setupFocusTrap, useNativeDialog])\n\n    // Handle leave animation (non-native only)\n    useEffect(() => {\n        if (useNativeDialog) return\n\n        if (!modalContext.isOpen && transitionState === 'entered') {\n            setTransitionState('leaving')\n            const wrapper = wrapperRef.current\n            if (wrapper) {\n                onTransitionEnd(wrapper, () => {\n                    setTransitionState('exited')\n                    onAfterLeave?.()\n                    modalContext.afterLeave()\n                })\n            }\n        }\n    }, [modalContext.isOpen, transitionState, onAfterLeave, modalContext, useNativeDialog])\n\n    // Watch for open state changes (native only)\n    useEffect(() => {\n        if (!useNativeDialog) return\n\n        if (modalContext.isOpen) {\n            openDialog()\n        } else if (!isLeaving) {\n            closeDialog()\n        }\n    }, [modalContext.isOpen, openDialog, closeDialog, isLeaving, useNativeDialog])\n\n    // ============ Render ============\n\n    const renderContent = () => (\n        <div\n            className={`im-modal-content relative ${config.paddingClasses} ${config.panelClasses}`}\n            data-inertiaui-modal-entered={entered}\n        >\n            {config.closeButton && (\n                <div className=\"absolute right-0 top-0 pr-3 pt-3\">\n                    <CloseButton onClick={modalContext.close} />\n                </div>\n            )}\n            {typeof children === 'function' ? children({ modalContext, config }) : children}\n        </div>\n    )\n\n    // Native dialog mode\n    if (useNativeDialog) {\n        return (\n            <dialog\n                ref={dialogRef}\n                className={clsx(\n                    'im-modal-dialog m-0 overflow-visible bg-transparent p-0',\n                    'size-full max-h-none max-w-none',\n                    'backdrop:bg-black/75 backdrop:transition-opacity backdrop:duration-300',\n                    entered ? 'backdrop:opacity-100' : 'backdrop:opacity-0',\n                    !isFirstModal && 'backdrop:bg-transparent',\n                )}\n                onCancel={handleCancel}\n                onClick={handleDialogClick}\n            >\n                <div className=\"im-modal-container fixed inset-0 overflow-y-auto p-4\">\n                    <div\n                        className={clsx('im-modal-positioner flex min-h-full justify-center', {\n                            'items-start': config.position === 'top',\n                            'items-center': config.position === 'center',\n                            'items-end': config.position === 'bottom',\n                        })}\n                    >\n                        <div\n                            ref={nativeWrapperRef}\n                            className={clsx(\n                                'im-modal-wrapper w-full transition duration-300 ease-in-out',\n                                modalContext.onTopOfStack ? '' : 'blur-xs',\n                                entered && !isLeaving ? 'translate-y-0 opacity-100 sm:scale-100' : 'translate-y-4 opacity-0 sm:translate-y-0 sm:scale-95',\n                                maxWidthClass,\n                            )}\n                        >\n                            {renderContent()}\n                        </div>\n                    </div>\n                </div>\n            </dialog>\n        )\n    }\n\n    // Non-native dialog mode\n    if (transitionState === 'exited') return null\n\n    const isEntering = transitionState === 'entering'\n    const isLeavingNonNative = transitionState === 'leaving'\n\n    return (\n        <div\n            className=\"im-modal-container fixed inset-0 z-40 overflow-y-auto p-4\"\n            onMouseDown={handleClickOutside}\n        >\n            <div\n                className={clsx('im-modal-positioner flex min-h-full justify-center', {\n                    'items-start': config.position === 'top',\n                    'items-center': config.position === 'center',\n                    'items-end': config.position === 'bottom',\n                })}\n                onMouseDown={handleClickOutside}\n            >\n                <div\n                    ref={wrapperRef}\n                    role=\"dialog\"\n                    aria-modal=\"true\"\n                    className={clsx(\n                        'im-modal-wrapper w-full transition duration-300 ease-in-out',\n                        modalContext.onTopOfStack ? '' : 'blur-xs',\n                        isEntering || isLeavingNonNative ? 'translate-y-4 opacity-0 sm:translate-y-0 sm:scale-95' : 'translate-y-0 opacity-100 sm:scale-100',\n                        maxWidthClass,\n                    )}\n                >\n                    <span className=\"sr-only\">Dialog</span>\n                    {renderContent()}\n                </div>\n            </div>\n        </div>\n    )\n}\n\nexport default ModalContent\n","import { useState, useEffect, useRef, useCallback, useMemo, ReactNode, SyntheticEvent, MouseEvent } from 'react'\nimport CloseButton from './CloseButton'\nimport clsx from 'clsx'\nimport { createFocusTrap, onEscapeKey, onTransitionEnd } from '@inertiaui/vanilla'\nimport { getMaxWidthClass } from './constants'\nimport type { Modal } from './types'\n\ninterface SlideoverContentConfig {\n    maxWidth: string\n    paddingClasses: string\n    panelClasses: string\n    position: string\n    closeButton: boolean\n    closeExplicitly?: boolean\n    closeOnClickOutside?: boolean\n}\n\ninterface SlideoverContentProps {\n    modalContext: Modal\n    config: SlideoverContentConfig\n    useNativeDialog: boolean\n    isFirstModal: boolean\n    onAfterLeave?: () => void\n    children: ReactNode | ((props: { modalContext: Modal; config: SlideoverContentConfig }) => ReactNode)\n}\n\nconst SlideoverContent = ({ modalContext, config, useNativeDialog, isFirstModal, onAfterLeave, children }: SlideoverContentProps) => {\n    const [entered, setEntered] = useState(false)\n    const [isLeaving, setIsLeaving] = useState(false)\n    const [transitionState, setTransitionState] = useState<'entering' | 'entered' | 'leaving' | 'exited'>('entering')\n    const wrapperRef = useRef<HTMLDivElement>(null)\n    const dialogRef = useRef<HTMLDialogElement>(null)\n    const nativeWrapperRef = useRef<HTMLDivElement>(null)\n    const cleanupFocusTrapRef = useRef<(() => void) | null>(null)\n    const cleanupEscapeKeyRef = useRef<(() => void) | null>(null)\n    const initialRender = useRef(true)\n\n    const isLeft = config.position === 'left'\n\n    const maxWidthClass = useMemo(() => getMaxWidthClass(config.maxWidth), [config.maxWidth])\n\n    // Transform classes for slideover animation\n    const getTransformClass = useCallback(\n        (isHidden: boolean) => {\n            if (isHidden) {\n                return isLeft ? '-translate-x-full opacity-0' : 'translate-x-full opacity-0'\n            }\n            return 'translate-x-0 opacity-100'\n        },\n        [isLeft],\n    )\n\n    // ============ Non-native dialog handlers ============\n\n    const setupFocusTrap = useCallback(() => {\n        if (useNativeDialog) return\n        if (!wrapperRef.current || !modalContext.onTopOfStack) return\n        if (cleanupFocusTrapRef.current) return\n\n        cleanupFocusTrapRef.current = createFocusTrap(wrapperRef.current, {\n            initialFocus: true,\n            returnFocus: false,\n        })\n    }, [modalContext.onTopOfStack, useNativeDialog])\n\n    const cleanupFocusTrap = useCallback(() => {\n        if (cleanupFocusTrapRef.current) {\n            cleanupFocusTrapRef.current()\n            cleanupFocusTrapRef.current = null\n        }\n    }, [])\n\n    const setupEscapeKey = useCallback(() => {\n        if (useNativeDialog) return\n        if (cleanupEscapeKeyRef.current) return\n        if (config?.closeExplicitly) return\n\n        cleanupEscapeKeyRef.current = onEscapeKey(() => {\n            if (modalContext.onTopOfStack) {\n                modalContext.close()\n            }\n        })\n    }, [config?.closeExplicitly, modalContext, useNativeDialog])\n\n    const cleanupEscapeKey = useCallback(() => {\n        if (cleanupEscapeKeyRef.current) {\n            cleanupEscapeKeyRef.current()\n            cleanupEscapeKeyRef.current = null\n        }\n    }, [])\n\n    const handleClickOutside = useCallback(\n        (event: MouseEvent) => {\n            if (useNativeDialog) return\n            if (!modalContext.onTopOfStack) return\n            if (config?.closeExplicitly) return\n            if (config?.closeOnClickOutside === false) return\n            if (!wrapperRef.current) return\n\n            if (!wrapperRef.current.contains(event.target as Node)) {\n                modalContext.close()\n            }\n        },\n        [modalContext, config?.closeExplicitly, config?.closeOnClickOutside, useNativeDialog],\n    )\n\n    // ============ Native dialog handlers ============\n\n    const handleCancel = useCallback(\n        (event: SyntheticEvent) => {\n            event.preventDefault()\n            if (modalContext.onTopOfStack && !config?.closeExplicitly) {\n                modalContext.close()\n            }\n        },\n        [modalContext, config?.closeExplicitly],\n    )\n\n    const handleDialogClick = useCallback(\n        (event: MouseEvent) => {\n            if (event.target === dialogRef.current) {\n                if (modalContext.onTopOfStack && !config?.closeExplicitly && config?.closeOnClickOutside !== false) {\n                    modalContext.close()\n                }\n            }\n        },\n        [modalContext, config?.closeExplicitly, config?.closeOnClickOutside],\n    )\n\n    const openDialog = useCallback(() => {\n        if (dialogRef.current && !dialogRef.current.open) {\n            dialogRef.current.showModal()\n            requestAnimationFrame(() => {\n                requestAnimationFrame(() => {\n                    setEntered(true)\n                })\n            })\n        }\n    }, [])\n\n    const finishClose = useCallback(() => {\n        if (dialogRef.current) {\n            dialogRef.current.close()\n        }\n        setIsLeaving(false)\n        onAfterLeave?.()\n        modalContext.afterLeave()\n    }, [onAfterLeave, modalContext])\n\n    const closeDialog = useCallback(() => {\n        if (dialogRef.current && dialogRef.current.open) {\n            setIsLeaving(true)\n            setEntered(false)\n\n            const wrapper = nativeWrapperRef.current\n            if (wrapper) {\n                onTransitionEnd(wrapper, finishClose)\n            } else {\n                finishClose()\n            }\n        }\n    }, [finishClose])\n\n    // ============ Lifecycle ============\n\n    // Initial mount\n    useEffect(() => {\n        if (useNativeDialog) {\n            if (modalContext.isOpen) {\n                openDialog()\n            }\n        } else {\n            setupEscapeKey()\n        }\n        return () => {\n            if (useNativeDialog) {\n                if (dialogRef.current?.open) {\n                    dialogRef.current.close()\n                }\n            } else {\n                cleanupFocusTrap()\n                cleanupEscapeKey()\n            }\n        }\n    }, [])\n\n    // Handle becoming top of stack / losing top of stack (non-native only)\n    useEffect(() => {\n        if (useNativeDialog) return\n\n        if (modalContext.onTopOfStack) {\n            setupEscapeKey()\n            if (entered) {\n                setupFocusTrap()\n            }\n        } else {\n            cleanupFocusTrap()\n            cleanupEscapeKey()\n        }\n    }, [modalContext.onTopOfStack, entered, setupEscapeKey, setupFocusTrap, cleanupFocusTrap, cleanupEscapeKey, useNativeDialog])\n\n    // Handle enter animation (non-native only)\n    useEffect(() => {\n        if (useNativeDialog) return\n\n        if (initialRender.current && modalContext.isOpen) {\n            initialRender.current = false\n            requestAnimationFrame(() => {\n                requestAnimationFrame(() => {\n                    setTransitionState('entered')\n                    const wrapper = wrapperRef.current\n                    if (wrapper) {\n                        onTransitionEnd(wrapper, () => {\n                            setEntered(true)\n                            setupFocusTrap()\n                        })\n                    }\n                })\n            })\n        }\n    }, [modalContext.isOpen, setupFocusTrap, useNativeDialog])\n\n    // Handle leave animation (non-native only)\n    useEffect(() => {\n        if (useNativeDialog) return\n\n        if (!modalContext.isOpen && transitionState === 'entered') {\n            setTransitionState('leaving')\n            const wrapper = wrapperRef.current\n            if (wrapper) {\n                onTransitionEnd(wrapper, () => {\n                    setTransitionState('exited')\n                    onAfterLeave?.()\n                    modalContext.afterLeave()\n                })\n            }\n        }\n    }, [modalContext.isOpen, transitionState, onAfterLeave, modalContext, useNativeDialog])\n\n    // Watch for open state changes (native only)\n    useEffect(() => {\n        if (!useNativeDialog) return\n\n        if (modalContext.isOpen) {\n            openDialog()\n        } else if (!isLeaving) {\n            closeDialog()\n        }\n    }, [modalContext.isOpen, openDialog, closeDialog, isLeaving, useNativeDialog])\n\n    // ============ Render ============\n\n    const renderContent = () => (\n        <div\n            className={`im-slideover-content relative ${config.paddingClasses} ${config.panelClasses}`}\n            data-inertiaui-modal-entered={entered}\n        >\n            {config.closeButton && (\n                <div className=\"absolute right-0 top-0 pr-3 pt-3\">\n                    <CloseButton onClick={modalContext.close} />\n                </div>\n            )}\n            {typeof children === 'function' ? children({ modalContext, config }) : children}\n        </div>\n    )\n\n    // Native dialog mode\n    if (useNativeDialog) {\n        return (\n            <dialog\n                ref={dialogRef}\n                className={clsx(\n                    'im-slideover-dialog m-0 overflow-visible bg-transparent p-0',\n                    'size-full max-h-none max-w-none',\n                    'backdrop:bg-black/75 backdrop:transition-opacity backdrop:duration-300',\n                    entered ? 'backdrop:opacity-100' : 'backdrop:opacity-0',\n                    !isFirstModal && 'backdrop:bg-transparent',\n                )}\n                onCancel={handleCancel}\n                onClick={handleDialogClick}\n            >\n                <div className=\"im-slideover-container fixed inset-0 overflow-y-auto overflow-x-hidden\">\n                    <div\n                        className={clsx('im-slideover-positioner flex min-h-full items-center', {\n                            'justify-start rtl:justify-end': config?.position === 'left',\n                            'justify-end rtl:justify-start': config?.position === 'right',\n                        })}\n                    >\n                        <div\n                            ref={nativeWrapperRef}\n                            className={clsx(\n                                'im-slideover-wrapper w-full transition duration-300 ease-in-out',\n                                modalContext.onTopOfStack ? '' : 'blur-xs',\n                                getTransformClass(!(entered && !isLeaving)),\n                                maxWidthClass,\n                            )}\n                        >\n                            {renderContent()}\n                        </div>\n                    </div>\n                </div>\n            </dialog>\n        )\n    }\n\n    // Non-native dialog mode\n    if (transitionState === 'exited') return null\n\n    const isEntering = transitionState === 'entering'\n    const isLeavingNonNative = transitionState === 'leaving'\n\n    return (\n        <div\n            className=\"im-slideover-container fixed inset-0 z-40 overflow-y-auto overflow-x-hidden\"\n            onMouseDown={handleClickOutside}\n        >\n            <div\n                className={clsx('im-slideover-positioner flex min-h-full items-center', {\n                    'justify-start rtl:justify-end': config?.position === 'left',\n                    'justify-end rtl:justify-start': config?.position === 'right',\n                })}\n                onMouseDown={handleClickOutside}\n            >\n                <div\n                    ref={wrapperRef}\n                    role=\"dialog\"\n                    aria-modal=\"true\"\n                    className={clsx(\n                        'im-slideover-wrapper w-full transition duration-300 ease-in-out',\n                        modalContext.onTopOfStack ? '' : 'blur-xs',\n                        getTransformClass(isEntering || isLeavingNonNative),\n                        maxWidthClass,\n                    )}\n                >\n                    <span className=\"sr-only\">Dialog</span>\n                    {renderContent()}\n                </div>\n            </div>\n        </div>\n    )\n}\n\nexport default SlideoverContent\n","import { forwardRef, useRef, useImperativeHandle, useState, useEffect, useCallback, useMemo, ReactNode } from 'react'\nimport { createPortal } from 'react-dom'\nimport HeadlessModal, { HeadlessModalRef } from './HeadlessModal'\nimport ModalContent from './ModalContent'\nimport SlideoverContent from './SlideoverContent'\nimport { lockScroll, markAriaHidden } from '@inertiaui/vanilla'\nimport { getConfig } from './config'\nimport type { Modal as ModalType, ReloadOptions } from './types'\n\ninterface ModalConfig {\n    slideover: boolean\n    closeButton: boolean\n    closeExplicitly: boolean\n    maxWidth: string\n    paddingClasses: string\n    panelClasses: string\n    position: string\n}\n\ninterface ModalRenderProps {\n    afterLeave: () => void\n    close: () => void\n    config: ModalConfig\n    emit: (event: string, ...args: unknown[]) => void\n    getChildModal: () => ModalType | null\n    getParentModal: () => ModalType | null\n    id: string\n    index: number\n    isOpen: boolean\n    modalContext: ModalType\n    onTopOfStack: boolean\n    reload: (options?: ReloadOptions) => void\n    setOpen: (open: boolean) => void\n    shouldRender: boolean\n    // Allow additional props from visitModal\n    [key: string]: unknown\n}\n\ninterface ModalBaseProps {\n    name?: string\n    children: ReactNode | ((props: ModalRenderProps) => ReactNode)\n    onFocus?: () => void\n    onBlur?: () => void\n    onClose?: () => void\n    onSuccess?: () => void\n    onAfterLeave?: () => void\n    slideover?: boolean\n    closeButton?: boolean\n    closeExplicitly?: boolean\n    maxWidth?: string\n    paddingClasses?: string\n    panelClasses?: string\n    position?: string\n}\n\ntype ModalProps = ModalBaseProps & Record<string, unknown>\n\ninterface BackdropTransitionProps {\n    show: boolean\n    appear: boolean\n    onAfterAppear?: () => void\n}\n\nconst Modal = forwardRef<HeadlessModalRef, ModalProps>(\n    (allProps, ref) => {\n        const { name, children, onFocus, onBlur, onClose, onSuccess, onAfterLeave, ...props } = allProps as ModalBaseProps & Record<string, unknown>\n        const renderChildren = (contentProps: ModalRenderProps) => {\n            if (typeof children === 'function') {\n                return children(contentProps)\n            }\n\n            return children\n        }\n\n        const headlessModalRef = useRef<HeadlessModalRef>(null)\n        const cleanupScrollLockRef = useRef<(() => void) | null>(null)\n        const cleanupAriaHiddenRef = useRef<(() => void) | null>(null)\n        const [rendered, setRendered] = useState(false)\n        const useNativeDialog = useMemo(() => getConfig('useNativeDialog') as boolean, [])\n\n        useImperativeHandle(ref, () => headlessModalRef.current!, [headlessModalRef])\n\n        // Cleanup on unmount\n        useEffect(() => {\n            return () => {\n                cleanupScrollLockRef.current?.()\n                cleanupAriaHiddenRef.current?.()\n            }\n        }, [])\n\n        const handleSuccess = useCallback(() => {\n            onSuccess?.()\n            if (!cleanupScrollLockRef.current) {\n                cleanupScrollLockRef.current = lockScroll()\n                cleanupAriaHiddenRef.current = markAriaHidden(getConfig('appElement') as string)\n            }\n        }, [onSuccess])\n\n        const handleClose = useCallback(() => {\n            onClose?.()\n            cleanupScrollLockRef.current?.()\n            cleanupAriaHiddenRef.current?.()\n            cleanupScrollLockRef.current = null\n            cleanupAriaHiddenRef.current = null\n        }, [onClose])\n\n        const handleAfterLeave = useCallback(() => {\n            onAfterLeave?.()\n        }, [onAfterLeave])\n\n        return (\n            <HeadlessModal\n                ref={headlessModalRef}\n                name={name}\n                onFocus={onFocus ?? undefined}\n                onBlur={onBlur ?? undefined}\n                onClose={handleClose}\n                onSuccess={handleSuccess}\n                {...props}\n            >\n                {({\n                    afterLeave,\n                    close,\n                    config,\n                    emit,\n                    getChildModal,\n                    getParentModal,\n                    id,\n                    index,\n                    isOpen,\n                    modalContext,\n                    onTopOfStack,\n                    reload,\n                    setOpen,\n                    shouldRender,\n                    ...extraProps\n                }) => (\n                    <ModalPortal>\n                        <div\n                            className=\"im-dialog relative z-20\"\n                            data-inertiaui-modal-id={id}\n                            data-inertiaui-modal-index={index}\n                            aria-hidden={!onTopOfStack}\n                        >\n                            {/* Only render backdrop for the first modal (non-native dialog mode) */}\n                            {/* Native dialog uses ::backdrop pseudo-element instead */}\n                            {index === 0 && !useNativeDialog && (\n                                <BackdropTransition\n                                    show={isOpen}\n                                    appear={!rendered}\n                                    onAfterAppear={() => setRendered(true)}\n                                />\n                            )}\n\n                            {/* The modal/slideover content itself */}\n                            {config.slideover ? (\n                                <SlideoverContent\n                                    modalContext={modalContext}\n                                    config={config}\n                                    useNativeDialog={useNativeDialog}\n                                    isFirstModal={index === 0}\n                                    onAfterLeave={handleAfterLeave}\n                                >\n                                    {renderChildren({\n                                        ...extraProps,\n                                        afterLeave,\n                                        close,\n                                        config,\n                                        emit,\n                                        getChildModal,\n                                        getParentModal,\n                                        id,\n                                        index,\n                                        isOpen,\n                                        modalContext,\n                                        onTopOfStack,\n                                        reload,\n                                        setOpen,\n                                        shouldRender,\n                                    })}\n                                </SlideoverContent>\n                            ) : (\n                                <ModalContent\n                                    modalContext={modalContext}\n                                    config={config}\n                                    useNativeDialog={useNativeDialog}\n                                    isFirstModal={index === 0}\n                                    onAfterLeave={handleAfterLeave}\n                                >\n                                    {renderChildren({\n                                        ...extraProps,\n                                        afterLeave,\n                                        close,\n                                        config,\n                                        emit,\n                                        getChildModal,\n                                        getParentModal,\n                                        id,\n                                        index,\n                                        isOpen,\n                                        modalContext,\n                                        onTopOfStack,\n                                        reload,\n                                        setOpen,\n                                        shouldRender,\n                                    })}\n                                </ModalContent>\n                            )}\n                        </div>\n                    </ModalPortal>\n                )}\n            </HeadlessModal>\n        )\n    },\n)\n\n// Simple portal component\nfunction ModalPortal({ children }: { children: ReactNode }) {\n    const [mounted, setMounted] = useState(false)\n\n    useEffect(() => {\n        setMounted(true)\n    }, [])\n\n    if (!mounted) return null\n\n    return createPortal(children, document.body)\n}\n\n// Backdrop with CSS transition\nfunction BackdropTransition({ show, appear, onAfterAppear }: BackdropTransitionProps) {\n    const [state, setState] = useState<'entering' | 'entered' | 'leaving' | 'exited'>(() => {\n        if (appear && show) return 'entering'\n        return show ? 'entered' : 'exited'\n    })\n    const initialRender = useRef(true)\n    const backdropRef = useRef<HTMLDivElement>(null)\n\n    useEffect(() => {\n        if (initialRender.current) {\n            initialRender.current = false\n            if (appear && show) {\n                requestAnimationFrame(() => {\n                    setState('entered')\n                    const backdrop = backdropRef.current\n                    if (backdrop) {\n                        const onTransitionEnd = (e: TransitionEvent) => {\n                            if (e.target !== backdrop) return\n                            backdrop.removeEventListener('transitionend', onTransitionEnd)\n                            onAfterAppear?.()\n                        }\n                        backdrop.addEventListener('transitionend', onTransitionEnd)\n                    }\n                })\n            }\n            return\n        }\n\n        if (show) {\n            setState('entering')\n            requestAnimationFrame(() => {\n                setState('entered')\n            })\n        } else {\n            setState('leaving')\n            const backdrop = backdropRef.current\n            if (backdrop) {\n                const onTransitionEnd = (e: TransitionEvent) => {\n                    if (e.target !== backdrop) return\n                    backdrop.removeEventListener('transitionend', onTransitionEnd)\n                    setState('exited')\n                }\n                backdrop.addEventListener('transitionend', onTransitionEnd)\n            }\n        }\n    }, [show, appear, onAfterAppear])\n\n    if (state === 'exited') return null\n\n    const isVisible = state === 'entered'\n\n    return (\n        <div\n            ref={backdropRef}\n            className={`im-backdrop fixed inset-0 z-30 bg-black/75 transition-opacity duration-300 ease-in-out ${isVisible ? 'opacity-100' : 'opacity-0'}`}\n            aria-hidden=\"true\"\n        />\n    )\n}\n\nModal.displayName = 'Modal'\nexport default Modal\n","import { useCallback, useState, useEffect, useMemo, useRef, ReactNode, ElementType, MouseEvent } from 'react'\nimport { useModalStack, modalPropNames, prefetch as prefetchModal } from './ModalRoot'\nimport { only, rejectNullValues, isStandardDomEvent } from './helpers'\nimport { getConfig } from './config'\nimport type { Modal, PrefetchOption } from './types'\nimport type { RequestPayload } from '@inertiajs/core'\n\ninterface ModalLinkProps {\n    href: string\n    method?: string\n    data?: RequestPayload\n    as?: ElementType\n    headers?: Record<string, string>\n    queryStringArrayFormat?: 'brackets' | 'indices'\n    onAfterLeave?: () => void\n    onBlur?: () => void\n    onClose?: () => void\n    onError?: (error: unknown) => void\n    onFocus?: () => void\n    onStart?: () => void\n    onSuccess?: () => void\n    onPrefetching?: () => void\n    onPrefetched?: () => void\n    navigate?: boolean\n    // Prefetch options (#146)\n    prefetch?: PrefetchOption\n    cacheFor?: number\n    children: ReactNode | ((props: { loading: boolean }) => ReactNode)\n    [key: string]: unknown\n}\n\nconst ModalLink = ({\n    href,\n    method = 'get',\n    data = {} as RequestPayload,\n    as: Component = 'a',\n    headers = {},\n    queryStringArrayFormat = 'brackets' as const,\n    onAfterLeave,\n    onBlur,\n    onClose,\n    onError,\n    onFocus,\n    onStart,\n    onSuccess,\n    onPrefetching,\n    onPrefetched,\n    navigate,\n    prefetch = false,\n    cacheFor = 30000,\n    children,\n    ...props\n}: ModalLinkProps) => {\n    const [loading, setLoading] = useState(false)\n    const [modalContext, setModalContext] = useState<Modal | null>(null)\n    const { stack, visit } = useModalStack()\n    const hoverTimeout = useRef<ReturnType<typeof setTimeout> | null>(null)\n\n    const shouldNavigate = useMemo(() => {\n        return navigate ?? (getConfig('navigate') as boolean)\n    }, [navigate])\n\n    // Prefetch logic (#146)\n    const prefetchModes = useMemo(() => {\n        if (prefetch === true) {\n            return ['hover']\n        }\n        if (prefetch === false) {\n            return []\n        }\n        if (Array.isArray(prefetch)) {\n            return prefetch\n        }\n        return [prefetch]\n    }, [prefetch])\n\n    const doPrefetch = useCallback(() => {\n        prefetchModal(href, {\n            method,\n            data,\n            headers,\n            queryStringArrayFormat,\n            cacheFor,\n            onPrefetching: onPrefetching ?? undefined,\n            onPrefetched: onPrefetched ?? undefined,\n        })\n    }, [href, method, data, headers, queryStringArrayFormat, cacheFor, onPrefetching, onPrefetched])\n\n    const handleMouseEnter = useCallback(() => {\n        if (!prefetchModes.includes('hover')) return\n\n        hoverTimeout.current = setTimeout(() => {\n            doPrefetch()\n        }, 75) // Small delay to avoid prefetching on accidental hovers\n    }, [prefetchModes, doPrefetch])\n\n    const handleMouseLeave = useCallback(() => {\n        if (hoverTimeout.current) {\n            clearTimeout(hoverTimeout.current)\n            hoverTimeout.current = null\n        }\n    }, [])\n\n    const handleMouseDown = useCallback(\n        (event: MouseEvent) => {\n            if (!prefetchModes.includes('click')) return\n            if (event.button !== 0) return // Only left click\n\n            doPrefetch()\n        },\n        [prefetchModes, doPrefetch],\n    )\n\n    // Prefetch on mount\n    useEffect(() => {\n        if (prefetchModes.includes('mount')) {\n            doPrefetch()\n        }\n    }, [])\n\n    // Cleanup hover timeout on unmount\n    useEffect(() => {\n        return () => {\n            if (hoverTimeout.current) {\n                clearTimeout(hoverTimeout.current)\n            }\n        }\n    }, [])\n\n    // Separate standard props from custom event handlers\n    const standardProps: Record<string, unknown> = {}\n    const customEvents: Record<string, (...args: unknown[]) => void> = {}\n\n    Object.keys(props).forEach((key) => {\n        if (modalPropNames.includes(key)) {\n            return\n        }\n\n        if (key.startsWith('on') && typeof props[key] === 'function') {\n            if (isStandardDomEvent(key)) {\n                standardProps[key] = props[key]\n            } else {\n                customEvents[key] = props[key] as (...args: unknown[]) => void\n            }\n        } else {\n            standardProps[key] = props[key]\n        }\n    })\n\n    const [isBlurred, setIsBlurred] = useState(false)\n\n    useEffect(() => {\n        if (!modalContext) {\n            return\n        }\n\n        if (modalContext.onTopOfStack && isBlurred) {\n            onFocus?.()\n        } else if (!modalContext.onTopOfStack && !isBlurred) {\n            onBlur?.()\n        }\n\n        setIsBlurred(!modalContext.onTopOfStack)\n    }, [stack])\n\n    const onCloseCallback = useCallback(() => {\n        onClose?.()\n    }, [onClose])\n\n    const onAfterLeaveCallback = useCallback(() => {\n        setModalContext(null)\n        onAfterLeave?.()\n    }, [onAfterLeave])\n\n    const handle = useCallback(\n        (e?: MouseEvent) => {\n            e?.preventDefault()\n            if (loading) return\n\n            if (!href.startsWith('#')) {\n                setLoading(true)\n                onStart?.()\n            }\n\n            visit(\n                href,\n                method,\n                data,\n                headers,\n                rejectNullValues(only(props, modalPropNames)) as Record<string, unknown>,\n                () => onCloseCallback(),\n                onAfterLeaveCallback,\n                queryStringArrayFormat,\n                shouldNavigate,\n            )\n                .then((newModalContext) => {\n                    setModalContext(newModalContext)\n                    newModalContext.registerEventListenersFromProps(customEvents)\n                    onSuccess?.()\n                })\n                .catch((error) => {\n                    console.error(error)\n                    onError?.(error)\n                })\n                .finally(() => setLoading(false))\n        },\n        [href, method, data, headers, queryStringArrayFormat, props, onCloseCallback, onAfterLeaveCallback],\n    )\n\n    return (\n        <Component\n            {...standardProps}\n            href={href}\n            onClick={handle}\n            onMouseEnter={handleMouseEnter}\n            onMouseLeave={handleMouseLeave}\n            onMouseDown={handleMouseDown}\n        >\n            {typeof children === 'function' ? children({ loading }) : children}\n        </Component>\n    )\n}\n\nexport default ModalLink\n","// See: https://github.com/inertiajs/inertia/blob/48bcd21fb7daf467d0df1bfde2408f161f94a579/packages/react/src/WhenVisible.ts\nimport { createElement, useCallback, useEffect, useRef, useState, ReactNode, ElementType } from 'react'\nimport useModal from './useModal'\nimport type { ReloadOptions } from './types'\n\ninterface WhenVisibleProps {\n    children: ReactNode\n    data?: string | string[]\n    params?: ReloadOptions\n    buffer?: number\n    as?: ElementType\n    always?: boolean\n    fallback?: ReactNode\n}\n\nconst WhenVisible = ({ children, data, params, buffer, as, always, fallback }: WhenVisibleProps) => {\n    always = always ?? false\n    as = as ?? 'div'\n    fallback = fallback ?? null\n\n    const [loaded, setLoaded] = useState(false)\n    const hasFetched = useRef(false)\n    const fetching = useRef(false)\n    const ref = useRef<HTMLElement>(null)\n\n    const modal = useModal()\n\n    const getReloadParams = useCallback((): ReloadOptions => {\n        if (data) {\n            return {\n                only: Array.isArray(data) ? data : [data],\n            }\n        }\n\n        if (!params) {\n            throw new Error('You must provide either a `data` or `params` prop.')\n        }\n\n        return params\n    }, [params, data])\n\n    useEffect(() => {\n        if (!ref.current) {\n            return\n        }\n\n        const observer = new IntersectionObserver(\n            (entries) => {\n                if (!entries[0].isIntersecting) {\n                    return\n                }\n\n                if (!always && hasFetched.current) {\n                    observer.disconnect()\n                }\n\n                if (fetching.current) {\n                    return\n                }\n\n                hasFetched.current = true\n                fetching.current = true\n\n                const reloadParams = getReloadParams()\n\n                modal?.reload({\n                    ...reloadParams,\n                    onStart: () => {\n                        fetching.current = true\n                        reloadParams.onStart?.()\n                    },\n                    onFinish: () => {\n                        setLoaded(true)\n                        fetching.current = false\n                        reloadParams.onFinish?.()\n\n                        if (!always) {\n                            observer.disconnect()\n                        }\n                    },\n                })\n            },\n            {\n                rootMargin: `${buffer || 0}px`,\n            },\n        )\n\n        observer.observe(ref.current)\n\n        return () => {\n            observer.disconnect()\n        }\n    }, [ref, getReloadParams, buffer])\n\n    if (always || !loaded) {\n        return createElement(\n            as,\n            {\n                props: null,\n                ref,\n            },\n            loaded ? children : fallback,\n        )\n    }\n\n    return loaded ? children : null\n}\n\nWhenVisible.displayName = 'InertiaWhenVisible'\n\nexport default WhenVisible\n","import { createElement } from 'react'\nimport { getConfig, putConfig, resetConfig } from './config'\nimport { useModalIndex } from './ModalRenderer'\nimport { useModalStack, ModalRoot, ModalStackProvider, renderApp, initFromPageProps, modalPropNames, prefetch } from './ModalRoot'\nimport useModal from './useModal'\nimport Deferred from './Deferred'\nimport HeadlessModal from './HeadlessModal'\nimport Modal from './Modal'\nimport ModalLink from './ModalLink'\nimport WhenVisible from './WhenVisible'\nimport * as dialogUtils from '@inertiaui/vanilla'\n\n// Types\nexport type {\n    Modal as ModalInstance,\n    ModalConfig,\n    ModalResponseData,\n    ModalStackContextValue,\n    VisitOptions,\n    ReloadOptions,\n    EventCallback,\n    ComponentResolver,\n    PageProps,\n    ModalRootProps,\n    ModalRendererProps,\n    LocalModal,\n    // Prefetch types (#146)\n    PrefetchOption,\n    PrefetchOptions,\n} from './types'\n\nexport type {\n    CleanupFunction,\n    FocusTrapOptions,\n    ClickOutsideOptions,\n    EscapeKeyOptions,\n    DialogOptions,\n    Dialog,\n} from '@inertiaui/vanilla'\n\nconst setPageLayout = <T extends { default: { layout?: (page: React.ReactNode) => React.ReactNode } }>(\n    layout: React.ComponentType<{ children?: React.ReactNode }>,\n) => (module: T): T => {\n    module.default.layout = (page) => createElement(layout, { children: page })\n    return module\n}\n\nexport {\n    Deferred,\n    HeadlessModal,\n    Modal,\n    ModalLink,\n    ModalRoot,\n    ModalStackProvider,\n    WhenVisible,\n    getConfig,\n    initFromPageProps,\n    modalPropNames,\n    putConfig,\n    renderApp,\n    resetConfig,\n    setPageLayout,\n    useModal,\n    useModalIndex,\n    useModalStack,\n    // Prefetch function (#146)\n    prefetch,\n    // Dialog utilities (framework-agnostic)\n    dialogUtils,\n}\n"],"names":["vanillaGenerateId","createContext","mergeDataIntoQueryString","useRef","useReducer","useState","router","kebabCase","except","response","progress","jsx","useContext","createElement","jsxs","Fragment","usePage","useEffect","sameUrlPath","useMemo","forwardRef","useImperativeHandle","useCallback","createFocusTrap","onEscapeKey","onTransitionEnd","lockScroll","markAriaHidden","createPortal","prefetch","prefetchModal","isStandardDomEvent","rejectNullValues","only","module"],"mappings":"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","x_google_ignoreList":[8]}